
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.utils.Vector</title>
<meta name="description" content="Documentation of Coq module FormalML.utils.Vector" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.utils.Vector</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.ListAdd.html">ListAdd</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Vector">Vector</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Vector">Vector</a></span> (<span class="id">T</span>:<span class="kwd">Type</span>) (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) := {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span> -&gt; <span class="id">T</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Matrix">Matrix</a></span> (<span class="id">T</span>:<span class="kwd">Type</span>) (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span> -&gt; {<span class="id">m</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}%<span class="id">nat</span> -&gt; <span class="id">T</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ConstVector">ConstVector</a></span> {<span class="id">T</span>} (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">c</span>:<span class="id">T</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">n</span>': {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) =&gt; <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ConstMatrix">ConstMatrix</a></span> {<span class="id">T</span>} (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">c</span>:<span class="id">T</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">n</span> <span class="id">m</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">n</span>': {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) (<span class="id">m</span>':{<span class="id">m</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}%<span class="id">nat</span>) =&gt; <span class="id">c</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">bound</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">struct</span> <span class="id">bound</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id">bound</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt; <span class="id">A</span> <span class="id">bound</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">as</span> <span class="id">bound</span>' <span class="kwd">return</span> (<span class="id">bound</span>' &lt;= <span class="id">m</span> -&gt; <span class="id">A</span> <span class="id">bound</span>') <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">init</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">pf0</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span> &lt;= <span class="id">m</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">an</span> := <span class="id">vector_fold_right1_bounded_dep</span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span> <span class="id">bound1</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> <span class="id">bound1</span> <span class="id">m</span> <span class="id">pf0</span>) <span class="kwd">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bound1</span> <span class="kwd">as</span> <span class="id">bound1</span>' <span class="kwd">return</span> (<span class="id">A</span> <span class="id">bound1</span>' -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>' &lt;= <span class="id">m</span> -&gt; <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>')) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">fun</span> (<span class="id">_</span> : <span class="id">A</span> 0) (<span class="id">pf1</span> : 1 &lt;= <span class="id">m</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">singleton</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> 0 <span class="id">pf1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span> =&gt; <span class="kwd">fun</span> (<span class="id">an</span>' : <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>)) (<span class="id">pf1</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) &lt;= <span class="id">m</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound1</span> <span class="id">pf0</span>)) <span class="id">an</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="id">an</span> <span class="id">pf0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">A</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exact</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">pf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vnil">vnil</a></span> {<span class="id">T</span>} : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> 0.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vcons">vcons</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">x</span>:<span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">PeanoNat.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.le_neq">NPeano.Nat.le_neq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Peano.html#le_S_n">le_S_n</a></span> <span class="kwd">in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vhd">vhd</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id">T</span> := <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (0%<span class="id">nat</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_0_succ">NPeano.Nat.lt_0_succ</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vlast">vlast</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id">T</span> := <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id">n</span>%<span class="id">nat</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_succ_diag_r">NPeano.Nat.lt_succ_diag_r</a></span> <span class="id">n</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vdrop_last">vdrop_last</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>]; <span class="id">apply</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_lt_succ_r">NPeano.Nat.lt_lt_succ_r</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep">vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">bound</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">singleton</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">_</span> <span class="id">x</span> <span class="id">init</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">feq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep">vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">bound</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> 0 <span class="id">x</span> <span class="id">init</span>) <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right1_dep">vector_fold_right1_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) : <span class="id">A</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span> <span class="id">m</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right_dep">vector_fold_right_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) : <span class="id">A</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">m</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right1">vector_fold_right1</a></span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> (<span class="id">A</span>:=<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>) (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>) <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right">vector_fold_right</a></span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>) <span class="id">init</span> <span class="id">v</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_as_vector_fold_right_dep">vector_fold_right1_dep_as_vector_fold_right_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">singleton</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">_</span> <span class="id">x</span> <span class="id">init</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span>  = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep">vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_as_vector_fold_right1_dep">vector_fold_right_dep_as_vector_fold_right1_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> 0 <span class="id">x</span> <span class="id">init</span>) <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep">vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_as_vector_fold_right">vector_fold_right1_as_vector_fold_right</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">singleton</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">x</span> <span class="id">init</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span>  = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_as_vector_fold_right_dep">vector_fold_right1_dep_as_vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_as_vector_fold_right1">vector_fold_right_as_vector_fold_right1</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> <span class="id">init</span>) <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_as_vector_fold_right1_dep">vector_fold_right_dep_as_vector_fold_right1_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vectoro_to_ovector">vectoro_to_ovector</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">T</span>) <span class="id">n</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> (@<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">_</span> <span class="id">n</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>) <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrixo_to_omatrix">matrixo_to_omatrix</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">T</span>) <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vmap">vmap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id">n</span>:=<span class="id">n</span>) (<span class="id">f</span> <span class="id">x</span>) <span class="id">y</span>) <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">v</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mmap">mmap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">mat</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">mrow</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">mrow</span>) <span class="id">mat</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_fold_right1_bounded_dep">list_fold_right1_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">A</span> <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> <span class="id">l</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exact</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assert</span> (<span class="id">pf2</span>:(0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exact</span> (<span class="id">singleton</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">l</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">assert</span> (<span class="id">pf2</span>:(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_fold_right1_dep">list_fold_right1_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) : <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#list_fold_right1_bounded_dep">list_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_fold_right_dep">list_fold_right_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) : <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#list_fold_right1_dep">list_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">_</span> <span class="id">a</span> <span class="id">init</span>) <span class="id">l</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_to_vector">list_to_vector</a></span> {<span class="id">A</span>} (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#list_fold_right_dep">list_fold_right_dep</a></span> (@<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">_</span>) <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">l</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_to_list">vector_to_list</a></span> {<span class="id">A</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_to_list_list">matrix_to_list_list</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>) : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_to_list">matrix_to_list</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>) : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list_list">matrix_to_list_list</a></span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vseq">vseq</a></span> <span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">len</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> <span class="id">start</span> <span class="id">len</span>)) <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_zip">vector_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) (<span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">v1</span> <span class="id">i</span>, <span class="id">v2</span> <span class="id">i</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_zip">matrix_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">mat1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) (<span class="id">mat2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">mat12</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>*<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span>) <span class="id">m</span> := <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">mat1</span> <span class="id">mat2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> '(<span class="id">a</span>,<span class="id">b</span>) =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">a</span> <span class="id">b</span>) <span class="id">mat12</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_split">vector_split</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span> * <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">v</span> <span class="id">i</span>), <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="id">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="vtake">vtake</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>) <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">v</span> <span class="id">i</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof12')">Next Obligation.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="vskip">vskip</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>) <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id">m</span>-<span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">v</span> (<span class="id">i</span>+<span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Next Obligation.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="transpose">transpose</a></span> {<span class="id">A</span>} {<span class="id">n</span> <span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">mat</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">n</span> <span class="id">m</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">mat</span> <span class="id">j</span> <span class="id">i</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vec_eq">vec_eq</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) := <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">x</span> <span class="id">i</span> = <span class="id">y</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span>" := (<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="kwd">at</span> <span class="id">level</span> 70).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vec_eq_eq">vec_eq_eq</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="index_pf_irrel">index_pf_irrel</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">pf1</span> <span class="id">pf2</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">m</span> <span class="id">pf1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">m</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsDigits.html#digit_pf_irrel">digit_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">index_prover</span> := <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">reflexivity</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_Sn_split">vector_Sn_split</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> =<span class="id">v</span>= <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">f_equal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_split_zip">vector_split_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">va</span>,<span class="id">vb</span>):=<span class="id"><a href="FormalML.utils.Vector.html#vector_split">vector_split</a></span> <span class="id">v</span> <span class="kwd">in</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">va</span> <span class="id">vb</span> =<span class="id">v</span>= <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> (<span class="id">v</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="split_vector_zip">split_vector_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">va</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) (<span class="id">vb</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_split">vector_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">va</span> <span class="id">vb</span>) = (<span class="id">va</span>,<span class="id">vb</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vlconcat">vlconcat</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) <span class="id">n</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vlconcat_map">vlconcat_map</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vlconcat">vlconcat</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vin">vin</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">x</span>:<span class="id">A</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">exists</span> <span class="id">i</span>, <span class="id">v</span> <span class="id">i</span> = <span class="id">x</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span>" := (<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="kwd">at</span> <span class="id">level</span> 70).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_bounded_pf_ext">vector_fold_right_dep_bounded_pf_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf1</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">trivial</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_bounded_ext">vector_fold_right_dep_bounded_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> <span class="id">bound</span> <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">y</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_bounded_cut_down">vector_fold_right_dep_bounded_cut_down</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">x</span>) <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_ext">vector_fold_right_dep_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_ext">vector_fold_right_dep_bounded_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_ext">vector_fold_right_ext</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_ext">vector_fold_right_dep_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="veq_refl">veq_refl</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">x</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id">x</span> =<span class="id">v</span>= <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="veq_sym">veq_sym</a></span> {<span class="id">T</span>} {<span class="id">n</span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>} : <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id">y</span> =<span class="id">v</span>= <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span> <span class="id">i</span>; <span class="id">symmetry</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="veq_trans">veq_trans</a></span> {<span class="id">T</span>} {<span class="id">n</span>} {<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>} : <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id">y</span> =<span class="id">v</span>= <span class="id">z</span> -&gt; <span class="id">x</span> =<span class="id">v</span>= <span class="id">z</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq1</span> <span class="id">eqq2</span> <span class="id">i</span>; <span class="id">etransitivity</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vcons_proper">vcons_proper</a></span> {<span class="id">T</span>} {<span class="id">n</span>} <span class="id">a</span> <span class="id">b</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id">a</span> = <span class="id">b</span> -&gt; <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">a</span> <span class="id">x</span> =<span class="id">v</span>= <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>); <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vdrop_last_proper">vdrop_last_proper</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">x</span> =<span class="id">v</span>= <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vlast_vcons">vlast_vcons</a></span> {<span class="id">T</span>} {<span class="id">n</span>} <span class="id">x</span> (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">d</span>) = <span class="id">x</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vdrop_last_vcons">vdrop_last_vcons</a></span> {<span class="id">T</span>} {<span class="id">n</span>} <span class="id">x</span> (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">d</span>) = <span class="id">d</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_0">vector_fold_right_dep_0</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> 0) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <span class="id">init</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <span class="id">f</span> <span class="id">m</span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_ext">vector_fold_right_dep_ext</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">m</span> <span class="id">m</span>) ; [ | <span class="id">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_pf_ext">vector_fold_right_dep_bounded_pf_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_cut_down">vector_fold_right_dep_bounded_cut_down</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_ext">vector_fold_right_dep_bounded_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last_proper">vdrop_last_proper</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_sym">veq_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_Sn">vector_fold_right_Sn</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_vcons">vector_fold_right_dep_vcons</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">v</span>) = <span class="id">f</span> <span class="id">m</span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast_vcons">vlast_vcons</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last_vcons">vdrop_last_vcons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_vcons">vector_fold_right_vcons</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">v</span>) = <span class="id">f</span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_vcons">vector_fold_right_dep_vcons</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_bounded_ext">vector_fold_right1_dep_bounded_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">x</span> <span class="id">bound</span> <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">y</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_bounded_ext">vector_fold_right1_dep_bounded_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_ext">vector_fold_right1_ext</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_bounded_f_ext">vector_fold_right1_dep_bounded_f_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">pf</span> <span class="id">a</span>, <span class="id">f1</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span> = <span class="id">f2</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f1</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f2</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_f_ext">vector_fold_right1_dep_f_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">pf</span> <span class="id">a</span>, <span class="id">f1</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span> = <span class="id">f2</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f1</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f2</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_bounded_f_ext">vector_fold_right1_dep_bounded_f_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_f_ext">vector_fold_right1_f_ext</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> <span class="id">a</span>, <span class="id">f1</span> (<span class="id">v</span> <span class="id">i</span>) <span class="id">a</span> = <span class="id">f2</span> (<span class="id">v</span> <span class="id">i</span>) <span class="id">a</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f1</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f2</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_f_ext">vector_fold_right1_dep_f_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)); <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_0">vector_fold_right1_dep_0</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> 0) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id">init</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_1">vector_fold_right1_dep_1</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> 1) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id">sing</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> 0 <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_0_1">NPeano.Nat.lt_0_1</a></span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_pf_ext">vector_fold_right1_bounded_dep_pf_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf1</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">trivial</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>; <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_SSn">vector_fold_right1_bounded_dep_SSn</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> <span class="id">pf4</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>)) <span class="id">pf1</span> = <span class="id">f</span> <span class="id">_</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf4</span>)) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf2</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_pf_ext">vector_fold_right1_bounded_dep_pf_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_relevant">vector_fold_right1_bounded_dep_relevant</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m1</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m1</span>) {<span class="id">m2</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m2</span>) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">i</span> &lt;= <span class="id">bound</span> -&gt; <span class="kwd">forall</span> <span class="id">pf1</span> <span class="id">pf2</span>, <span class="id">v1</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf1</span>) = <span class="id">v2</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v1</span> <span class="id">bound</span> <span class="id">pf1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v2</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>; <span class="id">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHbound</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_droplast">vector_fold_right1_bounded_dep_droplast</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bound</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) <span class="id">bound</span> <span class="id">pf1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_relevant">vector_fold_right1_bounded_dep_relevant</a></span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_SSn">vector_fold_right1_dep_SSn</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>))) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_SSn">vector_fold_right1_bounded_dep_SSn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_droplast">vector_fold_right1_bounded_dep_droplast</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_bounded_dep_ind">vector_fold_right_bounded_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span>, <span class="id">P</span> <span class="id">bound</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">m</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span> <span class="id">pf</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">ff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_ind">vector_fold_right_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> <span class="id">m</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep_ind">vector_fold_right_bounded_dep_ind</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_ind">vector_fold_right_ind</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="id">A</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span> -&gt;<span class="id">A</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id">f</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_ind">vector_fold_right_dep_ind</a></span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">P</span>)); <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_ind">vector_fold_right1_bounded_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1 (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span>, <span class="id">P</span> <span class="id">bound</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">m</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span> <span class="id">pf</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">ff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_ind">vector_fold_right1_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1 (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> <span class="id">m</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_ind">vector_fold_right1_bounded_dep_ind</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_ind">vector_fold_right1_ind</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="id">A</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span> -&gt;<span class="id">A</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id">f</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ind">vector_fold_right1_dep_ind</a></span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">P</span>)); <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_In">vector_to_list_In</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqqi</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqqi</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_cons">vin_cons</a></span> {<span class="id">A</span>} <span class="id">x</span> (<span class="id">a</span>:<span class="id">A</span>) {<span class="id">n</span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>} : <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">a</span> <span class="id">v</span>) &lt;-&gt; (<span class="id">x</span> = <span class="id">a</span> \/ <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> [<span class="id">eqq</span> | <span class="id">inn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">n</span> <span class="id">n</span>); <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">inn</span> <span class="kwd">as</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>); [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_proper">vin_proper</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) {<span class="id">n</span>} {<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>} : <span class="id">v1</span> =<span class="id">v</span>= <span class="id">v2</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v1</span> &lt;-&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v1</span> <span class="id">v2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut</span> (<span class="kwd">forall</span> (<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>), <span class="id">v1</span> =<span class="id">v</span>= <span class="id">v2</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v1</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">intros</span>; <span class="id">split</span>; [<span class="id">eauto</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_sym">veq_sym</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">eqq1</span> [<span class="id">i</span> <span class="id">eqq2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">eqq1</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_vin">vector_to_list_vin</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; [<span class="id">simpl</span>; <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">v</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">inn</span> <span class="kwd">as</span> [<span class="id">eqq</span> | <span class="id">inn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vin_proper">vin_proper</a></span> <span class="id">A</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vin_cons">vin_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vdrop_last_i">vdrop_last_i</a></span> {<span class="id">A</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="id">i</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">i</span> <span class="id">pf1</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">i</span> <span class="id">pf2</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_vlast">vin_vlast</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_vdrop_last">vin_vdrop_last</a></span> {<span class="id">A</span> <span class="id">n</span>} <span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [[??]?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_nth">vmap_nth</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) {<span class="id">n</span>} (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) <span class="id">i</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span> <span class="id">i</span> = <span class="id">f</span> (<span class="id">v</span> <span class="id">i</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span> <span class="id">v</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last_i">vdrop_last_i</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mmap_nth">mmap_nth</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) <span class="id">i</span> <span class="id">j</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="id">f</span> <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span> = <span class="id">f</span> (<span class="id">mat</span> <span class="id">i</span> <span class="id">j</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_ext">vmap_ext</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">n</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">df</span> -&gt; <span class="id">f1</span> <span class="id">x</span> = <span class="id">f2</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f1</span> <span class="id">df</span> = <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f2</span> <span class="id">df</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="FormalML.utils.Vector.html#vin_vlast">vin_vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">IHn</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vin_vdrop_last">vin_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vnil0">vnil0</a></span> {<span class="id">A</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> 0) : <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_id">vmap_id</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>) <span class="id">df</span> = <span class="id">df</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil0">vnil0</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_0">vector_fold_right_dep_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>, <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_sym">veq_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_seq_bounded">bounded_seq_bounded</a></span> (<span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="kwd">forall</span> <span class="id">bound</span>, <span class="id">bound</span>&lt;=<span class="id">len</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">start</span>+<span class="id">len</span>}%<span class="id">nat</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refine</span> (<span class="kwd">fix</span> <span class="id">F</span> <span class="id">bound</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">as</span> <span class="id">bound_</span> <span class="kwd">return</span> <span class="id">bound_</span> &lt;= <span class="id">len</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">start</span>+<span class="id">len</span>}%<span class="id">nat</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>' =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id">start</span> + <span class="id">len</span>-(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>')) <span class="id">_</span> :: <span class="id">F</span> <span class="id">bound</span>' <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>); <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_bounded_ext">bounded_seq_bounded_ext</a></span> (<span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">bound</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf1</span> <span class="id">pf2</span>:<span class="id">bound</span>&lt;=<span class="id">len</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_seq">bounded_seq</a></span> (<span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">start</span>+<span class="id">len</span>}%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">len</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_seq0">bounded_seq0</a></span> <span class="id">len</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">len</span>}%<span class="id">nat</span> := <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> 0 <span class="id">len</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_bounded_domain">bounded_seq_bounded_domain</a></span> <span class="id">start</span> <span class="id">len</span> (<span class="id">bound</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:<span class="id">bound</span>&lt;=<span class="id">len</span>) : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">bound</span> <span class="id">pf</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> (<span class="id">start</span>+(<span class="id">len</span>-<span class="id">bound</span>)) <span class="id">bound</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">intros</span> <span class="id">start</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_domain">bounded_seq_domain</a></span> <span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> <span class="id">start</span> <span class="id">len</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded_domain">bounded_seq_bounded_domain</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_strongly_sorted">bounded_seq_strongly_sorted</a></span> <span class="id">start</span> <span class="id">len</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">StronglySorted</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#StronglySorted_compose">StronglySorted_compose</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_domain">bounded_seq_domain</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#StronglySorted_seq">StronglySorted_seq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_break_at">bounded_seq_break_at</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span> &gt;= <span class="id">start</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">b</span> <span class="id">c</span>, <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span> = <span class="id">b</span>++<span class="id">x</span>::<span class="id">c</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>) &lt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span>)) <span class="id">b</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span>) &lt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>)) <span class="id">c</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">xge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.utils.ListAdd.html#StronglySorted_break">StronglySorted_break</a></span> (<span class="kwd">fun</span> <span class="id">y</span> <span class="id">x</span> =&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>) &lt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span>)) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_strongly_sorted">bounded_seq_strongly_sorted</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">pf</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">inn</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_domain">bounded_seq_domain</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">inn</span> <span class="kwd">as</span> [[??] [??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vforall">vforall</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">p</span> =&gt; <span class="id">P</span> <span class="id">x</span> /\ <span class="id">p</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vforall_forall">vforall_forall</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> <span class="id">P</span> <span class="id">v</span> &lt;-&gt; <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> (<span class="id">v</span> <span class="id">i</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> ? [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">Plast</span> <span class="id">Pdrop</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="kwd">in</span> <span class="id">Plast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">assert</span> (<span class="id">pf2</span>:(<span class="id">i</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> <span class="id">_</span> <span class="id">Pdrop</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">vm_compute</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">pf2</span> : (<span class="id">i</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> ? [??]; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#some_lift2">some_lift2</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">eqq</span> <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">y</span> <span class="id">eqq1</span> [<span class="id">eqq2</span> <span class="id">eqq3</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> <span class="id">_</span> <span class="id">_</span> <span class="id">eqq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>); <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_forall_some_b">vectoro_to_ovector_forall_some_b</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>', <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id">v</span> =<span class="id">v</span>= <span class="id">v</span>'.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>; <span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [??]; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">vo</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">IHn</span> <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">eqq2</span> <span class="id">eqq3</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">split</span>; [<span class="id">reflexivity</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_trans">veq_trans</a></span>; [<span class="id">eapply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> <span class="id">v</span>) | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons_proper">vcons_proper</a></span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b">vectoro_to_ovector_forall_some_b</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [? [??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">vo</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> &lt;&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">vo</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">elim</span> <span class="id">IHn</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim</span> (<span class="id">eqq</span> <span class="id">_</span> <span class="id">eqq0</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">i</span> | <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>}.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">vo</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id">IHn</span> <span class="id">eqq1</span>) <span class="kwd">as</span> [[<span class="id">i</span> <span class="id">pf</span>] ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_None_None">vectoro_to_ovector_None_None</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} <span class="id">i</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">i</span> <span class="kwd">as</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">eqq</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">IHn</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vfirstn">vfirstn</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">m</span> (<span class="id">pf</span>:(<span class="id">m</span>&lt;=<span class="id">n</span>)%<span class="id">nat</span>): <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">m</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">i</span> <span class="id">pf2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_le_trans">NPeano.Nat.lt_le_trans</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vfirstn0">vfirstn0</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">pf</span> : <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> 0 <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="id">intros</span> [??]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vfirstn_eq">vfirstn_eq</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">pf</span> : <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> <span class="id">n</span> <span class="id">pf</span> = <span class="id">v</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="id">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vfirstn_vdrop_last">vfirstn_vdrop_last</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">bound</span> <span class="id">pf</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>) = <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="id">intros</span> [??]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vlast_vfirstn">vlast_vfirstn</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">bound</span> <span class="id">pf</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">d</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)) = <span class="id">d</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound</span> <span class="id">pf2</span>)).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_gen_ind">vector_fold_right1_bounded_dep_gen_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span> -&gt; <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0%<span class="id">nat</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1%<span class="id">nat</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>) (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id">v</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">r</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span>, <span class="id">P</span> <span class="id">bound</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> <span class="id">_</span> <span class="id">pf</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">m</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span> <span class="id">pf</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> 0 <span class="id">pf</span>); <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="FormalML.utils.Vector.html#vnil0">vnil0</a></span> <span class="id">v0</span>); <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">m</span>; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> 1 <span class="id">pf</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) 0%<span class="id">nat</span> <span class="id">pf</span>)) <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="id">intros</span> [??]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; [ | <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assert</span> (<span class="id">pf2</span>:(<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span> &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>)) <span class="id">pf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)) (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id">ff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">as</span> <span class="id">bound1</span>' <span class="kwd">return</span> (<span class="id">A</span> <span class="id">bound1</span>' -&gt; (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>' &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> -&gt; <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>')) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">_</span> : <span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">pf1</span> : (1 &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sing</span> (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) 0%<span class="id">nat</span> <span class="id">pf1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">an</span>' : <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>)) (<span class="id">_</span> : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) (<span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">bound</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">pf</span>))) <span class="id">an</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> <span class="id">bound</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">pf</span>))) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">pf</span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf2</span>); <span class="id">try</span> <span class="id">eapply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">bound</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">destruct</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** { <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_pf_ext">vector_fold_right1_bounded_dep_pf_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>)) <span class="id">pf</span>)); <span class="id">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_vdrop_last">vfirstn_vdrop_last</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_gen_ind">vector_fold_right1_dep_gen_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span> -&gt; <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0%<span class="id">nat</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1%<span class="id">nat</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>) (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id">v</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">r</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> <span class="id">m</span> <span class="id">v</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn_eq">vfirstn_eq</a></span> <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">m</span>)) <span class="kwd">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_gen_ind">vector_fold_right1_bounded_dep_gen_ind</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="id">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="vapp">vapp</a></span> {<span class="id">A</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) (<span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id">m</span>+<span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">Compare_dec.lt_dec</a></span> <span class="id">i</span> <span class="id">m</span> <span class="kwd">then</span> <span class="id">v1</span> <span class="id">i</span> <span class="kwd">else</span> <span class="id">v2</span> (<span class="id">i</span>-<span class="id">m</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof86')">Next Obligation.</span></div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vtake_skip_app_eq_pf">vtake_skip_app_eq_pf</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) : <span class="id">n</span> + (<span class="id">m</span> - <span class="id">n</span>) = <span class="id">m</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_sub_assoc">NPeano.Nat.add_sub_assoc</a></span> <span class="kwd">by</span> <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Minus.html#minus_plus">Minus.minus_plus</a></span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vtake_skip_app_lt_pf">vtake_skip_app_lt_pf</a></span> {<span class="id">m</span> <span class="id">n</span> <span class="id">i</span>} (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) (<span class="id">p2f</span>:<span class="id">i</span> &lt; <span class="id">m</span>) : <span class="id">i</span> &lt; <span class="id">n</span> + (<span class="id">m</span> - <span class="id">n</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vtake_skip_app_eq_pf">vtake_skip_app_eq_pf</a></span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vtake_skip_app">vtake_skip_app</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>) <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">v</span> <span class="id">i</span> = <span class="id"><a href="FormalML.utils.Vector.html#vapp">vapp</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vtake">vtake</a></span> <span class="id">v</span> <span class="id">n</span> <span class="id">pf</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vskip">vskip</a></span> <span class="id">v</span> <span class="id">n</span> <span class="id">pf</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vtake_skip_app_lt_pf">vtake_skip_app_lt_pf</a></span> <span class="id">pf</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#proj2_sig">proj2_sig</a></span> <span class="id">i</span>))).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vapp">vapp</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vtake">vtake</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vskip">vskip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">i</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|- <span class="id">_</span> = <span class="id">v</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">pff</span>)] =&gt; <span class="id">generalize</span> <span class="id">pff</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">HH</span>:<span class="id">x</span> - <span class="id">n</span> + <span class="id">n</span> = <span class="id">x</span>) <span class="kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_vdrop_last">vmap_vdrop_last</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))  : <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) = <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="id">intros</span> [??]; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="map_vector_to_list_vmap">map_vector_to_list_vmap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>}  (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>) = <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_0">vector_fold_right_dep_0</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHn</span>, <span class="id"><a href="FormalML.utils.Vector.html#vmap_vdrop_last">vmap_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_ext">vector_to_list_ext</a></span> {<span class="id">A</span>} {<span class="id">n</span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">y</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_ext">vector_fold_right_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_length">vector_to_list_length</a></span> (<span class="id">n</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector.Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">Vector.vector_to_list</a></span> <span class="id">v</span>) = <span class="id">n</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
