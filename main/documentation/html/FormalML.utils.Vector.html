
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.utils.Vector</title>
<meta name="description" content="Documentation of Coq module FormalML.utils.Vector" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.utils.Vector</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.ListAdd.html">ListAdd</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Vector">Vector</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Vector">Vector</a></span> (<span class="id">T</span>:<span class="kwd">Type</span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) := {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span> -&gt; <span class="id">T</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Matrix">Matrix</a></span> (<span class="id">T</span>:<span class="kwd">Type</span>) (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span> -&gt; {<span class="id">m</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}%<span class="id">nat</span> -&gt; <span class="id">T</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ConstVector">ConstVector</a></span> {<span class="id">T</span>} (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">c</span>:<span class="id">T</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">n</span>': {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) =&gt; <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ConstMatrix">ConstMatrix</a></span> {<span class="id">T</span>} (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">c</span>:<span class="id">T</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">n</span> <span class="id">m</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">n</span>': {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) (<span class="id">m</span>':{<span class="id">m</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}%<span class="id">nat</span>) =&gt; <span class="id">c</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="kwd">struct</span> <span class="id">bound</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id">bound</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt; <span class="id">A</span> <span class="id">bound</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">as</span> <span class="id">bound</span>' <span class="kwd">return</span> (<span class="id">bound</span>' &lt;= <span class="id">m</span> -&gt; <span class="id">A</span> <span class="id">bound</span>') <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">init</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">pf0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span> &lt;= <span class="id">m</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">an</span> := <span class="id">vector_fold_right1_bounded_dep</span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span> <span class="id">bound1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> <span class="id">bound1</span> <span class="id">m</span> <span class="id">pf0</span>) <span class="kwd">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bound1</span> <span class="kwd">as</span> <span class="id">bound1</span>' <span class="kwd">return</span> (<span class="id">A</span> <span class="id">bound1</span>' -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>' &lt;= <span class="id">m</span> -&gt; <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>')) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">fun</span> (<span class="id">_</span> : <span class="id">A</span> 0) (<span class="id">pf1</span> : 1 &lt;= <span class="id">m</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">singleton</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> 0 <span class="id">pf1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span> =&gt; <span class="kwd">fun</span> (<span class="id">an</span>' : <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>)) (<span class="id">pf1</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) &lt;= <span class="id">m</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound1</span> <span class="id">pf0</span>)) <span class="id">an</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="id">an</span> <span class="id">pf0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">A</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1962')">Proof.</div>
<div class="proofscript" id="proof1962">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">pf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vnil">vnil</a></span> {<span class="id">T</span>} : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1963')">Proof.</div>
<div class="proofscript" id="proof1963">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vcons">vcons</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">x</span>:<span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1964')">Proof.</div>
<div class="proofscript" id="proof1964">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">PeanoNat.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.le_neq">NPeano.Nat.le_neq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_S_n">le_S_n</a></span> <span class="kwd">in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vhd">vhd</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id">T</span> := <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (0%<span class="id">nat</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_0_succ">NPeano.Nat.lt_0_succ</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vlast">vlast</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id">T</span> := <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id">n</span>%<span class="id">nat</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_succ_diag_r">NPeano.Nat.lt_succ_diag_r</a></span> <span class="id">n</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vdrop_last">vdrop_last</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1965')">Proof.</div>
<div class="proofscript" id="proof1965">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>]; <span class="tactic">apply</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_lt_succ_r">NPeano.Nat.lt_lt_succ_r</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep">vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">singleton</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">_</span> <span class="id">x</span> <span class="id">init</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1966')">Proof.</div>
<div class="proofscript" id="proof1966">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">feq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep">vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> 0 <span class="id">x</span> <span class="id">init</span>) <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1967')">Proof.</div>
<div class="proofscript" id="proof1967">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right1_dep">vector_fold_right1_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) : <span class="id">A</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right_dep">vector_fold_right_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) : <span class="id">A</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right1">vector_fold_right1</a></span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> (<span class="id">A</span>:=<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>) (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>) <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_fold_right">vector_fold_right</a></span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>) <span class="id">init</span> <span class="id">v</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_as_vector_fold_right_dep">vector_fold_right1_dep_as_vector_fold_right_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">singleton</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">_</span> <span class="id">x</span> <span class="id">init</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span>  = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1968')">Proof.</div>
<div class="proofscript" id="proof1968">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep">vector_fold_right1_bounded_dep_as_vector_fold_right_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_as_vector_fold_right1_dep">vector_fold_right_dep_as_vector_fold_right1_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> 0 <span class="id">x</span> <span class="id">init</span>) <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1969')">Proof.</div>
<div class="proofscript" id="proof1969">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep">vector_fold_right_bounded_dep_as_vector_fold_right1_bounded_dep</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_as_vector_fold_right">vector_fold_right1_as_vector_fold_right</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">singleton</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">x</span> <span class="id">init</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">v</span>  = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1970')">Proof.</div>
<div class="proofscript" id="proof1970">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_as_vector_fold_right_dep">vector_fold_right1_dep_as_vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_as_vector_fold_right1">vector_fold_right_as_vector_fold_right1</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> <span class="id">init</span>) <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1971')">Proof.</div>
<div class="proofscript" id="proof1971">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_as_vector_fold_right1_dep">vector_fold_right_dep_as_vector_fold_right1_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vectoro_to_ovector">vectoro_to_ovector</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">T</span>) <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> (@<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">_</span> <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>) <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrixo_to_omatrix">matrixo_to_omatrix</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">T</span>) <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vmap">vmap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> (<span class="kwd">fun</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id">n</span>:=<span class="id">n</span>) (<span class="id">f</span> <span class="id">x</span>) <span class="id">y</span>) <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">v</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mmap">mmap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">mat</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">mrow</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">mrow</span>) <span class="id">mat</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_fold_right1_bounded_dep">list_fold_right1_bounded_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">A</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1972')">Proof.</div>
<div class="proofscript" id="proof1972">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">l</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">pf2</span>:(0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">exact</span> (<span class="id">singleton</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id">pf2</span>:(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_fold_right1_dep">list_fold_right1_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">singleton</span>:<span class="id">B</span>-&gt;<span class="id">A</span> 1%<span class="id">nat</span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) : <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#list_fold_right1_bounded_dep">list_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">singleton</span> <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_fold_right_dep">list_fold_right_dep</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) : <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#list_fold_right1_dep">list_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">_</span> <span class="id">a</span> <span class="id">init</span>) <span class="id">l</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="list_to_vector">list_to_vector</a></span> {<span class="id">A</span>} (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#list_fold_right_dep">list_fold_right_dep</a></span> (@<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">_</span>) <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">l</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_to_list">vector_to_list</a></span> {<span class="id">A</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_to_list_list">matrix_to_list_list</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_to_list">matrix_to_list</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list_list">matrix_to_list_list</a></span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vseq">vseq</a></span> <span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">len</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> <span class="id">start</span> <span class="id">len</span>)) <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_zip">vector_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) (<span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">v1</span> <span class="id">i</span>, <span class="id">v2</span> <span class="id">i</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_zip">matrix_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">mat1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) (<span class="id">mat2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">mat12</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>*<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span>) <span class="id">m</span> := <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">mat1</span> <span class="id">mat2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> '(<span class="id">a</span>,<span class="id">b</span>) =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">a</span> <span class="id">b</span>) <span class="id">mat12</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_split">vector_split</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span> * <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">v</span> <span class="id">i</span>), <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="vtake">vtake</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>) <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">v</span> <span class="id">i</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1973')">Next Obligation.</div>
<div class="proofscript" id="proof1973">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="vskip">vskip</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>) <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id">m</span>-<span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">v</span> (<span class="id">i</span>+<span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1974')">Next Obligation.</div>
<div class="proofscript" id="proof1974">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="transpose">transpose</a></span> {<span class="id">A</span>} {<span class="id">n</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">mat</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">n</span> <span class="id">m</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">mat</span> <span class="id">j</span> <span class="id">i</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vec_eq">vec_eq</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) := <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">x</span> <span class="id">i</span> = <span class="id">y</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span>" := (<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="tactic">at</span> <span class="id">level</span> 70).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vec_eq_eq">vec_eq_eq</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1975')">Proof.</div>
<div class="proofscript" id="proof1975">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="index_pf_irrel">index_pf_irrel</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">pf1</span> <span class="id">pf2</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">m</span> <span class="id">pf1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">m</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsDigits.html#digit_pf_irrel">digit_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">index_prover</span> := <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">reflexivity</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_Sn_split">vector_Sn_split</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> =<span class="id">v</span>= <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1976')">Proof.</div>
<div class="proofscript" id="proof1976">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">f_equal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_split_zip">vector_split_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>*<span class="id">B</span>) <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">va</span>,<span class="id">vb</span>):=<span class="id"><a href="FormalML.utils.Vector.html#vector_split">vector_split</a></span> <span class="id">v</span> <span class="kwd">in</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">va</span> <span class="id">vb</span> =<span class="id">v</span>= <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1977')">Proof.</div>
<div class="proofscript" id="proof1977">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">v</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="split_vector_zip">split_vector_zip</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">va</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) (<span class="id">vb</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_split">vector_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">va</span> <span class="id">vb</span>) = (<span class="id">va</span>,<span class="id">vb</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1978')">Proof.</div>
<div class="proofscript" id="proof1978">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vlconcat">vlconcat</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vlconcat_map">vlconcat_map</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vlconcat">vlconcat</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vin">vin</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">x</span>:<span class="id">A</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">exists</span> <span class="id">i</span>, <span class="id">v</span> <span class="id">i</span> = <span class="id">x</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span>" := (<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="tactic">at</span> <span class="id">level</span> 70).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_bounded_pf_ext">vector_fold_right_dep_bounded_pf_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1979')">Proof.</div>
<div class="proofscript" id="proof1979">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf1</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_bounded_ext">vector_fold_right_dep_bounded_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> <span class="id">bound</span> <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">y</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1980')">Proof.</div>
<div class="proofscript" id="proof1980">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_bounded_cut_down">vector_fold_right_dep_bounded_cut_down</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">x</span>) <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1981')">Proof.</div>
<div class="proofscript" id="proof1981">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_ext">vector_fold_right_dep_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1982')">Proof.</div>
<div class="proofscript" id="proof1982">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_ext">vector_fold_right_dep_bounded_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_ext">vector_fold_right_ext</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1983')">Proof.</div>
<div class="proofscript" id="proof1983">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_ext">vector_fold_right_dep_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="veq_refl">veq_refl</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">x</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id">x</span> =<span class="id">v</span>= <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1984')">Proof.</div>
<div class="proofscript" id="proof1984">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="veq_sym">veq_sym</a></span> {<span class="id">T</span>} {<span class="id">n</span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>} : <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id">y</span> =<span class="id">v</span>= <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1985')">Proof.</div>
<div class="proofscript" id="proof1985">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span> <span class="id">i</span>; <span class="tactic">symmetry</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="veq_trans">veq_trans</a></span> {<span class="id">T</span>} {<span class="id">n</span>} {<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>} : <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id">y</span> =<span class="id">v</span>= <span class="id">z</span> -&gt; <span class="id">x</span> =<span class="id">v</span>= <span class="id">z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1986')">Proof.</div>
<div class="proofscript" id="proof1986">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq1</span> <span class="id">eqq2</span> <span class="id">i</span>; <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vcons_proper">vcons_proper</a></span> {<span class="id">T</span>} {<span class="id">n</span>} <span class="id">a</span> <span class="id">b</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id">a</span> = <span class="id">b</span> -&gt; <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">a</span> <span class="id">x</span> =<span class="id">v</span>= <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1987')">Proof.</div>
<div class="proofscript" id="proof1987">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vdrop_last_proper">vdrop_last_proper</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">x</span> =<span class="id">v</span>= <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1988')">Proof.</div>
<div class="proofscript" id="proof1988">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vlast_vcons">vlast_vcons</a></span> {<span class="id">T</span>} {<span class="id">n</span>} <span class="id">x</span> (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">d</span>) = <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1989')">Proof.</div>
<div class="proofscript" id="proof1989">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vdrop_last_vcons">vdrop_last_vcons</a></span> {<span class="id">T</span>} {<span class="id">n</span>} <span class="id">x</span> (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">d</span>) = <span class="id">d</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1990')">Proof.</div>
<div class="proofscript" id="proof1990">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_0">vector_fold_right_dep_0</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> 0) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <span class="id">init</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1991')">Proof.</div>
<div class="proofscript" id="proof1991">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <span class="id">f</span> <span class="id">m</span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1992')">Proof.</div>
<div class="proofscript" id="proof1992">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_ext">vector_fold_right_dep_ext</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">m</span> <span class="id">m</span>) ; [ | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_pf_ext">vector_fold_right_dep_bounded_pf_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_cut_down">vector_fold_right_dep_bounded_cut_down</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_bounded_ext">vector_fold_right_dep_bounded_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last_proper">vdrop_last_proper</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_sym">veq_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_Sn">vector_fold_right_Sn</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> = <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1993')">Proof.</div>
<div class="proofscript" id="proof1993">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_vcons">vector_fold_right_dep_vcons</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">v</span>) = <span class="id">f</span> <span class="id">m</span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1994')">Proof.</div>
<div class="proofscript" id="proof1994">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast_vcons">vlast_vcons</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last_vcons">vdrop_last_vcons</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_vcons">vector_fold_right_vcons</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">v</span>) = <span class="id">f</span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1995')">Proof.</div>
<div class="proofscript" id="proof1995">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_vcons">vector_fold_right_dep_vcons</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">f</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_bounded_ext">vector_fold_right1_dep_bounded_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">x</span> <span class="id">bound</span> <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">y</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1996')">Proof.</div>
<div class="proofscript" id="proof1996">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1997')">Proof.</div>
<div class="proofscript" id="proof1997">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_bounded_ext">vector_fold_right1_dep_bounded_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_ext">vector_fold_right1_ext</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> =<span class="id">v</span>= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1998')">Proof.</div>
<div class="proofscript" id="proof1998">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_bounded_f_ext">vector_fold_right1_dep_bounded_f_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">pf</span> <span class="id">a</span>, <span class="id">f1</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span> = <span class="id">f2</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f1</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f2</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1999')">Proof.</div>
<div class="proofscript" id="proof1999">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_f_ext">vector_fold_right1_dep_f_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">pf</span> <span class="id">a</span>, <span class="id">f1</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span> = <span class="id">f2</span> <span class="id">n</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">pf</span>)) <span class="id">a</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f1</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f2</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2000')">Proof.</div>
<div class="proofscript" id="proof2000">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_bounded_f_ext">vector_fold_right1_dep_bounded_f_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_f_ext">vector_fold_right1_f_ext</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="id">B</span>-&gt;<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">init</span>:<span class="id">A</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>} :<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> <span class="id">a</span>, <span class="id">f1</span> (<span class="id">v</span> <span class="id">i</span>) <span class="id">a</span> = <span class="id">f2</span> (<span class="id">v</span> <span class="id">i</span>) <span class="id">a</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f1</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f2</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2001')">Proof.</div>
<div class="proofscript" id="proof2001">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_f_ext">vector_fold_right1_dep_f_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">A</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_0">vector_fold_right1_dep_0</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> 0) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id">init</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2002')">Proof.</div>
<div class="proofscript" id="proof2002">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_1">vector_fold_right1_dep_1</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> 1) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id">sing</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_0_1">NPeano.Nat.lt_0_1</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2003')">Proof.</div>
<div class="proofscript" id="proof2003">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_pf_ext">vector_fold_right1_bounded_dep_pf_ext</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2004')">Proof.</div>
<div class="proofscript" id="proof2004">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf1</span> <span class="id">pf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>; <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_SSn">vector_fold_right1_bounded_dep_SSn</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span> <span class="id">pf4</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>)) <span class="id">pf1</span> = <span class="id">f</span> <span class="id">_</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf4</span>)) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2005')">Proof.</div>
<div class="proofscript" id="proof2005">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_pf_ext">vector_fold_right1_bounded_dep_pf_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_relevant">vector_fold_right1_bounded_dep_relevant</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m1</span>) {<span class="id">m2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m2</span>) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">i</span> &lt;= <span class="id">bound</span> -&gt; <span class="kwd">forall</span> <span class="id">pf1</span> <span class="id">pf2</span>, <span class="id">v1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf1</span>) = <span class="id">v2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf2</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v1</span> <span class="id">bound</span> <span class="id">pf1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v2</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2006')">Proof.</div>
<div class="proofscript" id="proof2006">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>; <span class="tactic">try</span> <span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHbound</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_droplast">vector_fold_right1_bounded_dep_droplast</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="id">bound</span> <span class="id">pf1</span> <span class="id">pf2</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bound</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) <span class="id">bound</span> <span class="id">pf1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2007')">Proof.</div>
<div class="proofscript" id="proof2007">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_relevant">vector_fold_right1_bounded_dep_relevant</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">index_prover</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_SSn">vector_fold_right1_dep_SSn</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>))) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> = <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2008')">Proof.</div>
<div class="proofscript" id="proof2008">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_SSn">vector_fold_right1_bounded_dep_SSn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_droplast">vector_fold_right1_bounded_dep_droplast</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_bounded_dep_ind">vector_fold_right_bounded_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span>, <span class="id">P</span> <span class="id">bound</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2009')">Proof.</div>
<div class="proofscript" id="proof2009">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span> <span class="id">pf</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_dep_ind">vector_fold_right_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> <span class="id">m</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2010')">Proof.</div>
<div class="proofscript" id="proof2010">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep_ind">vector_fold_right_bounded_dep_ind</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right_ind">vector_fold_right_ind</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="id">A</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span> -&gt;<span class="id">A</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id">f</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2011')">Proof.</div>
<div class="proofscript" id="proof2011">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_ind">vector_fold_right_dep_ind</a></span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">P</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_ind">vector_fold_right1_bounded_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1 (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span>, <span class="id">P</span> <span class="id">bound</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2012')">Proof.</div>
<div class="proofscript" id="proof2012">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span> <span class="id">pf</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_ind">vector_fold_right1_dep_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0 <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1 (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> <span class="id">m</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2013')">Proof.</div>
<div class="proofscript" id="proof2013">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_ind">vector_fold_right1_bounded_dep_ind</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_ind">vector_fold_right1_ind</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="id">A</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">A</span> -&gt;<span class="id">A</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">v</span>, <span class="id">P</span> <span class="id">v</span> -&gt; <span class="id">P</span> (<span class="id">f</span> <span class="id">b</span> <span class="id">v</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2014')">Proof.</div>
<div class="proofscript" id="proof2014">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ind">vector_fold_right1_dep_ind</a></span> (<span class="id">P</span>:=<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">P</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_In">vector_to_list_In</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2015')">Proof.</div>
<div class="proofscript" id="proof2015">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqqi</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqqi</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_cons">vin_cons</a></span> {<span class="id">A</span>} <span class="id">x</span> (<span class="id">a</span>:<span class="id">A</span>) {<span class="id">n</span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>} : <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">a</span> <span class="id">v</span>) &lt;-&gt; (<span class="id">x</span> = <span class="id">a</span> \/ <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2016')">Proof.</div>
<div class="proofscript" id="proof2016">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> [<span class="id">eqq</span> | <span class="id">inn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">n</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">n</span> <span class="id">n</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">inn</span> <span class="kwd">as</span> [[<span class="id">i</span> <span class="id">pf</span>] <span class="id">eqq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>); [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_proper">vin_proper</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) {<span class="id">n</span>} {<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>} : <span class="id">v1</span> =<span class="id">v</span>= <span class="id">v2</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v1</span> &lt;-&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2017')">Proof.</div>
<div class="proofscript" id="proof2017">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v1</span> <span class="id">v2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="kwd">forall</span> (<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>), <span class="id">v1</span> =<span class="id">v</span>= <span class="id">v2</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v1</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>; <span class="tactic">split</span>; [<span class="tactic">eauto</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_sym">veq_sym</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">eqq1</span> [<span class="id">i</span> <span class="id">eqq2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">eqq1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_vin">vector_to_list_vin</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2018')">Proof.</div>
<div class="proofscript" id="proof2018">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; [<span class="tactic">simpl</span>; <span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">v</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">inn</span> <span class="kwd">as</span> [<span class="id">eqq</span> | <span class="id">inn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vin_proper">vin_proper</a></span> <span class="id">A</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vin_cons">vin_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vdrop_last_i">vdrop_last_i</a></span> {<span class="id">A</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="id">i</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">i</span> <span class="id">pf1</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">i</span> <span class="id">pf2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2019')">Proof.</div>
<div class="proofscript" id="proof2019">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_vlast">vin_vlast</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v</span>) <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2020')">Proof.</div>
<div class="proofscript" id="proof2020">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vin_vdrop_last">vin_vdrop_last</a></span> {<span class="id">A</span> <span class="id">n</span>} <span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) : <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2021')">Proof.</div>
<div class="proofscript" id="proof2021">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [[??]?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_nth">vmap_nth</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) {<span class="id">n</span>} (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) <span class="id">i</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span> <span class="id">i</span> = <span class="id">f</span> (<span class="id">v</span> <span class="id">i</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2022')">Proof.</div>
<div class="proofscript" id="proof2022">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">v</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last_i">vdrop_last_i</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mmap_nth">mmap_nth</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) <span class="id">i</span> <span class="id">j</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="id">f</span> <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span> = <span class="id">f</span> (<span class="id">mat</span> <span class="id">i</span> <span class="id">j</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2023')">Proof.</div>
<div class="proofscript" id="proof2023">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_ext">vmap_ext</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">n</span>} (<span class="id">f1</span> <span class="id">f2</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.utils.Vector.html#vin">vin</a></span> <span class="id">x</span> <span class="id">df</span> -&gt; <span class="id">f1</span> <span class="id">x</span> = <span class="id">f2</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f1</span> <span class="id">df</span> = <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f2</span> <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2024')">Proof.</div>
<div class="proofscript" id="proof2024">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.Vector.html#vin_vlast">vin_vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vin_vdrop_last">vin_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vnil0">vnil0</a></span> {<span class="id">A</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> 0) : <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2025')">Proof.</div>
<div class="proofscript" id="proof2025">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_id">vmap_id</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>) <span class="id">df</span> = <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2026')">Proof.</div>
<div class="proofscript" id="proof2026">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil0">vnil0</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_0">vector_fold_right_dep_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>, <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_sym">veq_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_seq_bounded">bounded_seq_bounded</a></span> (<span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="kwd">forall</span> <span class="id">bound</span>, <span class="id">bound</span>&lt;=<span class="id">len</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">start</span>+<span class="id">len</span>}%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2027')">Proof.</div>
<div class="proofscript" id="proof2027">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">refine</span> (<span class="id">fix</span> <span class="id">F</span> <span class="id">bound</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">as</span> <span class="id">bound_</span> <span class="kwd">return</span> <span class="id">bound_</span> &lt;= <span class="id">len</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">start</span>+<span class="id">len</span>}%<span class="id">nat</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>' =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id">start</span> + <span class="id">len</span>-(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>')) <span class="id">_</span> :: <span class="id">F</span> <span class="id">bound</span>' <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>); <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_bounded_ext">bounded_seq_bounded_ext</a></span> (<span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf1</span> <span class="id">pf2</span>:<span class="id">bound</span>&lt;=<span class="id">len</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">bound</span> <span class="id">pf1</span> = <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2028')">Proof.</div>
<div class="proofscript" id="proof2028">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_seq">bounded_seq</a></span> (<span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">start</span>+<span class="id">len</span>}%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">len</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bounded_seq0">bounded_seq0</a></span> <span class="id">len</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">len</span>}%<span class="id">nat</span> := <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> 0 <span class="id">len</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_bounded_domain">bounded_seq_bounded_domain</a></span> <span class="id">start</span> <span class="id">len</span> (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:<span class="id">bound</span>&lt;=<span class="id">len</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded">bounded_seq_bounded</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">bound</span> <span class="id">pf</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> (<span class="id">start</span>+(<span class="id">len</span>-<span class="id">bound</span>)) <span class="id">bound</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2029')">Proof.</div>
<div class="proofscript" id="proof2029">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">start</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_domain">bounded_seq_domain</a></span> <span class="id">start</span> <span class="id">len</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> <span class="id">start</span> <span class="id">len</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2030')">Proof.</div>
<div class="proofscript" id="proof2030">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_bounded_domain">bounded_seq_bounded_domain</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_strongly_sorted">bounded_seq_strongly_sorted</a></span> <span class="id">start</span> <span class="id">len</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">StronglySorted</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2031')">Proof.</div>
<div class="proofscript" id="proof2031">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#StronglySorted_compose">StronglySorted_compose</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_domain">bounded_seq_domain</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#StronglySorted_seq">StronglySorted_seq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bounded_seq_break_at">bounded_seq_break_at</a></span> <span class="id">start</span> <span class="id">len</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span> &gt;= <span class="id">start</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span> <span class="id">c</span>, <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span> = <span class="id">b</span>++<span class="id">x</span>::<span class="id">c</span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>) &lt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span>)) <span class="id">b</span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span>) &lt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>)) <span class="id">c</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2032')">Proof.</div>
<div class="proofscript" id="proof2032">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">xge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.ListAdd.html#StronglySorted_break">StronglySorted_break</a></span> (<span class="kwd">fun</span> <span class="id">y</span> <span class="id">x</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span>) &lt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span>)) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_strongly_sorted">bounded_seq_strongly_sorted</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">pf</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">inn</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">_</span> <span class="id">_</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq">bounded_seq</a></span> <span class="id">start</span> <span class="id">len</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_domain">bounded_seq_domain</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">in_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">inn</span> <span class="kwd">as</span> [[??] [??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vforall">vforall</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">p</span> =&gt; <span class="id">P</span> <span class="id">x</span> /\ <span class="id">p</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vforall_forall">vforall_forall</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> <span class="id">P</span> <span class="id">v</span> &lt;-&gt; <span class="kwd">forall</span> <span class="id">i</span>, <span class="id">P</span> (<span class="id">v</span> <span class="id">i</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2033')">Proof.</div>
<div class="proofscript" id="proof2033">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> ? [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Plast</span> <span class="id">Pdrop</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="kwd">in</span> <span class="id">Plast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id">pf2</span>:(<span class="id">i</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> <span class="id">_</span> <span class="id">Pdrop</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">vm_compute</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_Sn">vector_fold_right_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pf2</span> : (<span class="id">i</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">i</span> <span class="id">pf2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} {<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> <span class="id">i</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2034')">Proof.</div>
<div class="proofscript" id="proof2034">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ? [??]; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#some_lift2">some_lift2</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq</span> <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">y</span> <span class="id">eqq1</span> [<span class="id">eqq2</span> <span class="id">eqq3</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> <span class="id">_</span> <span class="id">_</span> <span class="id">eqq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_forall_some_b">vectoro_to_ovector_forall_some_b</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id">v</span> =<span class="id">v</span>= <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2035')">Proof.</div>
<div class="proofscript" id="proof2035">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [??]; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">vo</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHn</span> <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">eqq2</span> <span class="id">eqq3</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="tactic">split</span>; [<span class="tactic">reflexivity</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.Vector.html#veq_trans">veq_trans</a></span>; [<span class="tactic">eapply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> <span class="id">v</span>) | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vcons_proper">vcons_proper</a></span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2036')">Proof.</div>
<div class="proofscript" id="proof2036">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b">vectoro_to_ovector_forall_some_b</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [? [??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> {<span class="id">A</span> <span class="id">n</span>} (<span class="id">vo</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">vo</span> <span class="id">i</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2037')">Proof.</div>
<div class="proofscript" id="proof2037">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">vo</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">elim</span> <span class="id">IHn</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">eqq</span> <span class="id">_</span> <span class="id">eqq0</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">i</span> | <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2038')">Proof.</div>
<div class="proofscript" id="proof2038">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep">vector_fold_right_dep</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">vo</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHn</span> <span class="id">eqq1</span>) <span class="kwd">as</span> [[<span class="id">i</span> <span class="id">pf</span>] ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_None_None">vectoro_to_ovector_None_None</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} <span class="id">i</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2039')">Proof.</div>
<div class="proofscript" id="proof2039">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span> <span class="kwd">as</span> [<span class="id">i</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.eq_dec">NPeano.Nat.eq_dec</a></span> <span class="id">i</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">IHn</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vfirstn">vfirstn</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">m</span> (<span class="id">pf</span>:(<span class="id">m</span>&lt;=<span class="id">n</span>)%<span class="id">nat</span>): <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2040')">Proof.</div>
<div class="proofscript" id="proof2040">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.lt_le_trans">NPeano.Nat.lt_le_trans</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vfirstn0">vfirstn0</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">pf</span> : <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> 0 <span class="id">pf</span> = <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2041')">Proof.</div>
<div class="proofscript" id="proof2041">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="tactic">intros</span> [??]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vfirstn_eq">vfirstn_eq</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">pf</span> : <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> <span class="id">n</span> <span class="id">pf</span> = <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2042')">Proof.</div>
<div class="proofscript" id="proof2042">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vfirstn_vdrop_last">vfirstn_vdrop_last</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">bound</span> <span class="id">pf</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>) = <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2043')">Proof.</div>
<div class="proofscript" id="proof2043">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span> [??]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vlast_vfirstn">vlast_vfirstn</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) <span class="id">bound</span> <span class="id">pf</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)) = <span class="id">d</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound</span> <span class="id">pf2</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2044')">Proof.</div>
<div class="proofscript" id="proof2044">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_bounded_dep_gen_ind">vector_fold_right1_bounded_dep_gen_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span> -&gt; <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0%<span class="id">nat</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1%<span class="id">nat</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>) (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id">v</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">r</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>) <span class="id">bound</span> <span class="id">pf</span>, <span class="id">P</span> <span class="id">bound</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> <span class="id">_</span> <span class="id">pf</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2045')">Proof.</div>
<div class="proofscript" id="proof2045">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">v</span> <span class="id">bound</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span> <span class="id">pf</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> 0 <span class="id">pf</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.utils.Vector.html#vnil0">vnil0</a></span> <span class="id">v0</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">m</span>; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> 1 <span class="id">pf</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) 0%<span class="id">nat</span> <span class="id">pf</span>)) <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span> [??]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; [ | <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">pf2</span>:(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>)) <span class="id">pf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)) (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">ff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">as</span> <span class="id">bound1</span>' <span class="kwd">return</span> (<span class="id">A</span> <span class="id">bound1</span>' -&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>' &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> -&gt; <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound1</span>')) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">_</span> : <span class="id">A</span> 0%<span class="id">nat</span>) (<span class="id">pf1</span> : (1 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sing</span> (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) 0%<span class="id">nat</span> <span class="id">pf1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">an</span>' : <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>)) (<span class="id">_</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound2</span>) (<span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">bound</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">pf</span>))) <span class="id">an</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> <span class="id">bound</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> <span class="id">bound</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">pf</span>))) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_Sn_le">Le.le_Sn_le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">pf</span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep">vector_fold_right1_bounded_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf2</span>); <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bound</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">destruct</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** { <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_pf_ext">vector_fold_right1_bounded_dep_pf_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>)) <span class="id">pf</span>)); <span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_vdrop_last">vfirstn_vdrop_last</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_fold_right1_dep_gen_ind">vector_fold_right1_dep_gen_ind</a></span> {<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">B</span>} {<span class="id">P</span>:<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span> -&gt; <span class="id">A</span> <span class="id">m</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">f</span>:<span class="kwd">forall</span> <span class="id">n</span>,<span class="id">B</span>-&gt;<span class="id">A</span> <span class="id">n</span>-&gt;<span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">init</span>:<span class="id">A</span> 0%<span class="id">nat</span>) <span class="id">sing</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finit</span> : <span class="id">P</span> 0%<span class="id">nat</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsing</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> 1%<span class="id">nat</span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span>) (<span class="id">sing</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ff</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span> <span class="id">v</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">v</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">b</span> <span class="id">v</span>) (<span class="id">f</span> <span class="id">n</span> <span class="id">b</span> <span class="id">r</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">m</span>), <span class="id">P</span> <span class="id">m</span> <span class="id">v</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep">vector_fold_right1_dep</a></span> <span class="id">f</span> <span class="id">init</span> <span class="id">sing</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2046')">Proof.</div>
<div class="proofscript" id="proof2046">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn_eq">vfirstn_eq</a></span> <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">Le.le_refl</a></span> <span class="id">m</span>)) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_bounded_dep_gen_ind">vector_fold_right1_bounded_dep_gen_ind</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="vapp">vapp</a></span> {<span class="id">A</span>} {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v1</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">m</span>) (<span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id">m</span>+<span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">Compare_dec.lt_dec</a></span> <span class="id">i</span> <span class="id">m</span> <span class="kwd">then</span> <span class="id">v1</span> <span class="id">i</span> <span class="kwd">else</span> <span class="id">v2</span> (<span class="id">i</span>-<span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2047')">Next Obligation.</div>
<div class="proofscript" id="proof2047">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vtake_skip_app_eq_pf">vtake_skip_app_eq_pf</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) : <span class="id">n</span> + (<span class="id">m</span> - <span class="id">n</span>) = <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2048')">Proof.</div>
<div class="proofscript" id="proof2048">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_sub_assoc">NPeano.Nat.add_sub_assoc</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#minus_plus">Minus.minus_plus</a></span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vtake_skip_app_lt_pf">vtake_skip_app_lt_pf</a></span> {<span class="id">m</span> <span class="id">n</span> <span class="id">i</span>} (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) (<span class="id">p2f</span>:<span class="id">i</span> &lt; <span class="id">m</span>) : <span class="id">i</span> &lt; <span class="id">n</span> + (<span class="id">m</span> - <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2049')">Proof.</div>
<div class="proofscript" id="proof2049">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vtake_skip_app_eq_pf">vtake_skip_app_eq_pf</a></span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vtake_skip_app">vtake_skip_app</a></span> {<span class="id">A</span>} {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">A</span>) <span class="id">m</span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:(<span class="id">n</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">v</span> <span class="id">i</span> = <span class="id"><a href="FormalML.utils.Vector.html#vapp">vapp</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vtake">vtake</a></span> <span class="id">v</span> <span class="id">n</span> <span class="id">pf</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vskip">vskip</a></span> <span class="id">v</span> <span class="id">n</span> <span class="id">pf</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vtake_skip_app_lt_pf">vtake_skip_app_lt_pf</a></span> <span class="id">pf</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj2_sig">proj2_sig</a></span> <span class="id">i</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2050')">Proof.</div>
<div class="proofscript" id="proof2050">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vapp">vapp</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vtake">vtake</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vskip">vskip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|- <span class="id">_</span> = <span class="id">v</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">pff</span>)] =&gt; <span class="tactic">generalize</span> <span class="id">pff</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HH</span>:<span class="id">x</span> - <span class="id">n</span> + <span class="id">n</span> = <span class="id">x</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_vdrop_last">vmap_vdrop_last</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))  : <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) = <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2051')">Proof.</div>
<div class="proofscript" id="proof2051">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="tactic">intros</span> [??]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="map_vector_to_list_vmap">map_vector_to_list_vmap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>}  (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>) = <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2052')">Proof.</div>
<div class="proofscript" id="proof2052">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_0">vector_fold_right_dep_0</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>, <span class="id"><a href="FormalML.utils.Vector.html#vmap_vdrop_last">vmap_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_ext">vector_to_list_ext</a></span> {<span class="id">A</span>} {<span class="id">n</span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">x</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2053')">Proof.</div>
<div class="proofscript" id="proof2053">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_ext">vector_fold_right_ext</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_to_list_length">vector_to_list_length</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector.Vector</a></span> <span class="id">A</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">Vector.vector_to_list</a></span> <span class="id">v</span>) = <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2054')">Proof.</div>
<div class="proofscript" id="proof2054">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
