
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.NeuralNetworks.DefinedFunctions</title>
<meta name="description" content="Documentation of Coq module FormalML.NeuralNetworks.DefinedFunctions" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.NeuralNetworks.DefinedFunctions</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="kwd">Program</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html">RelationClasses</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.Natural.Peano.NPeano.html">NPeano</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html">BinInt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html">PeanoNat</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html">Eqdep_dec</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.Floatish.html">Floatish</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.Utils.html">Utils</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.NeuralNetworks.derivlemmas.html">derivlemmas</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.Vector.html">Vector</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="id">Declare</span> <span class="kwd">Scope</span> <span class="id">df_scope</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="id">Bullet</span> <span class="id">Behavior</span> "<span class="kwd">Strict</span> <span class="id">Subproofs</span>".<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions">DefinedFunctions</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">floatish_impl</span>:<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#floatish">floatish</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">float</span>.<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.Definitions">Definitions</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="var">var</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="SubVar">SubVar</a></span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Name">Name</a></span> (<span class="id">s</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Sub">Sub</a></span> (<span class="id">v</span> : <span class="id">SubVar</span>) (<span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="var_dec">var_dec</a></span> : <span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>, {<span class="id">v1</span> = <span class="id">v2</span>} + {<span class="id">v1</span> &lt;&gt; <span class="id">v2</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2265')">Proof.</div>
<div class="proofscript" id="proof2265">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="var_eqdec">var_eqdec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2266')">Proof.</div>
<div class="proofscript" id="proof2266">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_dec">var_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="definition_function_types">definition_function_types</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a name="DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="DTVector">DTVector</a></span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="DTMatrix">DTMatrix</a></span> (<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>).<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id">dft</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) : <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">dft</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="data_type">data_type</a></span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> -&gt; <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a name="DataFloat">DataFloat</a></span> : <span class="id">data_type</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="DataVector">DataVector</a></span> <span class="id">n</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) : <span class="id">data_type</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="DataMatrix">DataMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="id">mat</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) : <span class="id">data_type</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="var_type">var_type</a></span> := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>)%<span class="id">type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="definition_function_types_dec">definition_function_types_dec</a></span> : <span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>, {<span class="id">v1</span> = <span class="id">v2</span>} + {<span class="id">v1</span> &lt;&gt; <span class="id">v2</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2267')">Proof.</div>
<div class="proofscript" id="proof2267">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vart_dec">vart_dec</a></span> : <span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>, {<span class="id">v1</span> = <span class="id">v2</span>} + {<span class="id">v1</span> &lt;&gt; <span class="id">v2</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2268')">Proof.</div>
<div class="proofscript" id="proof2268">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_dec">definition_function_types_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_dec">var_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="vart_eqdec">vart_eqdec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>. <br/>
<div class="toggleproof" onclick="toggleDisplay('proof2269')">Proof.</div>
<div class="proofscript" id="proof2269">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ??.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_dec">vart_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="var_type_UIP_refl">var_type_UIP_refl</a></span> {<span class="id">x</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>} (<span class="id">e</span>:<span class="id">x</span>=<span class="id">x</span>) : <span class="id">e</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2270')">Proof.</div>
<div class="proofscript" id="proof2270">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html#UIP_dec">UIP_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_dec">vart_dec</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="definition_function_types_UIP_refl">definition_function_types_UIP_refl</a></span> {<span class="id">x</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>} (<span class="id">e</span>:<span class="id">x</span>=<span class="id">x</span>) : <span class="id">e</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2271')">Proof.</div>
<div class="proofscript" id="proof2271">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html#UIP_dec">UIP_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_dec">definition_function_types_dec</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="env_entry_type">env_entry_type</a></span> := {<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_env">df_env</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#env_entry_type">env_entry_type</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mk_env_entry">mk_env_entry</a></span> <span class="id">v</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#env_entry_type">env_entry_type</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">P</span> := <span class="kwd">fun</span> <span class="id">xv</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xv</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">P</span> <span class="id">v</span> <span class="id">e</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="UnitAnn">UnitAnn</a></span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>-&gt;<span class="kwd">Type</span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EvalAnn">EvalAnn</a></span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>-&gt;<span class="kwd">Type</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="DefinedFunction">DefinedFunction</a></span> {<span class="id">Ann</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>-&gt;<span class="kwd">Type</span>} : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Number">Number</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Constant">Constant</a></span> {<span class="id">t</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id">t</span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span>) : <span class="id">DefinedFunction</span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="DVector">DVector</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span>) : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="DMatrix">DMatrix</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span> <span class="id">m</span>) : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Var">Var</a></span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">ann</span>: <span class="id">Ann</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) : <span class="id">DefinedFunction</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Plus">Plus</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Minus">Minus</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Times">Times</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Divide">Divide</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Square">Square</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">e</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Exp">Exp</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">e</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Log">Log</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">e</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Abs">Abs</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">e</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Sign">Sign</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">e</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="PSign">PSign</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">e</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Max">Max</a></span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorDot">VectorDot</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> <span class="id">r</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorSum">VectorSum</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">v</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixSum">MatrixSum</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">v</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorElem">VectorElem</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span>:<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">i</span>:{<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>|<span class="id">x</span>&lt;<span class="id">n</span>}%<span class="id">nat</span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixElem">MatrixElem</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span>:<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">i</span>:{<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>|<span class="id">x</span>&lt;<span class="id">m</span>}%<span class="id">nat</span>) (<span class="id">j</span>:{<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>|<span class="id">x</span>&lt;<span class="id">n</span>}%<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixVectorMult">MatrixVectorMult</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>)) (<span class="id">l</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">r</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixVectorAdd">MatrixVectorAdd</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">l</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">r</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)                        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixMult">MatrixMult</a></span> {<span class="id">m</span> <span class="id">p</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">l</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>)) (<span class="id">r</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorPlus">VectorPlus</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">l</span> <span class="id">r</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorMinus">VectorMinus</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">l</span> <span class="id">r</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixPlus">MatrixPlus</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixMinus">MatrixMinus</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">l</span> <span class="id">r</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorScalMult">VectorScalMult</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">x</span>:<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixScalMult">MatrixScalMult</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">x</span>:<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span> : <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VectorApply">VectorApply</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span>:@<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MatrixApply">MatrixApply</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span>:@<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="VLossfun">VLossfun</a></span> {<span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span>:@<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">r</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="MLossfun">MLossfun</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span>:@<span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">l</span>: <span class="id">DefinedFunction</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)) (<span class="id">r</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) : <span class="id">DefinedFunction</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="id">Arguments</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> : <span class="tactic">clear</span> <span class="id">implicits</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span><br/>
&nbsp;&nbsp;(<span class="id">P</span> : <span class="kwd">forall</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>), <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">d</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f0</span> : <span class="kwd">forall</span> (<span class="id">t</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">t</span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span>), <span class="id">P</span> <span class="id">t</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f1</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f2</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">s0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span> <span class="id">s0</span>)) -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f3</span> : <span class="kwd">forall</span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">ann</span>))<br/>
&nbsp;&nbsp;(<span class="id">f4</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f5</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f6</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f7</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f8</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f9</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f10</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f11</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f12</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f13</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f14</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f15</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f16</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)), <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">ann</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;(<span class="id">f17</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">ann</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;(<span class="id">f18</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>}, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;(<span class="id">f19</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">m</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;(<span class="id">f20</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f21</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f22</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">p</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f23</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f24</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f25</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f26</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f27</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f28</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f29</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f30</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f31</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f32</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;:= <br/>
<span class="id">fix</span><br/>
<span class="id">F</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;(<span class="id">d0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">d</span>) {<span class="kwd">struct</span> <span class="id">d0</span>} : <span class="id">P</span> <span class="id">d</span> <span class="id">d0</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d0</span> <span class="kwd">as</span> <span class="id">d2</span> <span class="kwd">in</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">_</span> <span class="id">d1</span>) <span class="kwd">return</span> (<span class="id">P</span> <span class="id">d1</span> <span class="id">d2</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| @<span class="id">Constant</span> <span class="id">_</span> <span class="id">t</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="id">f0</span> <span class="id">t</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| @<span class="id">DVector</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="id">f1</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> (<span class="kwd">fun</span> <span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;| @<span class="id">DMatrix</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f2</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">s0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span> <span class="id">s0</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">ann</span> =&gt; <span class="id">f3</span> <span class="id">v</span> <span class="id">ann</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f4</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f5</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f6</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f7</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f8</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f9</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f10</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f11</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f12</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f13</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f14</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorDot</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f15</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorSum</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> =&gt; <span class="id">f16</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixSum</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> =&gt; <span class="id">f17</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorElem</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id">f18</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;| @<span class="id">MatrixElem</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">f19</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;| @<span class="id">MatrixVectorMult</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f20</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixVectorAdd</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f21</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixMult</span> <span class="id">_</span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f22</span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorPlus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f23</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorMinus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f24</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixPlus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f25</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixMinus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f26</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorScalMult</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span> =&gt; <span class="id">f27</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixScalMult</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span> =&gt; <span class="id">f28</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorApply</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id">f29</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixApply</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f30</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VLossfun</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f31</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;| @<span class="id">MLossfun</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f32</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span> {<span class="id">Ann</span>}<br/>
&nbsp;&nbsp;(<span class="id">P</span> : <span class="kwd">forall</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>), <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">d</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f0</span> : <span class="kwd">forall</span> (<span class="id">t</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ann</span> : <span class="id">Ann</span> <span class="id">t</span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span>), <span class="id">P</span> <span class="id">t</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f1</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f2</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">s0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span> <span class="id">s0</span>)) -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;(<span class="id">f3</span> : <span class="kwd">forall</span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">ann</span>))<br/>
&nbsp;&nbsp;(<span class="id">f4</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f5</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f6</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f7</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f8</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f9</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f10</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f11</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f12</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f13</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;(<span class="id">f14</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f15</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f16</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)), <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">ann</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;(<span class="id">f17</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">ann</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;(<span class="id">f18</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>}, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;(<span class="id">f19</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">m</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;(<span class="id">f20</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f21</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f22</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">p</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f23</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f24</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f25</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f26</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f27</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f28</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f29</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f30</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;(<span class="id">f31</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;(<span class="id">f32</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;:= <br/>
<span class="id">fix</span><br/>
<span class="id">F</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;(<span class="id">d0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">d</span>) {<span class="kwd">struct</span> <span class="id">d0</span>} : <span class="id">P</span> <span class="id">d</span> <span class="id">d0</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d0</span> <span class="kwd">as</span> <span class="id">d2</span> <span class="kwd">in</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">_</span> <span class="id">d1</span>) <span class="kwd">return</span> (<span class="id">P</span> <span class="id">d1</span> <span class="id">d2</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| @<span class="id">Constant</span> <span class="id">_</span> <span class="id">t</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="id">f0</span> <span class="id">t</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| @<span class="id">DVector</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="id">f1</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> (<span class="kwd">fun</span> <span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;| @<span class="id">DMatrix</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f2</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">s0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span> <span class="id">s0</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">ann</span> =&gt; <span class="id">f3</span> <span class="id">v</span> <span class="id">ann</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f4</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f5</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f6</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f7</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f8</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f9</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f10</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f11</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f12</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="id">f13</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f14</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorDot</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f15</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorSum</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> =&gt; <span class="id">f16</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixSum</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> =&gt; <span class="id">f17</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorElem</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id">f18</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;| @<span class="id">MatrixElem</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">f19</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;| @<span class="id">MatrixVectorMult</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f20</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixVectorAdd</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f21</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixMult</span> <span class="id">_</span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f22</span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorPlus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f23</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorMinus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f24</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixPlus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">f25</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixMinus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f26</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorScalMult</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span> =&gt; <span class="id">f27</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixScalMult</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span> =&gt; <span class="id">f28</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VectorApply</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id">f29</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">MatrixApply</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f30</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;| @<span class="id">VLossfun</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f31</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;| @<span class="id">MLossfun</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f32</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="get_annotation">get_annotation</a></span> {<span class="id">Ann</span> <span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) : <span class="id">Ann</span> <span class="id">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">_</span> <span class="id">ann</span> =&gt; <span class="id">ann</span>                                  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ann</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">ann</span>                                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="dft_eq_dec">dft_eq_dec</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">t1</span> <span class="id">t2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>), {<span class="id">t1</span> = <span class="id">t2</span>} + {<span class="id">t1</span> &lt;&gt; <span class="id">t2</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2272')">Proof.</div>
<div class="proofscript" id="proof2272">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="dft_eqdec">dft_eqdec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>. <br/>
<div class="toggleproof" onclick="toggleDisplay('proof2273')">Proof.</div>
<div class="proofscript" id="proof2273">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ??.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dft_eq_dec">dft_eq_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.Definitions">Definitions</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">DefinedFunction_cases</span>" <span class="id">tactic</span>(<span class="id">first</span>) <span class="id">ident</span>(<span class="id">c</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">first</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Number</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Constant</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">DVector</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">DMatrix</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Var</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Plus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Minus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Times</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Divide</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Square</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Exp</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Log</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Abs</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Sign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">PSign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Max</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorDot</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorSum</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorElem</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorApply</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VLossfun</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>].        <br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">refl_simpler</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type_UIP_refl">var_type_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type_UIP_refl">var_type_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_UIP_refl">definition_function_types_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_UIP_refl">definition_function_types_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_plus">df_plus</a></span>  (<span class="id">df1</span> <span class="id">df2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">df1</span> <span class="id">df2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_times">df_times</a></span> (<span class="id">df1</span> <span class="id">df2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">df1</span> <span class="id">df2</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="defined_sum">defined_sum</a></span> {<span class="id">m</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">m</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">a</span> <span class="id">b</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vsum">vsum</a></span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fplus">Fplus</a></span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="msum">msum</a></span> {<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_vector_mult">matrix_vector_mult</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">l</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>)(<span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">l</span> <span class="id">i</span> <span class="id">j</span>) * (<span class="id">r</span> <span class="id">j</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_vector_add">matrix_vector_add</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">l</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span> := <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span> <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span> <span class="id">i</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_mult">matrix_mult</a></span> {<span class="id">n</span> <span class="id">m</span> <span class="id">p</span>} (<span class="id">l</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>)(<span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">p</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">p</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">k</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">l</span> <span class="id">i</span> <span class="id">j</span>) * (<span class="id">r</span> <span class="id">j</span> <span class="id">k</span>)).<br/>
<br/>
<br/>
&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.deriv">deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="substvar">substvar</a></span> {<span class="id">Ann</span>} (<span class="id">v</span> <span class="id">vv</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">e</span>':<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) (<span class="id">e</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">vv</span>)) : (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">vv</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">vv</span>  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#left">left</a></span> <span class="id">pf</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">t</span>) <span class="id">e</span>' <span class="id">_</span> <span class="id">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#right">right</a></span> <span class="id">pf</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_subst">df_subst</a></span> {<span class="id">T</span> <span class="id">Ann</span>} (<span class="id">df</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">e</span>':<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">df_subst</span> (<span class="id">df</span> <span class="id">x</span>) <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_subst</span> (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">vvar</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#substvar">substvar</a></span> <span class="id">v</span> <span class="id">vvar</span> <span class="id">e</span>' (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">vvar</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')                     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">e</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">x</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">x</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') (<span class="id">df_subst</span> <span class="id">r</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> <span class="id">s</span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> (<span class="id">df_subst</span> <span class="id">l</span> <span class="id">v</span> <span class="id">e</span>') <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_substp">df_substp</a></span> {<span class="id">T</span> <span class="id">Ann</span>} := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">e</span> (<span class="id">ve</span>':{<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)}) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id">T</span> <span class="id">Ann</span> <span class="id">e</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>') (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT2">projT2</a></span> <span class="id">ve</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_subst_list">df_subst_list</a></span> {<span class="id">T</span>} (<span class="id">e</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)}) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_substp">df_substp</a></span> <span class="id">T</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span>) <span class="id">l</span> <span class="id">e</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="tactic">subst</span>.<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_deriv">df_deriv</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) {<span class="kwd">struct</span> <span class="id">df</span>} : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">df_deriv</span> (<span class="id">df</span> <span class="id">x</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_deriv</span> (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> <span class="kwd">as</span> <span class="id">y</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>) (<span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>) (<span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> (<span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>) <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> (<span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">r</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 2) <span class="id">e</span>) (<span class="id">df_deriv</span> <span class="id">e</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">e</span> <span class="id">v</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">e</span> <span class="id">v</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">e</span> <span class="id">v</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">r</span> <span class="id">l</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span>) (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span>) <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">r</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xx</span> := <span class="id">df_deriv</span> <span class="id">x</span> <span class="id">v</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">xx</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> <span class="id">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xx</span> := <span class="id">df_deriv</span> <span class="id">x</span> <span class="id">v</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">xx</span> <span class="id">r</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> <span class="id">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">r</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id">df_deriv</span> <span class="id">s</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">rr</span> <span class="id">i</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id">ss</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">r</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rr</span> := <span class="id">df_deriv</span> <span class="id">r</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id">df_deriv</span> <span class="id">s</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">rr</span> <span class="id">i</span> <span class="id">j</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id">ss</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id">df_deriv</span> <span class="id">s</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id">ss</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">r</span> <span class="id">i</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ll</span> := <span class="id">df_deriv</span> <span class="id">l</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ss</span> := <span class="id">df_deriv</span> <span class="id">s</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ll</span> <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id">ss</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>))))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_gradient">df_gradient</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">lv</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df</span>) <span class="id">lv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.deriv">deriv</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.eval">eval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="vartlookup">vartlookup</a></span> (<span class="id">l</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">a</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">fv</span>::<span class="id">os</span> =&gt; <span class="kwd">if</span> <span class="id">a</span> == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">fv</span>) <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT2">projT2</a></span> <span class="id">fv</span>) <span class="id">_</span> <span class="id">_</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">vartlookup</span> <span class="id">os</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="vart_update">vart_update</a></span> (<span class="id">l</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">a</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">n</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">a</span>)) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt;  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">a</span> <span class="id">n</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">fv</span>::<span class="id">os</span> =&gt; <span class="kwd">if</span> <span class="id">a</span> == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">fv</span>) <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">a</span> <span class="id">n</span>)::<span class="id">os</span> <span class="kwd">else</span> <span class="id">fv</span>::(<span class="id">vart_update</span> <span class="id">os</span> <span class="id">a</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval">df_eval</a></span> {<span class="id">T</span> <span class="id">Ann</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">r</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">df_eval</span> σ (<span class="id">dfs</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_eval</span> σ (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span>  σ <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' + <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' - <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' * <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' / <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span> * <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fln">Fln</a></span> <span class="id">v</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fabs">Fabs</a></span> <span class="id">v</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#pos_sign">pos_sign</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#Fmax">Fmax</a></span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval</span> σ <span class="id">l</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval</span> σ <span class="id">l</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) * (<span class="id">r</span>' <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">l</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">l</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">x</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">x</span>' * (<span class="id">r</span>' <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">x</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">x</span>' * (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_add">matrix_vector_add</a></span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) + (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) - (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span>, <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">r</span>' <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">l</span>' <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vv</span>) / (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_tree">df_eval_tree</a></span> {<span class="id">T</span> <span class="id">Ann</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">r</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">r</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">x</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">df_eval_tree</span> σ (<span class="id">dfs</span> <span class="id">i</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">val</span>) <span class="id">val</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_eval_tree</span> σ (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>) <span class="id">val</span>) <span class="id">val</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span>  σ <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">val</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>') + (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>') - (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>') * (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>') / (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="kwd">let</span> <span class="id">v</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">vv</span> <span class="kwd">in</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> (<span class="id">v</span> * <span class="id">v</span>) <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">vv</span>)) <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fln">Fln</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">vv</span>)) <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fabs">Fabs</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">vv</span>)) <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">vv</span>)) <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#pos_sign">pos_sign</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">vv</span>)) <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#Fmax">Fmax</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>') (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_tree</span> σ <span class="id">l</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> (<span class="id">vl</span>' <span class="id">i</span>) <span class="id">l</span>' <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_tree</span> σ <span class="id">l</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> (<span class="id">vl</span>' <span class="id">i</span> <span class="id">j</span>) <span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">vl</span>' <span class="id">i</span>) * (<span class="id">vr</span>' <span class="id">i</span>))) <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vl</span>') <span class="id">l</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vl</span>') <span class="id">l</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">x</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vx</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vec</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> := (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">vx</span>' * (<span class="id">vr</span>' <span class="id">j</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">vec</span> <span class="id">x</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">x</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vx</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span> := <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">vx</span>' * (<span class="id">vr</span>' <span class="id">i</span> <span class="id">j</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">mat</span> <span class="id">x</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> <span class="id">vl</span>' <span class="id">vr</span>') <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_add">matrix_vector_add</a></span> <span class="id">vl</span>' <span class="id">vr</span>') <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">vl</span>' <span class="id">vr</span>') <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vec</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">vl</span>' <span class="id">i</span>) + (<span class="id">vr</span>' <span class="id">i</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">vec</span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vec</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">vl</span>' <span class="id">i</span>) - (<span class="id">vr</span>' <span class="id">i</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">vec</span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">vl</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">vr</span>' <span class="id">i</span> <span class="id">j</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">mat</span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span>, <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">vl</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">vr</span>' <span class="id">i</span> <span class="id">j</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">mat</span> <span class="id">l</span>' <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">vr</span>' <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">val</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">r</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vr</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">vr</span>' <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">val</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">vl</span>' <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vv</span>) <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span>' <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree</span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">vl</span>' <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vv</span>)/(<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>))) <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span>' <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="eval_env_entry_type">eval_env_entry_type</a></span> := {<span class="id">T</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> &amp; (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_eval_env">df_eval_env</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_env_entry_type">eval_env_entry_type</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mk_eval_env_entry">mk_eval_env_entry</a></span> {<span class="id">T</span>} <span class="id">df</span> <span class="id">val</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_env_entry_type">eval_env_entry_type</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">P</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">t</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">Q</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT2">existT2</a></span> <span class="id">P</span> <span class="id">Q</span> <span class="id">T</span> <span class="id">df</span> <span class="id">val</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="pair_update_evals">pair_update_evals</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">val</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) (<span class="id">dfevals</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_env">df_eval_env</a></span>) : (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_env">df_eval_env</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">val</span>, (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_eval_env_entry">mk_eval_env_entry</a></span> <span class="id">df</span> <span class="id">val</span>)::<span class="id">dfevals</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_evals_list">df_evals_list</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">dfevals</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_env">df_eval_env</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_env">df_eval_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">r</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">r</span>) <span class="id">r</span> <span class="id">dfevals</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span>) <span class="id">x</span> <span class="id">dfevals</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> σ <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id">val</span> <span class="id">dfevals</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="id">l</span>'+<span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="id">l</span>'-<span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="id">l</span>'*<span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="id">l</span>'/<span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">e</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) (<span class="id">v</span> * <span class="id">v</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">e</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">v</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">e</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fln">Fln</a></span> <span class="id">v</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">e</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fabs">Fabs</a></span> <span class="id">v</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">e</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">v</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">e</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">e</span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#pos_sign">pos_sign</a></span> <span class="id">v</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#Fmax">Fmax</a></span> <span class="id">l</span>' <span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">i</span>) (<span class="id">l</span>' <span class="id">i</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span>) (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) * (<span class="id">r</span>' <span class="id">i</span>))) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>',<span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">l</span>') <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>',<span class="id">dfevals</span>') =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">l</span>') <span class="id">dfevals</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">l</span>' * (<span class="id">r</span>' <span class="id">j</span>)) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">l</span>' * (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>)) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> <span class="id">l</span>' <span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_add">matrix_vector_add</a></span> <span class="id">l</span>' <span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">l</span>' <span class="id">r</span>') <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) + (<span class="id">r</span>' <span class="id">i</span>)) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) - (<span class="id">r</span>' <span class="id">i</span>)) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>)) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>', <span class="id">dfevals</span>') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">r</span>', <span class="id">dfevals</span>'') =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#pair_update_evals">pair_update_evals</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">l</span> <span class="id">r</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>)) <span class="id">dfevals</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">r</span> <span class="id">dfevals</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_evals_list</span> σ <span class="id">l</span> <span class="id">dfevals</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_eval_symbolic_gradient">df_eval_symbolic_gradient</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">lv</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.lib_utils.LibUtilsLiftIterators.html#listo_to_olist">listo_to_olist</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_gradient">df_gradient</a></span> <span class="id">df</span> <span class="id">lv</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.eval">eval</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.isderiv">isderiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.isderiv">isderiv</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.deriv2">deriv2</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_deriv">df_eval_deriv</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">df_eval_deriv</span> σ (<span class="id">dfs</span> <span class="id">i</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_eval_deriv</span> σ (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">let</span> <span class="id">t</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> + <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> - <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> * <span class="id">rd</span> + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ld</span> * <span class="id">re</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> / <span class="id">re</span>) - ((<span class="id">le</span> * <span class="id">rd</span>) / (<span class="id">re</span> * <span class="id">re</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (2 * <span class="id">ee</span> * <span class="id">ed</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> / <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">ee</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">le</span> &lt;= <span class="id">re</span> <span class="kwd">then</span> <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">else</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">j</span>) * (<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">j</span>) * (<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">x</span>, <span class="id">df_eval_deriv</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xe</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">x</span>, <span class="id">df_eval_deriv</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xe</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>) + (<span class="id">re</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">k</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span> <span class="id">k</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span> <span class="id">k</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) + (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) - (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span> <span class="id">xv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span> <span class="id">xv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vv</span>)/(<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mk_genvar_env">mk_genvar_env</a></span> (<span class="id">s</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> 1)) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">df_eval_deriv_genvar</span> σ (<span class="id">dfs</span> <span class="id">i</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_eval_deriv_genvar</span> σ (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">v</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> + <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> - <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> * <span class="id">rd</span> + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ld</span> * <span class="id">re</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> / <span class="id">re</span>) - ((<span class="id">le</span> * <span class="id">rd</span>) / (<span class="id">re</span> * <span class="id">re</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (2 * <span class="id">ee</span> * <span class="id">ed</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> / <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">ee</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">le</span> &lt;= <span class="id">re</span> <span class="kwd">then</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">else</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">j</span>) * (<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">j</span>) * (<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">x</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xe</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">x</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xe</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>) + (<span class="id">re</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">k</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span> <span class="id">k</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span> <span class="id">k</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) + (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) - (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span>) ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v1</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id">df_eval_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_deriv_genvar</span>  ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>) ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v1</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vv</span>)/(<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="definition_function_types_interp_prod">definition_function_types_interp_prod</a></span> (<span class="id">vart</span> <span class="id">dft</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) : <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">vart</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">dft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">dft</span>) <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">dft</span>) <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="UnitVector">UnitVector</a></span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">j</span> : {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">j</span>) <span class="kwd">then</span> 1 <span class="kwd">else</span> 0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="UnitMatrix">UnitMatrix</a></span> (<span class="id">n</span> <span class="id">m</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">a</span>) == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">b</span>) == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">j</span>) <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span>  0.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="const_env">const_env</a></span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 0)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0))::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt;  ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0))::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_tree_deriv">df_eval_tree_deriv</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">df_eval_tree_deriv</span> σ (<span class="id">dfs</span> <span class="id">i</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_eval_tree_deriv</span> σ (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">let</span> <span class="id">t</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="kwd">if</span> <span class="id">x</span> == <span class="id">v</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> + <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> - <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> * <span class="id">rd</span> + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ld</span> * <span class="id">re</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> / <span class="id">re</span>) - ((<span class="id">le</span> * <span class="id">rd</span>) / (<span class="id">re</span> * <span class="id">re</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (2 * <span class="id">ee</span> * <span class="id">ed</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> / <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span>                                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">ee</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>                       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">le</span> &lt;= <span class="id">re</span> <span class="kwd">then</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">else</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">j</span>) * (<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">j</span>) * (<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xe</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xe</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>) + (<span class="id">rd</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">k</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span> <span class="id">k</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span> <span class="id">k</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) + (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) - (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">re</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ) <span class="id">s</span> <span class="id">xv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">re</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ) <span class="id">s</span> <span class="id">xv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">le</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">le</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> )) <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vv</span>) / (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_tree_deriv_genvar">df_eval_tree_deriv_genvar</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">df_eval_tree_deriv_genvar</span> σ (<span class="id">dfs</span> <span class="id">i</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_eval_tree_deriv_genvar</span> σ (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">v</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> + <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lr</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> - <span class="id">lr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">le</span> * <span class="id">rd</span> + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ld</span> * <span class="id">re</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> / <span class="id">re</span>) - ((<span class="id">le</span> * <span class="id">rd</span>) / (<span class="id">re</span> * <span class="id">re</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (2 * <span class="id">ee</span> * <span class="id">ed</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> / <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span>                                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ed</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">ed</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">ee</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">e</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>                       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">le</span> &lt;= <span class="id">re</span> <span class="kwd">then</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">else</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">j</span>) * (<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">j</span>) * (<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">ld</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xe</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xe</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">x</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) + <span class="id">xd</span> * (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>) + (<span class="id">rd</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">k</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">rd</span> <span class="id">j</span> <span class="id">k</span>) + (<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>)*(<span class="id">re</span> <span class="id">j</span> <span class="id">k</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) + (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">l</span>' <span class="id">i</span>) - (<span class="id">r</span>' <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) + (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span>, <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l</span>' <span class="id">i</span> <span class="id">j</span>) - (<span class="id">r</span>' <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">re</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">re</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">r</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rd</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">x</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">rd</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">le</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> )) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v1</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">vv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">le</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_deriv_genvar</span> σ <span class="id">l</span> <span class="id">v</span> <span class="kwd">with</span>                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ld</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> (<span class="id">le</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v1</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">ld</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">sd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">vv</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">vv</span>) / (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_env_iter">vector_env_iter</a></span> {<span class="id">n</span>} {<span class="id">A</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">oenv</span> =&gt; <span class="kwd">match</span> <span class="id">oenv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="list_env_iter">list_env_iter</a></span> {<span class="id">A</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oenv</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">oenv</span>, <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>, <span class="id">x</span> :: <span class="id">l</span>' =&gt; <span class="id">list_env_iter</span> <span class="id">f</span> (<span class="id">f</span> <span class="id">x</span> <span class="id">env</span>) <span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">oenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.         <br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_none">list_env_iter_none</a></span> {<span class="id">A</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2274')">Proof.</div>
<div class="proofscript" id="proof2274">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_env_not_none">list_env_iter_env_not_none</a></span> {<span class="id">A</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oenv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> <span class="id">oenv</span> <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id">oenv</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2275')">Proof.</div>
<div class="proofscript" id="proof2275">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">oenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_none">list_env_iter_none</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_app">list_env_iter_app</a></span> {<span class="id">A</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oenv</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l1</span> <span class="id">l2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> <span class="id">oenv</span> (<span class="id">l1</span>++<span class="id">l2</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> <span class="id">oenv</span> <span class="id">l1</span>) <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2276')">Proof.</div>
<div class="proofscript" id="proof2276">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l2</span> <span class="id">oenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">intros</span> <span class="id">l2</span> <span class="id">oenv</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">oenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">oenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_none">list_env_iter_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_ext">list_env_iter_ext</a></span> {<span class="id">A</span>} <span class="id">f1</span> <span class="id">f2</span> <span class="id">oenv</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">f1</span> <span class="id">x</span> <span class="id">a</span> = <span class="id">f2</span> <span class="id">x</span> <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f1</span> <span class="id">oenv</span> <span class="id">l</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f2</span> <span class="id">oenv</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2277')">Proof.</div>
<div class="proofscript" id="proof2277">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">oenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span> <span class="id">oenv</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">fa</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="two_vector_env_iter">two_vector_env_iter</a></span> {<span class="id">n</span>} {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) (<span class="id">w</span>: <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vector_env_iter">vector_env_iter</a></span> (<span class="kwd">fun</span> '(<span class="id">a</span>,<span class="id">b</span>) <span class="id">env</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">env</span>) <span class="id">env</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">v</span> <span class="id">w</span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="two_vector_env_iter_alt">two_vector_env_iter_alt</a></span> {<span class="id">n</span>} {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) (<span class="id">w</span>: <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">env</span> =&gt; <span class="id">f</span> (<span class="id">v</span> <span class="id">i</span>) (<span class="id">w</span> <span class="id">i</span>) <span class="id">env</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="matrix_env_iter">matrix_env_iter</a></span> {<span class="id">m</span> <span class="id">n</span>} {<span class="id">A</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">vec</span> <span class="id">oenv</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">oenv</span> =&gt; <span class="kwd">match</span> <span class="id">oenv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">oenv</span> <span class="id">vec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id">env</span> <span class="id">mat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="two_matrix_env_iter">two_matrix_env_iter</a></span> {<span class="id">n</span> <span class="id">m</span>} {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">n</span> <span class="id">m</span>) (<span class="id">w</span>: <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">n</span> <span class="id">m</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vw</span> := <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="id">v</span> <span class="id">w</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_env_iter">matrix_env_iter</a></span> (<span class="kwd">fun</span> '(<span class="id">a</span>,<span class="id">b</span>) <span class="id">e</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">e</span>) <span class="id">env</span> <span class="id">vw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span> {<span class="id">n</span> <span class="id">m</span>} {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>: <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">A</span> <span class="id">n</span> <span class="id">m</span>) (<span class="id">w</span>: <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">n</span> <span class="id">m</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">env</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> (<span class="kwd">fun</span> <span class="id">j</span> <span class="id">env</span> =&gt; <span class="id">f</span> (<span class="id">v</span> <span class="id">i</span> <span class="id">j</span>) (<span class="id">w</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="addvar">addvar</a></span> (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> <span class="kwd">as</span> <span class="id">y</span> <span class="kwd">return</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> = <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">y</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt;  <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">grad</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id">grad</span> + ((<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">val</span>):<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">grad</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">grad</span> <span class="id">i</span>) + (((<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">val</span>):<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">grad</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (((<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">val</span>):<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">i</span> <span class="id">j</span>) + (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2278')">Next Obligation.</div>
<div class="proofscript" id="proof2278">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2279')">Next Obligation.</div>
<div class="proofscript" id="proof2279">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2280')">Next Obligation.</div>
<div class="proofscript" id="proof2280">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="gradenv_init1">gradenv_init1</a></span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#env_entry_type">env_entry_type</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">v</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span> <span class="kwd">as</span> <span class="id">y</span> <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt;  0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">n</span> <span class="id">m</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="gradenv_init">gradenv_init</a></span> (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#gradenv_init1">gradenv_init1</a></span> <span class="id">dvars</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> {<span class="id">T</span> <span class="id">Ann</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) {<span class="kwd">struct</span> <span class="id">df</span>} : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">g</span> <span class="id">genv</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">x</span> <span class="id">genv</span> <span class="id">g</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> <span class="id">dfs</span> <span class="id">grad</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">g</span> <span class="id">genv</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">x</span> <span class="id">genv</span>  <span class="id">g</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> <span class="id">dfs</span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_update">vart_update</a></span> <span class="id">grad_env</span> <span class="id">x</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span> <span class="id">x</span> <span class="id">grad_env</span> <span class="id">grad</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (-<span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id">re</span> * <span class="id">grad</span>) <span class="kwd">with</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id">le</span> * <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span> (<span class="id">grad</span> / <span class="id">re</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>' (- <span class="id">le</span> / (<span class="id">re</span> * <span class="id">re</span>) * <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (2 * <span class="id">ee</span> * <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (<span class="id">grad</span> / <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ee</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (<span class="id">grad</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">ee</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>  =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">le</span> &lt;= <span class="id">re</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span> <span class="id">grad</span>) <span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">grad</span>' := <span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">grad</span>' := <span class="kwd">fun</span> <span class="id">k1</span> <span class="id">k2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k1</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k2</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> =&gt; <span class="id">rv</span>*<span class="id">grad</span>) <span class="id">re</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> =&gt; <span class="id">lv</span>*<span class="id">grad</span>) <span class="id">le</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xe</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">x</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">re</span> <span class="id">j</span>) * (<span class="id">grad</span> <span class="id">j</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xe</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">x</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>) * (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">xe</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span>) * (<span class="id">re</span> <span class="id">j</span>)) <span class="kwd">with</span><br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">le</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">env</span> =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">env</span>  ((<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span>) <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>') (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>'' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">re</span> <span class="id">j</span> <span class="id">i</span>))) <span class="kwd">with</span><br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">le</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">i</span> =&gt; - (<span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; - (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> '(<span class="id">rei</span>, <span class="id">g</span>) =&gt; <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">g</span> * <span class="id">se</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">re</span> <span class="id">grad</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">re</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> '(<span class="id">rei</span>, <span class="id">g</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">g</span> * <span class="id">se</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="id">re</span> <span class="id">grad</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">re</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> '(<span class="id">lei</span>, <span class="id">rei</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">senv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> <span class="id">lei</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">senv</span> <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">grad</span> * <span class="id">se</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">le</span> <span class="id">re</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">re</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">le</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> '(<span class="id">lei</span>, <span class="id">rei</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">senv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> <span class="id">lei</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">senv</span> <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">grad</span> * <span class="id">se</span>)/(<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="id">le</span> <span class="id">re</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>                                                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="lifted_type">lifted_type</a></span> (<span class="id">B</span>:<span class="kwd">Type</span>) <span class="id">T</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="id">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">B</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">B</span> <span class="id">m</span> <span class="id">n</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>) (<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)  {<span class="kwd">struct</span> <span class="id">df</span>} : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">g</span> <span class="id">genv</span> =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">x</span> <span class="id">genv</span>  <span class="id">g</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> <span class="id">dfs</span> <span class="id">grad</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">dfs</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">g</span> <span class="id">genv</span> =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">x</span> <span class="id">genv</span>  <span class="id">g</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> <span class="id">dfs</span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_update">vart_update</a></span> <span class="id">grad_env</span> <span class="id">x</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span> <span class="id">x</span> <span class="id">grad_env</span> <span class="id">grad</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (-<span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id">re</span> * <span class="id">grad</span>) <span class="kwd">with</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id">le</span> * <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id">grad</span> / <span class="id">re</span>) <span class="kwd">with</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>' (- <span class="id">le</span> / (<span class="id">re</span> * <span class="id">re</span>) * <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (2 * <span class="id">ee</span> * <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (<span class="id">grad</span> / <span class="id">ee</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ee</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">e</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  (<span class="id">grad</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">ee</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">e</span> <span class="id">grad_env</span>  0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">le</span> &lt;= <span class="id">re</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>  <span class="id">grad</span>) <span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">grad</span>' := <span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span> <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">grad</span>' := <span class="kwd">fun</span> <span class="id">k1</span> <span class="id">k2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k1</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k2</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> =&gt; <span class="id">rv</span>*<span class="id">grad</span>) <span class="id">re</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> =&gt; <span class="id">lv</span>*<span class="id">grad</span>) <span class="id">le</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xe</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">x</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">re</span> <span class="id">j</span>) * (<span class="id">grad</span> <span class="id">j</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">j</span> =&gt; <span class="id">xe</span> * (<span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">xe</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">x</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">re</span> <span class="id">i</span> <span class="id">j</span>) * (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">xe</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span>) * (<span class="id">re</span> <span class="id">j</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">le</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">env</span> =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">env</span>  ((<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span>) <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>') (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>'' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">le</span>,<span class="id">re</span>) := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">re</span> <span class="id">j</span> <span class="id">i</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">le</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">i</span> =&gt; - (<span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>'  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; - (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">re</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> '(<span class="id">rei</span>, <span class="id">g</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">g</span> * <span class="id">se</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">re</span> <span class="id">grad</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">re</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">r</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> '(<span class="id">rei</span>, <span class="id">g</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">g</span> * <span class="id">se</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="id">re</span> <span class="id">grad</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">r</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">re</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">le</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> '(<span class="id">lei</span>, <span class="id">rei</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">senv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> <span class="id">lei</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">senv</span> <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">grad</span> * <span class="id">se</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="id">le</span> <span class="id">re</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">re</span> =&gt; <span class="kwd">fun</span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">le</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">l</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv1</span> := (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xv2</span> := (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="kwd">in</span>                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s</span> <span class="id">xv1</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ograd</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> '(<span class="id">lei</span>, <span class="id">rei</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">senv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv1</span> <span class="id">lei</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv2</span> <span class="id">rei</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">senv</span> <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">grad</span> * <span class="id">se</span>) / (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="id">le</span> <span class="id">re</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="id">ograd</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span>' =&gt; <span class="id">df_eval_tree_backprop_deriv</span> σ <span class="id">l</span> <span class="id">grad_env</span>  <span class="id">grad</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="o_df_env_to_df_env">o_df_env_to_df_env</a></span> (<span class="id">oenv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">oenv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span> =&gt; <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="backprop_lookup">backprop_lookup</a></span> (<span class="id">oenv</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">a</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">a</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">oenv</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span> =&gt;        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.          <br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_scalar_df_type">is_scalar_df_type</a></span> (<span class="id">dft</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">dft</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="is_scalar_function">is_scalar_function</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_df_type">is_scalar_df_type</a></span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_df_type">is_scalar_df_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">l</span> /\ <span class="id">is_scalar_function</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">l</span> /\ <span class="id">is_scalar_function</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">l</span> /\ <span class="id">is_scalar_function</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">l</span> /\ <span class="id">is_scalar_function</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">is_scalar_function</span> <span class="id">l</span> /\ <span class="id">is_scalar_function</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="has_scalar_functions">has_scalar_functions</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) {<span class="kwd">struct</span> <span class="id">df</span>}: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">vec</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="id">has_scalar_functions</span>) <span class="id">vec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">mat</span> =&gt;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="id">has_scalar_functions</span>)) <span class="id">mat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ (<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ (<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ (<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ (<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ (<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">vec</span> <span class="id">i</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">vec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">has_scalar_functions</span> <span class="id">mat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">has_scalar_functions</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_scalar_functions</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> /\ <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> /\ <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">l</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> /\ <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">l</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> /\ <span class="id">has_scalar_functions</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_scalar_function_has_scalar_functions">is_scalar_function_has_scalar_functions</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">df</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#has_scalar_functions">has_scalar_functions</a></span> <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2281')">Proof.</div>
<div class="proofscript" id="proof2281">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">df</span>; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">is_scalar_function_has_scalar_functions</span> : <span class="id">fml</span>.<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="DefinedFunction_ind_unit_has_scalar_functions">DefinedFunction_ind_unit_has_scalar_functions</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> : <span class="kwd">forall</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>), <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">d</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f0</span> : <span class="kwd">forall</span> (<span class="id">t</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">t</span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">t</span>), <span class="id">P</span> <span class="id">t</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f1</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f2</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">s0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span> <span class="id">s0</span>)) -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f3</span> : <span class="kwd">forall</span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">ann</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f4</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f5</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f6</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f7</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f8</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f9</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f10</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f11</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f12</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f13</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>), <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f14</span> : <span class="kwd">forall</span> (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f15</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f16</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)), <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">ann</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f17</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span> -&gt; <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">ann</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f18</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>}, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f19</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">m</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">x</span> &lt; <span class="id">n</span>)%<span class="id">nat</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f20</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f21</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f22</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">p</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f23</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f24</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f25</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f26</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f27</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f28</span> : <span class="kwd">forall</span> (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f29</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f30</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f31</span> : <span class="kwd">forall</span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> -&gt; <span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f32</span> : <span class="kwd">forall</span> (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ann</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>, <span class="id">P</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;: <span class="kwd">forall</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hs</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#has_scalar_functions">has_scalar_functions</a></span> <span class="id">d0</span>), <span class="id">P</span> <span class="id">d</span> <span class="id">d0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2282')">Proof.</div>
<div class="proofscript" id="proof2282">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">refine</span> (<span class="id">fix</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> (<span class="id">d</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">d0</span>} : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#has_scalar_functions">has_scalar_functions</a></span> <span class="id">d0</span> -&gt; <span class="id">P</span> <span class="id">d</span> <span class="id">d0</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d0</span> <span class="kwd">as</span> <span class="id">d2</span> <span class="kwd">in</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">_</span> <span class="id">d1</span>) <span class="kwd">return</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#has_scalar_functions">has_scalar_functions</a></span> <span class="id">d2</span> -&gt; (<span class="id">P</span> <span class="id">d1</span> <span class="id">d2</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">Constant</span> <span class="id">_</span> <span class="id">t</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f0</span> <span class="id">t</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">DVector</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f1</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> (<span class="kwd">fun</span> <span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span>) <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">DMatrix</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f2</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">s</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">s0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> (<span class="id">x</span> <span class="id">s</span> <span class="id">s0</span>) <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">ann</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f3</span> <span class="id">v</span> <span class="id">ann</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f4</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">hs</span>)) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">hs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f5</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f6</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f7</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f8</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f9</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f10</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f11</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f12</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">ann</span> <span class="id">e</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f13</span> <span class="id">ann</span> <span class="id">e</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">e</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f14</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorDot</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f15</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span>  <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span>  <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorSum</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f16</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixSum</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f17</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorElem</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f18</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixElem</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f19</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixVectorMult</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f20</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixVectorAdd</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f21</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixMult</span> <span class="id">_</span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f22</span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">p</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorPlus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f23</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorMinus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f24</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixPlus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f25</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixMinus</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f26</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">r</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorScalMult</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f27</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> <span class="id">_</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixScalMult</span> <span class="id">_</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f28</span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">x</span> <span class="id">_</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VectorApply</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt; <span class="id">f29</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">_</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> <span class="id">_</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MatrixApply</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f30</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v</span> <span class="id">s</span> <span class="id">_</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> <span class="id">_</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">VLossfun</span> <span class="id">_</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f31</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">_</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> <span class="id">_</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id">MLossfun</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="kwd">fun</span> <span class="id">hs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f32</span> <span class="id">m</span> <span class="id">n</span> <span class="id">ann</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">_</span> (<span class="id">F</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">s</span> <span class="id">_</span>) <span class="id">l</span> (<span class="id">F</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> <span class="id">_</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">hs</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#has_scalar_functions">has_scalar_functions</a></span> <span class="id">x</span>) <span class="id">hs</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">hs</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">hs</span> <span class="id">s0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">hs</span>.<br/>
&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="is_df_rec_prop">is_df_rec_prop</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prop</span> : <span class="kwd">forall</span> <span class="id">TT</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">TT</span>) -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) {<span class="kwd">struct</span> <span class="id">df</span>}: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">prop</span> <span class="id">T</span> <span class="id">df</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">vec</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="id">is_df_rec_prop</span> <span class="id">prop</span>) <span class="id">vec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">mat</span> =&gt;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="id">is_df_rec_prop</span> <span class="id">prop</span>)) <span class="id">mat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">vec</span> <span class="id">i</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">vec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">mat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span>) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">_</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l</span> <span class="id">_</span> =&gt; <span class="id">is_df_rec_prop</span> <span class="id">prop</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_strip_annotations">df_strip_annotations</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) {<span class="kwd">struct</span> <span class="id">df</span>}: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">x1</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">vec</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">df_strip_annotations</span> <span class="id">vec</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">mat</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">df_strip_annotations</span>) <span class="id">mat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">vec</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">vec</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">mat</span>) <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">m</span> <span class="id">p</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt;  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_strip_annotations</span> <span class="id">l</span>) (<span class="id">df_strip_annotations</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v</span> (<span class="id">df_strip_annotations</span> <span class="id">s</span>) (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">v</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v</span> (<span class="id">df_strip_annotations</span> <span class="id">s</span>) (<span class="id">df_strip_annotations</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v1</span> <span class="id">v2</span> (<span class="id">df_strip_annotations</span> <span class="id">s</span>) (<span class="id">df_strip_annotations</span> <span class="id">l</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v1</span> <span class="id">v2</span> (<span class="id">df_strip_annotations</span> <span class="id">s</span>) (<span class="id">df_strip_annotations</span> <span class="id">l</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.        <br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_strip_annotations_id">df_strip_annotations_id</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df</span> = <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2283')">Proof.</div>
<div class="proofscript" id="proof2283">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> <span class="id">ann</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_ext">vmap_ext</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_id">vmap_id</a></span> | ]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [??]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_ext">vmap_ext</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_id">vmap_id</a></span> | ]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_ext">vmap_ext</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_id">vmap_id</a></span> | ]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [??]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [??]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_eq_upto_annotations">df_eq_upto_annotations</a></span> {<span class="id">Ann1</span> <span class="id">Ann2</span> <span class="id">T</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df1</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann1</span> <span class="id">T</span>) (<span class="id">df2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann2</span> <span class="id">T</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#get_annotation">get_annotation</a></span> <span class="id">df</span>). <br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_df_evalann_correct">is_df_evalann_correct</a></span> (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop">is_df_rec_prop</a></span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> σ) <span class="id">df</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_df_rec_prop_top">is_df_rec_prop_top</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">prop</span> : <span class="kwd">forall</span> <span class="id">TT</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">TT</span>) -&gt; <span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop">is_df_rec_prop</a></span> <span class="id">prop</span> <span class="id">df</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prop</span> <span class="id">_</span> <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2284')">Proof.</div>
<div class="proofscript" id="proof2284">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">df</span>; <span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_tree_correct">df_eval_tree_correct</a></span> {<span class="id">T</span> <span class="id">Ann</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">dfann</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">dfann</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">dfann</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2285')">Proof.</div>
<div class="proofscript" id="proof2285">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dfann</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">df</span>) <span class="id">Case</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">dfann</span> <span class="id">eqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">solve</span>[<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf1</span> <span class="id">a1eqq</span> | <span class="tactic">intros</span> <span class="id">a1eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">a1eqq</span> <span class="kwd">in</span> <span class="id">eqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; (<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf2</span> <span class="id">a2eqq</span> | <span class="tactic">intros</span> <span class="id">a2eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">a2eqq</span> <span class="kwd">in</span> <span class="id">eqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">inversion</span> <span class="id">eqq</span>; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">_</span> <span class="id">a1eqq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">_</span> <span class="id">a2eqq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">split</span>; [| <span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>, <span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">IHdf1</span>, <span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf</span> <span class="id">aeqq</span> | <span class="tactic">intros</span> <span class="id">aeqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">aeqq</span> <span class="kwd">in</span> <span class="id">eqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">inversion</span> <span class="id">eqq</span>; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">_</span> <span class="id">aeqq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">split</span>; [| <span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">eqq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">eqq</span>; <span class="tactic">subst</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">clear</span> <span class="id">eqq0</span>; <span class="tactic">intros</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">eqq0</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">clear</span> <span class="id">eqq0</span>; <span class="tactic">intros</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">eqq0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">clear</span> <span class="id">eqq0</span>; <span class="tactic">intros</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">eqq0</span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">eqq0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">eqq0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">clear</span> <span class="id">eqq0</span>; <span class="tactic">intros</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> σ <span class="id">v</span>) ; [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">eqq</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf2</span> <span class="id">a2eqq</span> | <span class="tactic">intros</span> <span class="id">a2eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">a2eqq</span> <span class="kwd">in</span> <span class="id">eqq</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">_</span> <span class="id">a2eqq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf2</span> <span class="id">a2eqq</span> | <span class="tactic">intros</span> <span class="id">a2eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">a2eqq</span> <span class="kwd">in</span> <span class="id">eqq</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">_</span> <span class="id">a2eqq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf2</span> <span class="id">a2eqq</span> | <span class="tactic">intros</span> <span class="id">a2eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">a2eqq</span> <span class="kwd">in</span> <span class="id">eqq</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">_</span> <span class="id">a2eqq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>, <span class="id">eqq0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id">df2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">adf2</span> <span class="id">a2eqq</span> | <span class="tactic">intros</span> <span class="id">a2eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">a2eqq</span> <span class="kwd">in</span> <span class="id">eqq</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">_</span> <span class="id">a2eqq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>, <span class="id">eqq0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_tree_deriv_correct">df_eval_tree_deriv_correct</a></span> {<span class="id">T</span>} {σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>} {<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xv</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree_deriv">df_eval_tree_deriv</a></span> σ <span class="id">df</span> <span class="id">xv</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span> <span class="id">xv</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2286')">Proof.</div>
<div class="proofscript" id="proof2286">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span>) <span class="id">Case</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">iscor</span>; <span class="tactic">destruct</span> <span class="id">iscor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">trivial</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">solve</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> σ <span class="id">df</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span>; <span class="tactic">trivial</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">H1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">rewrite</span> <span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">tauto</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> σ <span class="id">df2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">trivial</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">IHdf1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">rewrite</span> <span class="id">IHdf2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> σ <span class="id">df1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span>; <span class="tactic">trivial</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> σ <span class="id">df2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[  <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|                                                   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">trivial</span> ]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_tree_backprop_deriv_correct">df_eval_tree_backprop_deriv_correct</a></span> {<span class="id">T</span>} (σ <span class="id">gradenv</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#EvalAnn">EvalAnn</a></span> <span class="id">T</span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">gradenv</span> <span class="id">grad</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">gradenv</span> <span class="id">grad</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2287')">Proof.</div>
<div class="proofscript" id="proof2287">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">gradenv</span> <span class="id">grad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span>) <span class="id">Case</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>;<span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">solve</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">trivial</span>]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">IHdf1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span>]<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_rec_prop_top">is_df_rec_prop_top</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct_top">is_df_evalann_correct_top</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span> ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;  <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;  <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span> σ <span class="id">df2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_df_evalann_correct">is_df_evalann_correct</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_ignores_ann">df_eval_ignores_ann</a></span> {<span class="id">Ann</span> <span class="id">T</span>} {σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2288')">Proof.</div>
<div class="proofscript" id="proof2288">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span>) <span class="id">Case</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">solve</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|                             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations_id">df_strip_annotations_id</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">f_equal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations_id">df_strip_annotations_id</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">trivial</span>.       <br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_ignores_ann2">df_eval_ignores_ann2</a></span> {<span class="id">Ann1</span> <span class="id">Ann2</span> <span class="id">T</span>} {σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df1</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann1</span> <span class="id">T</span>) (<span class="id">df2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann2</span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eq_upto_annotations">df_eq_upto_annotations</a></span> <span class="id">df1</span> <span class="id">df2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2289')">Proof.</div>
<div class="proofscript" id="proof2289">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>)) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>)) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_deriv_ignores_ann">df_eval_deriv_ignores_ann</a></span> {<span class="id">Ann</span> <span class="id">T</span>} {σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xv</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span> <span class="id">xv</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df</span>) <span class="id">xv</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2290')">Proof.</div>
<div class="proofscript" id="proof2290">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span>) <span class="id">Case</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">solve</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id">IHdf1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>) <span class="id">xv</span>); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>) <span class="id">xv</span>); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHdf</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df</span>) <span class="id">xv</span>); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHdf</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>)); [|<span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHdf1</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations_id">df_strip_annotations_id</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_ignores_ann">df_eval_ignores_ann</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_deriv_ignores_ann2">df_eval_deriv_ignores_ann2</a></span> {<span class="id">Ann1</span> <span class="id">Ann2</span> <span class="id">T</span>} {σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df1</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann1</span> <span class="id">T</span>) (<span class="id">df2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann2</span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">xv</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eq_upto_annotations">df_eq_upto_annotations</a></span> <span class="id">df1</span> <span class="id">df2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df1</span> <span class="id">xv</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df2</span> <span class="id">xv</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2291')">Proof.</div>
<div class="proofscript" id="proof2291">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df1</span> <span class="id">xv</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df1</span>) <span class="id">xv</span>) <span class="tactic">by</span>  <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_ignores_ann">df_eval_deriv_ignores_ann</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df2</span> <span class="id">xv</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_strip_annotations">df_strip_annotations</a></span> <span class="id">df2</span>) <span class="id">xv</span>) <span class="tactic">by</span>  <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_ignores_ann">df_eval_deriv_ignores_ann</a></span>.     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="is_scalar_function_scalar">is_scalar_function_scalar</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">df</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_df_type">is_scalar_df_type</a></span> <span class="id">T</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2292')">Proof.</div>
<div class="proofscript" id="proof2292">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">df</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="definition_function_types_map_base">definition_function_types_map_base</a></span> (<span class="id">f</span>:<span class="kwd">Type</span>-&gt;<span class="kwd">Type</span>) (<span class="id">dft</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>): <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">dft</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="id">f</span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id">f</span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id">f</span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="definition_function_types_subgradient">definition_function_types_subgradient</a></span> (<span class="id">dft</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_map_base">definition_function_types_map_base</a></span> (<span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">t</span>)) <span class="id">dft</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_eval_gradient">df_eval_gradient</a></span> {<span class="id">T</span>} σ (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">lv</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.lib_utils.LibUtilsLiftIterators.html#listo_to_olist">listo_to_olist</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span>) <span class="id">lv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="combine_prod">combine_prod</a></span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">l12</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list_prod">list_prod</a></span> <span class="id">l1</span> <span class="id">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>,<span class="id">y</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="id">l12</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.deriv2">deriv2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="dft_one">dft_one</a></span> (<span class="id">dft</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">dft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">dft</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.scalar_ind">scalar_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="is_scalar_function_ind_gen">is_scalar_function_ind_gen</a></span> {<span class="id">Ann</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">P</span>:<span class="kwd">forall</span> {<span class="id">T</span>}, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>-&gt;<span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fnumber</span>:<span class="kwd">forall</span> <span class="id">ann</span> <span class="id">x</span>, <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fconstant</span>:<span class="kwd">forall</span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">x</span>, <span class="id">P</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fvar</span>:<span class="kwd">forall</span> <span class="id">sv</span> <span class="id">ann</span>, <span class="id">P</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">_</span> (<span class="id">sv</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">ann</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fplus</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fminus</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ftimes</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fdivide</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsquare</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fexp</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">flog</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fabs</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsign</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fpsign</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fmax</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">T</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) {<span class="kwd">struct</span> <span class="id">df</span>} : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">df</span> -&gt; <span class="id">P</span> <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2293')">Proof.</div>
<div class="proofscript" id="proof2293">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">df</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">isc</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fnumber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">isc</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">fconstant</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">isc</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">fvar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">ftimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fdivide</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fsquare</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">flog</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fabs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fsign</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fpsign</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">fmax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_scalar_function_ind">is_scalar_function_ind</a></span> {<span class="id">Ann</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">P</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>-&gt;<span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fnumber</span>:<span class="kwd">forall</span> <span class="id">ann</span> <span class="id">x</span>, <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fconstant</span>:<span class="kwd">forall</span> (<span class="id">ann</span>:<span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">x</span>, <span class="id">P</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">_</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> <span class="id">ann</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fvar</span>:<span class="kwd">forall</span> <span class="id">sv</span> <span class="id">ann</span>, <span class="id">P</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">_</span> (<span class="id">sv</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">ann</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fplus</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fminus</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ftimes</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fdivide</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsquare</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fexp</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">flog</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fabs</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fsign</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fpsign</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">e</span>, <span class="id">P</span> <span class="id">e</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">a</span> <span class="id">e</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fmax</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">a</span> <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">df</span> -&gt; <span class="id">P</span> <span class="id">df</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2294')">Proof.</div>
<div class="proofscript" id="proof2294">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function_ind_gen">is_scalar_function_ind_gen</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="kwd">match</span> <span class="id">t</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">fun</span> <span class="id">df</span> =&gt; <span class="id">P</span> <span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vartlookup_eq">vartlookup_eq</a></span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) : <span class="kwd">Prop</span> := <span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">l1</span> <span class="id">a</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">l2</span> <span class="id">a</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="vartlookup_eq_equiv">vartlookup_eq_equiv</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_eq">vartlookup_eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2295')">Proof.</div>
<div class="proofscript" id="proof2295">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_eq">vartlookup_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span>; <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.scalar_ind">scalar_ind</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lookup_update">lookup_update</a></span> (<span class="id">xv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">gradenv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">val</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xv</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_update">vart_update</a></span> <span class="id">gradenv</span> <span class="id">xv</span> <span class="id">val</span>) <span class="id">xv</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2296')">Proof.</div>
<div class="proofscript" id="proof2296">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">gradenv</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">xv</span>); [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">x</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">xv</span>); [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lookup_update_neq">lookup_update_neq</a></span> (<span class="id">xv1</span> <span class="id">xv2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">gradenv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">val</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xv1</span>)) : <span class="id">xv1</span> &lt;&gt; <span class="id">xv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_update">vart_update</a></span> <span class="id">gradenv</span> <span class="id">xv1</span> <span class="id">val</span>) <span class="id">xv2</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> <span class="id">xv2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2297')">Proof.</div>
<div class="proofscript" id="proof2297">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">neq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">gradenv</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv2</span> <span class="id">xv1</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv1</span> <span class="id">x</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv2</span> <span class="id">xv1</span>); [<span class="tactic">congruence</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv2</span> <span class="id">x</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv2</span> <span class="id">x</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lookup_update2">lookup_update2</a></span> (<span class="id">xv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">gradenv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">val</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">xv</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id">xv</span> <span class="id">val</span>) :: <span class="id">gradenv</span>) <span class="id">xv</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2298')">Proof.</div>
<div class="proofscript" id="proof2298">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">gradenv</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">xv</span>); [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">x</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">xv</span>); [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">xv</span> <span class="id">xv</span>); [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">DefinedFunction_scalar_cases</span>" <span class="id">tactic</span>(<span class="id">first</span>) <span class="id">ident</span>(<span class="id">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Number</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Constant</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Var</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Plus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Minus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Times</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Divide</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Square</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Exp</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Log</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Abs</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Sign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">PSign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Max</span>"%<span class="id">string</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> {<span class="id">Ann</span> <span class="id">T</span>} {<span class="id">env</span>} {<span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>} {<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df</span> <span class="id">gradenv</span> <span class="id">grad</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">xv</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> <span class="id">xv</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">xv</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2299')">Proof.</div>
<div class="proofscript" id="proof2299">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">df</span>) <span class="id">Case</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>; <span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="id">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>; <span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="id">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> (<span class="id">x</span> <span class="id">a</span>) <span class="id">gradenv</span> (<span class="id">grad</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">a</span> (<span class="id">grad</span> <span class="id">a</span>) <span class="id">gradenv</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">d0</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> (<span class="id">x</span> <span class="id">i</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_none">list_env_iter_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{  <span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">trivial</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">gradenv</span> <span class="id">d</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">a</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ <span class="tactic">intros</span> <span class="id">dd</span> <span class="id">ddeqq</span> | <span class="tactic">intros</span> <span class="id">ddeqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ddeqq</span> <span class="kwd">in</span> <span class="id">eqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">eqq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="kwd">forall</span> <span class="id">xv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> <span class="id">xv</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">dd</span> <span class="id">xv</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ <span class="tactic">eauto</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">d</span> <span class="id">IHl</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">gradenv</span> <span class="id">dd</span> <span class="id">ddeqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>); <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">gradenv</span> <span class="id">dd</span> <span class="id">ddeqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ddeqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">inversion</span> <span class="id">ddeqq</span>; <span class="tactic">subst</span>; <span class="tactic">trivial</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">gradenv</span> (<span class="id">grad</span> <span class="id">a</span> <span class="id">a0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dd2</span> <span class="id">ddeqq2</span> | <span class="tactic">intros</span> <span class="id">ddeqq2</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ddeqq2</span> <span class="kwd">in</span> <span class="id">ddeqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ddeqq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">destruct</span> <span class="id">l0</span>; <span class="tactic">simpl</span>; <span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> <span class="id">v</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_dec">vart_dec</a></span> <span class="id">v</span> <span class="id">xv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update">lookup_update</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update_neq">lookup_update_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">grad</span>) <span class="id">d</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> (<span class="id">d1</span> * <span class="id">grad</span>)) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">d1</span> * <span class="id">grad</span>) <span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id">d0</span> * <span class="id">grad</span>) <span class="id">d2</span> <span class="id">d</span>).       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> (<span class="id">grad</span> / <span class="id">d1</span>)) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">grad</span> / <span class="id">d1</span>) <span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (- <span class="id">d0</span> / (<span class="id">d1</span> * <span class="id">d1</span>) * <span class="id">grad</span>) <span class="id">d2</span> <span class="id">d</span>).       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (2 * <span class="id">d0</span> * <span class="id">grad</span>) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fexp">Fexp</a></span> <span class="id">d0</span>) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> / <span class="id">d0</span>) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> 0 <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> 0 <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">d0</span> &lt;= <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorDot</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>) ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> =&gt; <span class="id">rv</span> * <span class="id">grad</span>) <span class="id">d1</span>));  [|<span class="tactic">congruence</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> =&gt; <span class="id">rv</span> * <span class="id">grad</span>) <span class="id">d1</span>) <span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> =&gt; <span class="id">lv</span> * <span class="id">grad</span>) <span class="id">d0</span>) <span class="id">d2</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k1</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">k2</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0) <span class="id">gradenv</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) =&gt; <span class="id">grad</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) =&gt; <span class="id">grad</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>) <span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>) <span class="id">d2</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">casedf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">casedf1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">casedf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">gradenv</span> <span class="id">d</span> <span class="id">d0</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">gradenv</span> <span class="id">d</span> <span class="id">d0</span> <span class="id">d0eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df2</span> <span class="id">d0</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">a</span>)); <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> (<span class="id">IHl</span> <span class="id">d0</span> <span class="id">_</span> <span class="id">d1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">IHdf2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>) <span class="id">d2</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d0</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; - <span class="id">grad</span> <span class="id">i</span>) <span class="id">d0</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d0</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span> <span class="id">grad</span>) ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt; - <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">d1</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">d1</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">d0</span> * <span class="id">grad</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d2</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df1</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">df1</span> <span class="id">gradenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gradenv</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt; <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d2</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">df2</span>)  ; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lifted_type">lifted_type</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>) <span class="kwd">as</span> <span class="id">vt</span> <span class="kwd">return</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lifted_type">lifted_type</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) <span class="id">vt</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">df</span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">df</span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>))::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">df</span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">j</span>))::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="subvar">subvar</a></span> (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> <span class="kwd">as</span> <span class="id">y</span> <span class="kwd">return</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span> = <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">y</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt;  <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">grad</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; ((<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">val</span>):<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) - <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fopp">Fopp</a></span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">grad</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> =&gt; (((<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">val</span>):<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) <span class="id">i</span>) - (<span class="id">grad</span> <span class="id">i</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fopp">Fopp</a></span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">grad</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (((<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">val</span>):<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">i</span> <span class="id">j</span>) - (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fopp">Fopp</a></span>) <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2300')">Next Obligation.</div>
<div class="proofscript" id="proof2300">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2301')">Next Obligation.</div>
<div class="proofscript" id="proof2301">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2302')">Next Obligation.</div>
<div class="proofscript" id="proof2302">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_eval_backprop_delta">df_eval_backprop_delta</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="df_eval_backward_gen_top">df_eval_backward_gen_top</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lifted_type">lifted_type</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) <span class="id">T</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">as</span> <span class="id">vt</span> <span class="kwd">return</span> <span class="id">T</span> = <span class="id">vt</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lifted_type">lifted_type</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) <span class="id">vt</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> =&gt; (<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="transpose_lifted_type">transpose_lifted_type</a></span> {<span class="id">T1</span> <span class="id">T2</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lifted_type">lifted_type</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T1</span>) <span class="id">T2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lifted_type">lifted_type</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T2</span>) <span class="id">T1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">T1</span>, <span class="id">T2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>, <span class="id">_</span> =&gt; <span class="kwd">fun</span> <span class="id">inp</span> =&gt; <span class="id">inp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">fun</span> <span class="id">inp</span> =&gt; <span class="id">inp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n2</span> =&gt; <span class="kwd">fun</span> <span class="id">inp</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">inp</span> <span class="id">j</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m1</span> <span class="id">n1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m2</span> <span class="id">n2</span> =&gt; <span class="kwd">fun</span> <span class="id">inp</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> <span class="id">p</span> <span class="id">q</span> =&gt; <span class="id">inp</span> <span class="id">p</span> <span class="id">q</span> <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m2</span> <span class="id">n2</span> =&gt; <span class="kwd">fun</span> <span class="id">inp</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">p</span> <span class="id">q</span> =&gt; <span class="id">inp</span> <span class="id">p</span> <span class="id">q</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m1</span> <span class="id">n1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n2</span> =&gt; <span class="kwd">fun</span> <span class="id">inp</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> <span class="id">p</span> =&gt; <span class="id">inp</span> <span class="id">p</span> <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.deriv_deriv">deriv_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.deriv_deriv">deriv_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.max_derived">max_derived</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="MaxDerived">MaxDerived</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span>  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">b</span> <span class="id">a</span>)) <span class="id">b</span>) <span class="id">a</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 2).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Delimit</span> <span class="kwd">Scope</span> <span class="id">df_scope</span> <span class="kwd">with</span> <span class="id">df</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> + <span class="id">y</span>" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">only</span> <span class="id">printing</span>) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> - <span class="id">y</span>" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">only</span> <span class="id">printing</span>) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> / <span class="id">y</span>" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">only</span> <span class="id">printing</span>) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span> * <span class="id">y</span>" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">only</span> <span class="id">printing</span>) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span>" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">x</span>) (<span class="id">only</span> <span class="id">printing</span>, <span class="tactic">at</span> <span class="id">level</span> 0) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">x</span>" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">x</span>) (<span class="id">only</span> <span class="id">printing</span>, <span class="tactic">at</span> <span class="id">level</span> 0) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "'|' <span class="id">x</span> '|'" := (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">x</span>) (<span class="id">only</span> <span class="id">printing</span>, <span class="tactic">at</span> <span class="id">level</span> 0) : <span class="id">df_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.max_derived">max_derived</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="DefinedFunctions.fv">fv</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_free_variables">df_free_variables</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">f</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">f</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vlconcat_map">vlconcat_map</a></span> <span class="id">df_free_variables</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vlconcat_map">vlconcat_map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vlconcat_map">vlconcat_map</a></span> <span class="id">df_free_variables</span> <span class="id">a</span>) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">_</span> =&gt; <span class="id">v</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">df_free_variables</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">df_free_variables</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">df_free_variables</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">df_free_variables</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">df_free_variables</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">df_free_variables</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id">df_free_variables</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_free_variables</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">df_free_variables</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">df_free_variables</span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">x</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">x</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">df_free_variables</span> <span class="id">l</span>) ++ (<span class="id">df_free_variables</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#remove_all">remove_all</a></span> (<span class="id">x</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">df_free_variables</span> <span class="id">s</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ (<span class="id">df_free_variables</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#remove_all">remove_all</a></span> (<span class="id">x</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">df_free_variables</span> <span class="id">s</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ (<span class="id">df_free_variables</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#remove_all">remove_all</a></span> (<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#remove_all">remove_all</a></span> (<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">df_free_variables</span> <span class="id">s</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ (<span class="id">df_free_variables</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#remove_all">remove_all</a></span> (<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#remove_all">remove_all</a></span> (<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">df_free_variables</span> <span class="id">s</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ (<span class="id">df_free_variables</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_closed">df_closed</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">f</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_free_variables">df_free_variables</a></span> <span class="id">f</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_closed_nil">df_closed_nil</a></span> {<span class="id">T</span>} (<span class="id">f</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_closed">df_closed</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_free_variables">df_free_variables</a></span> <span class="id">f</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2303')">Proof.</div>
<div class="proofscript" id="proof2303">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_closed">df_closed</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_free_variables">df_free_variables</a></span> <span class="id">f</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="df_closed_over">df_closed_over</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">f</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_free_variables">df_free_variables</a></span> <span class="id">f</span>) <span class="id">vl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="fully_closed_over">fully_closed_over</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (<span class="id">df</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">df</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">f</span> <span class="id">vl</span>) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="kwd">fun</span> <span class="id">row</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vforall">vforall</a></span> (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">f</span> <span class="id">vl</span>) <span class="id">row</span>)) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">v</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">e</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">e</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">e</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">e</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">e</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">e</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">x</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">x</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>) /\ (<span class="id">fully_closed_over</span> <span class="id">r</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">s</span> ((<span class="id">x</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">s</span> ((<span class="id">x</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">s</span> ((<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::(<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; (<span class="id">fully_closed_over</span> <span class="id">s</span> ((<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::(<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id">fully_closed_over</span> <span class="id">l</span> <span class="id">vl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="In_compat_map">In_compat_map</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">v</span> <span class="id">vl</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">v</span> (<span class="id">f</span> <span class="id">vl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="map_tl">map_tl</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">vl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">vl1</span> =&gt; <span class="id">a</span> :: <span class="id">f</span> <span class="id">vl1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">f</span> <span class="id">vl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="In_compat_map_tl">In_compat_map_tl</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#map_tl">map_tl</a></span> <span class="id">f</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2304')">Proof.</div>
<div class="proofscript" id="proof2304">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_over_map">fully_closed_over_map</a></span> {<span class="id">T</span>} (<span class="id">df</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span> <span class="id">f</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">f</span> <span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2305')">Proof.</div>
<div class="proofscript" id="proof2305">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">f</span>; <span class="id">revert</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">solve</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions.fv">fv</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="tactic">apply</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="df_apply">df_apply</a></span> {<span class="id">T</span>} (<span class="id">e</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">args</span>: <span class="kwd">forall</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>),  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id">t</span> <span class="id">_</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Constant">Constant</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">df_apply</span> (<span class="id">df</span> <span class="id">x</span>) <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">df</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">df_apply</span> (<span class="id">df</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Var">Var</a></span> <span class="id">v</span> <span class="id">_</span> =&gt; <span class="id">args</span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Square">Square</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">e</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">e</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Log">Log</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">e</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Abs">Abs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">e</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Sign">Sign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">e</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id">_</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#PSign">PSign</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">e</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorElem">VectorElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixElem">MatrixElem</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) <span class="id">i</span> <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorDot">VectorDot</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixSum">MatrixSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>)                                     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">x</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">x</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">p</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorMinus">VectorMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixPlus">MatrixPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixMinus">MatrixMinus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">r</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> (<span class="id">df_apply</span> <span class="id">s</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">x</span> <span class="id">s</span> <span class="id">l</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">x</span> (<span class="id">df_apply</span> <span class="id">s</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id">n</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v1</span> <span class="id">v2</span> (<span class="id">df_apply</span> <span class="id">s</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">_</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">s</span> <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">v1</span> <span class="id">v2</span> (<span class="id">df_apply</span> <span class="id">s</span> <span class="id">args</span>) (<span class="id">df_apply</span> <span class="id">l</span> <span class="id">args</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;<span class="kwd">End</span> <span class="tactic">apply</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunctions">DefinedFunctions</a></span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">DefinedFunction_cases</span>" <span class="id">tactic</span>(<span class="id">first</span>) <span class="id">ident</span>(<span class="id">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Number</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Constant</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">DVector</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">DMatrix</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Var</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Plus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Minus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Times</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Divide</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Square</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Exp</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Log</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Abs</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Sign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">PSign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Max</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorDot</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorSum</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>             <br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorElem</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>             <br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VectorApply</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>             <br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">VLossfun</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">refl_simpler</span> := <br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type_UIP_refl">var_type_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type_UIP_refl">var_type_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_UIP_refl">definition_function_types_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: @<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_UIP_refl">definition_function_types_UIP_refl</a></span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="real_pfs">real_pfs</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Existing</span> <span class="kwd">Instance</span> <span class="id">floatish_R</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id">Reals</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="MaxDerivedMax_eq">MaxDerivedMax_eq</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> σ, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">a</span> <span class="id">b</span>) = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MaxDerived">MaxDerived</a></span> <span class="id">a</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2306')">Proof.</div>
<div class="proofscript" id="proof2306">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span> σ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">a</span>); <span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">b</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">Rarith</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">DefinedFunction_scalar_cases</span>" <span class="id">tactic</span>(<span class="id">first</span>) <span class="id">ident</span>(<span class="id">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Number</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Constant</span>"%<span class="id">string</span>                 <br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Var</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Plus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Minus</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Times</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Divide</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Square</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Exp</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Log</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Abs</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Sign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">PSign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Max</span>"%<span class="id">string</span>].<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backpropeq_gen">backpropeq_gen</a></span> (<span class="id">x</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">env</span> <span class="id">gradenv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">dfexpr</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">xvar</span> := (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">dfexpr</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">dfexpr</span> <span class="id">xvar</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_lookup">backprop_lookup</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span>) <span class="id">xvar</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_lookup">backprop_lookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">dfexpr</span> <span class="id">gradenv</span> <span class="id">grad</span>) <span class="id">xvar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">dval</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">bval0</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">bval1</span> =&gt; (<span class="id">dval</span>*<span class="id">grad</span> + <span class="id">bval0</span>)%<span class="id">R</span> = <span class="id">bval1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2307')">Proof.</div>
<div class="proofscript" id="proof2307">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad</span> <span class="id">gradenv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pattern</span> <span class="id">dfexpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">dfexpr</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_scalar_cases</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function_ind">is_scalar_function_ind</a></span>) <span class="id">Case</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">_</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">_</span> <span class="id">xinn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; [| <span class="tactic">tauto</span>]; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">_</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">_</span> <span class="id">xinn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; [| <span class="tactic">tauto</span>]; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">sv</span> <span class="id">_</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">_</span> <span class="id">xinn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; [| <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_dec">var_dec</a></span> <span class="id">x</span> <span class="id">sv</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update">lookup_update</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">sv</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">sv</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">sv</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">congruence</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">sv</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update_neq">lookup_update_neq</a></span> <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> <span class="id">IHl</span> <span class="id">IHr</span> <span class="id">grad</span> <span class="id">gradenv</span> [<span class="id">isc1</span> <span class="id">isc2</span>] <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">l</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dl</span> <span class="id">eqdl</span> | <span class="tactic">intros</span> <span class="id">eqdl</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">r</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dr</span> <span class="id">eqdr</span> | <span class="tactic">intros</span> <span class="id">eqdr</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdr</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHr</span> <span class="id">grad</span> <span class="id">ge</span>' <span class="id">isc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHr</span>; [ | <span class="tactic">congruence</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_lookup">backprop_lookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">r</span> <span class="id">ge</span>' <span class="id">grad</span>) (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> <span class="id">grad</span> ); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHr</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> <span class="id">grad</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> <span class="id">IHl</span> <span class="id">IHr</span> <span class="id">grad</span> <span class="id">gradenv</span> [<span class="id">isc1</span> <span class="id">isc2</span>] <span class="id">xinn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">l</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dl</span> <span class="id">eqdl</span> | <span class="tactic">intros</span> <span class="id">eqdl</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">r</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dr</span> <span class="id">eqdr</span> | <span class="tactic">intros</span> <span class="id">eqdr</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdr</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHr</span> (- <span class="id">grad</span>)%<span class="id">R</span> <span class="id">ge</span>' <span class="id">isc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHr</span>; [ | <span class="tactic">congruence</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_lookup">backprop_lookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">r</span> <span class="id">ge</span>' (- <span class="id">grad</span>)%<span class="id">R</span>) (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> <span class="id">grad</span> ); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHr</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> <span class="id">grad</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> <span class="id">IHl</span> <span class="id">IHr</span> <span class="id">grad</span> <span class="id">gradenv</span> [<span class="id">isc1</span> <span class="id">isc2</span>] <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">l</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">le</span> <span class="id">eqle</span> | <span class="tactic">intros</span> <span class="id">eqle</span>]; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">l</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dl</span> <span class="id">eqdl</span> | <span class="tactic">intros</span> <span class="id">eqdl</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">r</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">re</span> <span class="id">eqre</span> | <span class="tactic">intros</span> <span class="id">eqre</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">r</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dr</span> <span class="id">eqdr</span> | <span class="tactic">intros</span> <span class="id">eqdr</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdr</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">IHl</span> (<span class="id">re</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> (<span class="id">re</span> * <span class="id">grad</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHr</span> (<span class="id">le</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">ge</span>' <span class="id">isc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHr</span>; [ | <span class="tactic">congruence</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_lookup">backprop_lookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">r</span> <span class="id">ge</span>' (<span class="id">le</span> * <span class="id">grad</span>)%<span class="id">R</span>) (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> (<span class="id">re</span> * <span class="id">grad</span>)%<span class="id">R</span> ); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHr</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">r</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">re</span> <span class="id">eqre</span> | <span class="tactic">intros</span> <span class="id">eqre</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> (<span class="id">re</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> (<span class="id">re</span> * <span class="id">grad</span>)%<span class="id">R</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> <span class="id">IHl</span> <span class="id">IHr</span> <span class="id">grad</span> <span class="id">gradenv</span> [<span class="id">isc1</span> <span class="id">isc2</span>] <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">l</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">le</span> <span class="id">eqle</span> | <span class="tactic">intros</span> <span class="id">eqle</span>]; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">l</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dl</span> <span class="id">eqdl</span> | <span class="tactic">intros</span> <span class="id">eqdl</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">r</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">re</span> <span class="id">eqre</span> | <span class="tactic">intros</span> <span class="id">eqre</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">r</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">dr</span> <span class="id">eqdr</span> | <span class="tactic">intros</span> <span class="id">eqdr</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqdr</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">IHl</span> (<span class="id">grad</span> / <span class="id">re</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> (<span class="id">grad</span> / <span class="id">re</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHr</span> (- <span class="id">le</span> / (<span class="id">re</span> * <span class="id">re</span>) * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">ge</span>' <span class="id">isc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHr</span>; [ | <span class="tactic">congruence</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_lookup">backprop_lookup</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">r</span> <span class="id">ge</span>' (- <span class="id">le</span>  / (<span class="id">re</span> * <span class="id">re</span>) * <span class="id">grad</span>)%<span class="id">R</span>) (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> (<span class="id">grad</span> / <span class="id">re</span>)%<span class="id">R</span> ); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHr</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">r</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">re</span> <span class="id">eqre</span> | <span class="tactic">intros</span> <span class="id">eqre</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> (<span class="id">grad</span> / <span class="id">re</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">l</span> <span class="id">gradenv</span> (<span class="id">grad</span> / <span class="id">re</span>)%<span class="id">R</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">xinn</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">e</span> <span class="id">IHe</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">e</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">le</span> <span class="id">eqee</span> | <span class="tactic">intros</span> <span class="id">eqee</span>]; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> (2 * <span class="id">le</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">de</span> <span class="id">eqde</span> | <span class="tactic">intros</span> <span class="id">eqde</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqde</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">e</span> <span class="id">gradenv</span> (2 * <span class="id">le</span> * <span class="id">grad</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">e</span> <span class="id">IHe</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">e</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">le</span> <span class="id">eqee</span> | <span class="tactic">intros</span> <span class="id">eqee</span>]; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">le</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">de</span> <span class="id">eqde</span> | <span class="tactic">intros</span> <span class="id">eqde</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqde</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">e</span> <span class="id">gradenv</span> (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">le</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">e</span> <span class="id">IHe</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">e</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">le</span> <span class="id">eqee</span> | <span class="tactic">intros</span> <span class="id">eqee</span>]; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> (<span class="id">grad</span> / <span class="id">le</span>)%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">de</span> <span class="id">eqde</span> | <span class="tactic">intros</span> <span class="id">eqde</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqde</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">e</span> <span class="id">gradenv</span> (<span class="id">grad</span> / <span class="id">le</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">e</span> <span class="id">IHe</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">e</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">intros</span> <span class="id">le</span> <span class="id">eqee</span> | <span class="tactic">intros</span> <span class="id">eqee</span>]; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> (<span class="id">grad</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">le</span>))%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">de</span> <span class="id">eqde</span> | <span class="tactic">intros</span> <span class="id">eqde</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqde</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">e</span> <span class="id">gradenv</span> (<span class="id">grad</span> * (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span>  <span class="id">le</span>))%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">e</span> <span class="id">IHe</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> 0%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">de</span> <span class="id">eqde</span> | <span class="tactic">intros</span> <span class="id">eqde</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqde</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">e</span> <span class="id">gradenv</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">e</span> <span class="id">IHe</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> 0%<span class="id">R</span> <span class="id">gradenv</span> <span class="id">isc</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">gradenv</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span> <span class="id">xveqq</span> | <span class="tactic">intros</span> <span class="id">xveqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xveqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">e</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">de</span> <span class="id">eqde</span> | <span class="tactic">intros</span> <span class="id">eqde</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqde</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">e</span> <span class="id">gradenv</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">ge</span>' <span class="id">ge</span>'<span class="id">eq</span> | <span class="tactic">intros</span> <span class="id">ge</span>'<span class="id">eq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">ge</span>'<span class="id">eq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">ge</span>' (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> <span class="id">xv</span>' <span class="id">xv</span>'<span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">xv</span>'<span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">xv</span>'<span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span> <span class="id">l</span> <span class="id">r</span> <span class="id">IHl</span> <span class="id">IHr</span> <span class="id">grad</span> <span class="id">gradenv</span> [<span class="id">isc1</span> <span class="id">isc2</span>] <span class="id">xinn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc1</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHr</span> <span class="id">grad</span> <span class="id">gradenv</span> <span class="id">isc2</span> <span class="id">xinn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">eld</span> <span class="id">eqeld</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">r</span> ); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">eld</span> <span class="id">d</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">r</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> <span class="id">env</span> <span class="id">l</span> (<span class="id">x</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2308')">Proof.</div>
<div class="proofscript" id="proof2308">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> σ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">congruence</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> σ); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id">match_option</span>; <span class="tactic">tauto</span> | <span class="id">easy</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> σ); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id">match_option</span>; <span class="tactic">tauto</span> | <span class="id">easy</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> σ); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intro</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">i0</span> σ); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">now</span> <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i0</span>).        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> σ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id">IH</span>σ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>) :: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_fully_closed_total">eval_fully_closed_total</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">d</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> | <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2309')">Proof.</div>
<div class="proofscript" id="proof2309">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">exists</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="closed_over_cons">closed_over_cons</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_closed_over">df_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_closed_over">df_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span>::<span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2310')">Proof.</div>
<div class="proofscript" id="proof2310">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_closed_over">df_closed_over</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl_tl">incl_tl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_over_cons">fully_closed_over_cons</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span>::<span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2311')">Proof.</div>
<div class="proofscript" id="proof2311">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_map">fully_closed_over_map</a></span> <span class="id">df</span> <span class="id">vl</span> (<span class="kwd">fun</span> <span class="id">vl1</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">v</span> <span class="id">vl1</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_cons">in_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_over_exchange_vars">fully_closed_over_exchange_vars</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v1</span> <span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v1</span> :: <span class="id">v</span> :: <span class="id">vl</span>) -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span> :: <span class="id">v1</span> :: <span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2312')">Proof.</div>
<div class="proofscript" id="proof2312">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_map">fully_closed_over_map</a></span> <span class="id">df</span> (<span class="id">v1</span> :: <span class="id">v</span> :: <span class="id">vl</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">vl1</span> =&gt; <span class="kwd">match</span> <span class="id">vl1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">b</span> :: <span class="id">vl2</span>  =&gt; <span class="id">b</span> :: <span class="id">a</span> :: <span class="id">vl2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">vl1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>  )); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_over_singleton">fully_closed_over_singleton</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span>::<span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2313')">Proof.</div>
<div class="proofscript" id="proof2313">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_exchange_vars">fully_closed_over_exchange_vars</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_cons">fully_closed_over_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_over_exchange_2vars">fully_closed_over_exchange_2vars</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v1</span> <span class="id">v2</span> <span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v1</span> :: <span class="id">v2</span> :: <span class="id">v</span>:: <span class="id">vl</span>) -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span> :: <span class="id">v1</span> :: <span class="id">v2</span> :: <span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2314')">Proof.</div>
<div class="proofscript" id="proof2314">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_map">fully_closed_over_map</a></span> <span class="id">df</span> (<span class="id">v1</span> :: <span class="id">v2</span> :: <span class="id">v</span> :: <span class="id">vl</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">vl1</span> =&gt; <span class="kwd">match</span> <span class="id">vl1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">b</span> :: <span class="id">c</span> :: <span class="id">vl2</span>  =&gt; <span class="id">c</span> :: <span class="id">a</span> :: <span class="id">b</span> :: <span class="id">vl2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">vl1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>  )); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#In_compat_map">In_compat_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_over_pair">fully_closed_over_pair</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>): <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v1</span>::<span class="id">v2</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v1</span>::<span class="id">v2</span>::<span class="id">vl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2315')">Proof.</div>
<div class="proofscript" id="proof2315">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_exchange_2vars">fully_closed_over_exchange_2vars</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_exchange_2vars">fully_closed_over_exchange_2vars</a></span>.     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_cons">fully_closed_over_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_subst">fully_closed_subst</a></span> {<span class="id">T</span>} (<span class="id">vl</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span>':<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> (<span class="id">v</span>::<span class="id">vl</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">e</span>' <span class="id">vl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id">df</span> <span class="id">v</span> <span class="id">e</span>') <span class="id">vl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2316')">Proof.</div>
<div class="proofscript" id="proof2316">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">solve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">easy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>; [<span class="tactic">apply</span> <span class="id">H</span> | <span class="tactic">apply</span> <span class="id">H0</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">apply</span> <span class="id">IHdf1</span>; [<span class="tactic">apply</span> <span class="id">H</span> | <span class="tactic">apply</span> <span class="id">H0</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">IHdf2</span>; [<span class="tactic">apply</span> <span class="id">H1</span> | <span class="tactic">apply</span> <span class="id">H0</span>]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span>); <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">i0</span>); <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#substvar">substvar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#substvar">substvar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [ | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">destruct</span> <span class="id">v0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fully_closed_deriv">fully_closed_deriv</a></span> {<span class="id">T</span>} (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">s</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vl</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="id">vl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2317')">Proof.</div>
<div class="proofscript" id="proof2317">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span>; <span class="id">revert</span> <span class="id">vl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">solve</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">easy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>,<span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span> |  <span class="tactic">apply</span> <span class="id">IHdf1</span>, <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="tactic">apply</span> <span class="id">IHdf1</span>, <span class="id">H</span> |  <span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>, <span class="id">H</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>, <span class="id">H</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_subst">fully_closed_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_singleton">fully_closed_over_singleton</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_subst">fully_closed_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_singleton">fully_closed_over_singleton</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_subst">fully_closed_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_subst">fully_closed_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_pair">fully_closed_over_pair</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_cons">fully_closed_over_cons</a></span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_subst">fully_closed_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_subst">fully_closed_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_pair">fully_closed_over_pair</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over_cons">fully_closed_over_cons</a></span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_total_fun">list_env_iter_total_fun</a></span> {<span class="id">A</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">env0</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>), (<span class="id">f</span> <span class="id">a</span> <span class="id">env0</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2318')">Proof.</div>
<div class="proofscript" id="proof2318">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">env</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; [<span class="tactic">simpl</span>; <span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">a</span> <span class="id">env0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">env0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="tactic">apply</span> (<span class="id">IHl</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2319')">Proof.</div>
<div class="proofscript" id="proof2319">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">congruence</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">env</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">i</span>))    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H</span> <span class="id">a</span> (<span class="id">grad</span> <span class="id">a</span>) <span class="id">env0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">env</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> <span class="id">env0</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> <span class="id">env</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">a</span> <span class="id">j</span>))    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env0</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H</span> <span class="id">a</span> <span class="id">a0</span>  (<span class="id">grad</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">env1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">grad</span>)%<span class="id">R</span> <span class="id">d</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">d0</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id">d</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">d1</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">grad</span> / <span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">d</span> / (<span class="id">d0</span> * <span class="id">d0</span>) * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">d1</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (2 * <span class="id">d</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d</span>)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> / <span class="id">d</span>)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d</span>)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf1</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorDot</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d0</span>) <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d</span>) <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0%<span class="id">R</span>) <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="kwd">if</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span>  (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (@<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">d0</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">v0</span> <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span> <span class="id">df1</span> <span class="id">v</span> ((<span class="id">v</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">m0</span> <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>; <span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span> <span class="id">df1</span> <span class="id">v</span> ((<span class="id">v</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>):: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">v</span> <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span> <span class="id">df1</span> <span class="id">v1</span> ((<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::(<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>) ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">m0</span> <span class="id">grad_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>; <span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span> <span class="id">df1</span> <span class="id">v1</span> ((<span class="id">v1</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::(<span class="id">v2</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>) ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span> <span class="id">x0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_deriv_fully_closed_total">backprop_deriv_fully_closed_total</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad_env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">d</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> | <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> <span class="id">grad</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2320')">Proof.</div>
<div class="proofscript" id="proof2320">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">exists</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> <span class="id">grad</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_deriv_fully_closed_not_none">eval_deriv_fully_closed_not_none</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2321')">Proof.</div>
<div class="proofscript" id="proof2321">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> σ <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">specialize</span> (<span class="id">IHdf1</span> σ <span class="id">v</span>); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> σ <span class="id">v</span>); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> σ <span class="id">v</span>); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d</span> <span class="id">d0</span> ); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>) :: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)(<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_deriv_fully_closed_total">eval_deriv_fully_closed_total</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">d</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> | <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span> <span class="id">v</span>  = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2322')">Proof.</div>
<div class="proofscript" id="proof2322">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span> <span class="id">v</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">exists</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_fully_closed_not_none">eval_deriv_fully_closed_not_none</a></span> σ <span class="id">df</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">df</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2323')">Proof.</div>
<div class="proofscript" id="proof2323">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> σ <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">specialize</span> (<span class="id">IHdf1</span> σ <span class="id">v</span>); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> σ <span class="id">v</span>); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> σ <span class="id">v</span>); <span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d</span> <span class="id">d0</span> ); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>) :: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> σ <span class="id">v</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>  σ <span class="id">df2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_not_none">vectoro_to_ovector_not_none</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span> <span class="id">i0</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="id">v1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scalarMult">scalarMult</a></span> (<span class="id">T</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) (<span class="id">c</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">return</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">fun</span> <span class="id">f</span> =&gt; (<span class="id">c</span> * <span class="id">f</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * <span class="id">f</span> <span class="id">i</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span> =&gt; <span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">f</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="dfti_gen_plus">dfti_gen_plus</a></span> {<span class="id">T</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">return</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; <span class="kwd">fun</span> <span class="id">f</span> <span class="id">g</span> =&gt; (<span class="id">f</span> + <span class="id">g</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">f</span> <span class="id">g</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">f</span> <span class="id">i</span> + <span class="id">g</span> <span class="id">i</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span> =&gt; <span class="kwd">fun</span> <span class="id">f</span> <span class="id">g</span> =&gt; <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">f</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">g</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span> (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">oval</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">v</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sv</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">sv</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">oval</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> &lt;&gt; <span class="id">sv</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">sv</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_update">vart_update</a></span> <span class="id">env</span> <span class="id">v</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span> <span class="id">v</span> <span class="id">env</span> <span class="id">grad</span>)) <span class="id">oval</span> = 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2324')">Proof.</div>
<div class="proofscript" id="proof2324">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update_neq">lookup_update_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span> (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">oval</span> <span class="id">grad</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">oval</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_update">vart_update</a></span> <span class="id">env</span> <span class="id">v</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span> <span class="id">v</span> <span class="id">env</span> <span class="id">grad</span>)) <span class="id">oval</span> = <span class="id">grad</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2325')">Proof.</div>
<div class="proofscript" id="proof2325">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update">lookup_update</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="split_subvar">split_subvar</a></span> (<span class="id">env1</span> <span class="id">env2</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">oval</span> <span class="id">val1</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">s</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">env2</span> <span class="id">oval</span> = (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">env2</span> <span class="id">val1</span> + <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">env1</span> <span class="id">oval</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2326')">Proof.</div>
<div class="proofscript" id="proof2326">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> <span class="id">v</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_nil">vsum_nil</a></span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Vector.html#vnil">vnil</a></span> = 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2327')">Proof.</div>
<div class="proofscript" id="proof2327">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_mult">vsum_mult</a></span> {<span class="id">n</span>} (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) (<span class="id">c</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span>)%<span class="id">R</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">v</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2328')">Proof.</div>
<div class="proofscript" id="proof2328">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">Datatypes.id</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; [ | <span class="tactic">destruct</span> <span class="id">n</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_0">vector_fold_right1_dep_0</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_1">vector_fold_right1_dep_1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_SSn">vector_fold_right1_dep_SSn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>]; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_plus">vsum_plus</a></span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v1</span> <span class="id">v2</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v1</span> + <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v2</span>)%<span class="id">R</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">v1</span> <span class="id">i</span> + <span class="id">v2</span> <span class="id">i</span>)%<span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2329')">Proof.</div>
<div class="proofscript" id="proof2329">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">Datatypes.id</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; [ | <span class="tactic">destruct</span> <span class="id">m</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_0">vector_fold_right1_dep_0</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_1">vector_fold_right1_dep_1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_SSn">vector_fold_right1_dep_SSn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHm</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v1</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v2</span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span> <span class="id">v2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span> <span class="id">pf</span>]; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_mult">vmap_mult</a></span> {<span class="id">n</span>} (<span class="id">f</span>: <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> -&gt; <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">v</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) (<span class="id">c</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">v</span>) <span class="id">i</span>)%<span class="id">R</span> = (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">c</span> * <span class="id">f</span> <span class="id">x</span>)%<span class="id">R</span>) <span class="id">v</span>) <span class="id">i</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2330')">Proof.</div>
<div class="proofscript" id="proof2330">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_ext">vsum_ext</a></span> {<span class="id">n</span>} (<span class="id">v</span> <span class="id">v</span>':<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">v</span> <span class="id">v</span>' -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2331')">Proof.</div>
<div class="proofscript" id="proof2331">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_ext">vector_fold_right1_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_ext">msum_ext</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> <span class="id">mat</span>':<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span>, <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span> = <span class="id">mat</span>' <span class="id">i</span> <span class="id">j</span>) -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2332')">Proof.</div>
<div class="proofscript" id="proof2332">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> ?; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_mult">msum_mult</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id">c</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span>)%<span class="id">R</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">mat</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2333')">Proof.</div>
<div class="proofscript" id="proof2333">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_mmap_mult">msum_mmap_mult</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id">c</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span>)%<span class="id">R</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">c</span> * <span class="id">x</span>)%<span class="id">R</span> <span class="id">mat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2334')">Proof.</div>
<div class="proofscript" id="proof2334">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_mult">msum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_ext">msum_ext</a></span>; <span class="tactic">intros</span> <span class="id">i</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap_nth">mmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_mmap_div_denom">msum_mmap_div_denom</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) (<span class="id">c</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> <span class="id">u</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">u</span> / <span class="id">c</span>)%<span class="id">R</span>) <span class="id">mat</span>) = (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span> / <span class="id">c</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2335')">Proof.</div>
<div class="proofscript" id="proof2335">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> <span class="id">u</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (/ <span class="id">c</span> * <span class="id">u</span>)%<span class="id">R</span>) <span class="id">mat</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_ext">msum_ext</a></span>; <span class="tactic">intros</span> <span class="id">i</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap_nth">mmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_mmap_mult">msum_mmap_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum0">vsum0</a></span> <span class="id">n</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; 0%<span class="id">R</span>) = 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2336')">Proof.</div>
<div class="proofscript" id="proof2336">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; 0%<span class="id">R</span>) 0%<span class="id">R</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; [<span class="id">eassumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_unitvector">vsum_unitvector</a></span> {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span>) <span class="id">i</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">v</span> <span class="id">j</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) = <span class="id">v</span> <span class="id">i</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2337')">Proof.</div>
<div class="proofscript" id="proof2337">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">Datatypes.id</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span> <span class="id">v</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; [ | <span class="tactic">destruct</span> <span class="id">n</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_1">vector_fold_right1_dep_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; [ | <span class="id">lia</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_SSn">vector_fold_right1_dep_SSn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast">vlast</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- (<span class="id">_</span> + ?<span class="id">x</span>)%<span class="id">R</span> = <span class="id">_</span> ] =&gt; <span class="tactic">replace</span> <span class="id">x</span> <span class="kwd">with</span> 0%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum0">vsum0</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span>, <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fzero">Fzero</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">Datatypes.id</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span> <span class="kwd">in</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pf</span>:<span class="id">x</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="FormalML.utils.Vector.html#vdrop_last">vdrop_last</a></span> <span class="id">v</span>) <span class="id">pf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_dep_ext">vector_fold_right1_dep_ext</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_unitmatrix">msum_unitmatrix</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">i</span> <span class="id">j</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">k</span> <span class="id">l</span> =&gt; (<span class="id">v</span> <span class="id">k</span> <span class="id">l</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span> <span class="id">k</span> <span class="id">l</span>)%<span class="id">R</span>) = <span class="id">v</span> <span class="id">i</span> <span class="id">j</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2338')">Proof.</div>
<div class="proofscript" id="proof2338">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span> <span class="id">_</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) =&gt; @<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">l</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> <span class="id">k</span> <span class="id">l</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">l</span>) (` <span class="id">j</span>) <span class="kwd">then</span> 1%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">intros</span> ?; <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span> <span class="id">_</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">l</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">v</span> <span class="id">k</span>) <span class="id">l</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">l</span>) (` <span class="id">j</span>) <span class="kwd">then</span> 1%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>))%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span> <span class="id">_</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> <span class="id">k</span> <span class="id">j</span> <span class="kwd">else</span> 0%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span> <span class="id">_</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) =&gt; ((<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">v</span>) <span class="id">j</span> <span class="id">k</span> * @<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span> <span class="id">i</span> <span class="id">k</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">intros</span> ?; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dest_eqdec</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span>; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dest_eqdec</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dest_eqdec</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum0">vsum0</a></span> <span class="id">n</span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ?; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">vectoro_assert_forall_in</span> <span class="id">H</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> ?<span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">y</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span>, <span class="id">x</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">y</span> <span class="id">i</span>)) <span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> {<span class="id">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">i</span> <span class="id">env</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2339')">Proof.</div>
<div class="proofscript" id="proof2339">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">env</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_none">list_env_iter_none</a></span> <span class="id">f</span> <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">env0</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">env0</span>); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">IHl</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H1</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">H1</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="df_eval_deriv_scalar_same">df_eval_deriv_scalar_same</a></span> (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">s</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">df</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">df</span> <span class="id">v</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df</span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2340')">Proof.</div>
<div class="proofscript" id="proof2340">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pattern</span> <span class="id">df</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">df</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_scalar_cases</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function_ind">is_scalar_function_ind</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> (<span class="tactic">destruct</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">is_scalar</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H3</span> <span class="id">H1</span>); <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">H4</span> <span class="id">H2</span>); <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">trivial</span>; <span class="tactic">do</span> 2 <span class="id">match_option</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">e</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_fully_closed_not_none">eval_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv">df_eval_deriv</a></span> σ <span class="id">e</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_fully_closed_not_none">eval_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>; <span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">congruence</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">l</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">r</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">l</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">r</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))); [|<span class="tactic">congruence</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#pos_sign">pos_sign</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d</span> <span class="id">d0</span>); <span class="tactic">intros</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_dec">Rge_dec</a></span> (<span class="id">d0</span> - <span class="id">d</span>) 0); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_dec">Rge_dec</a></span> (<span class="id">d0</span> - <span class="id">d</span>) 0); <span class="id">lra</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vartlookup_list_env_iter2">vartlookup_list_env_iter2</a></span> {<span class="id">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">i</span> <span class="id">env</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2341')">Proof.</div>
<div class="proofscript" id="proof2341">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">l</span> <span class="id">env</span> <span class="id">fenv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scalarMult_list_env_iter">scalarMult_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">c</span> <span class="id">val1</span> <span class="id">val2</span>:<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">A</span> :<span class="kwd">Type</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">env1</span> <span class="id">env2</span> <span class="id">fenv1</span> <span class="id">fenv2</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env1</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">g</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env2</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span>:<span class="id">A</span>) (<span class="id">env1</span> <span class="id">env2</span> <span class="id">fenv1</span> <span class="id">fenv2</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v1</span> <span class="id">v2</span>: <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v2</span> -&gt;         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">i</span> <span class="id">env1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv1</span> -&gt; <span class="id">g</span> <span class="id">i</span> <span class="id">env2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv1</span> <span class="id">v1</span> = (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv2</span> <span class="id">v2</span>)%<span class="id">R</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">i</span> <span class="id">env</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">g</span> <span class="id">i</span> <span class="id">env</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv1</span> <span class="id">val1</span> = (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv2</span> <span class="id">val2</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2342')">Proof.</div>
<div class="proofscript" id="proof2342">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">l</span> <span class="id">env1</span> <span class="id">fenv1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">discriminate</span>.       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">H</span> <span class="id">H7</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <span class="id">s</span> <span class="id">g</span> <span class="id">l</span> <span class="id">env2</span> <span class="id">fenv2</span>); <span class="tactic">intros</span>.         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H0</span> <span class="id">H8</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val1</span> <span class="id">val2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>; <span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_none">list_env_iter_none</a></span> <span class="id">f</span> <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">env0</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">env0</span>); [<span class="tactic">intros</span>|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_none">list_env_iter_none</a></span> <span class="id">g</span> <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">g</span> <span class="id">a</span> <span class="id">env3</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">g</span> <span class="id">a</span> <span class="id">env3</span>); [<span class="tactic">intros</span>|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H4</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">trivial</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H5</span> <span class="id">env3</span> <span class="id">d0</span> <span class="id">a</span>); <span class="tactic">trivial</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">d</span> <span class="id">d0</span> <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span> <span class="id">env0</span> <span class="id">env3</span> <span class="id">d</span> <span class="id">d0</span> <span class="id">val0</span> <span class="id">val3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d</span> <span class="id">fenv1</span> <span class="id">val0</span> <span class="id">d1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">fenv2</span> <span class="id">val3</span> <span class="id">d2</span>); <span class="tactic">trivial</span>.         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H12</span> <span class="id">H15</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H15</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H18</span> <span class="id">H19</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_subvar_env2">list_env_iter_subvar_env2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">val1</span> <span class="id">val2</span>:<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">A</span> :<span class="kwd">Type</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">env1</span> <span class="id">env2</span> <span class="id">fenv1</span> <span class="id">fenv2</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env1</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">g</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env2</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span>:<span class="id">A</span>) (<span class="id">env1</span> <span class="id">env2</span> <span class="id">fenv1</span> <span class="id">fenv2</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">v1</span> <span class="id">v2</span>: <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v2</span> -&gt;         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">i</span> <span class="id">env1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv1</span> -&gt; <span class="id">g</span> <span class="id">i</span> <span class="id">env2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv1</span> <span class="id">v1</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv2</span> <span class="id">v2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">i</span> <span class="id">env</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">fenv</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">g</span> <span class="id">i</span> <span class="id">env</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fenv</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">fenv</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv1</span> <span class="id">val1</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv2</span> <span class="id">val2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2343')">Proof.</div>
<div class="proofscript" id="proof2343">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_list_env_iter">scalarMult_list_env_iter</a></span> <span class="id">s</span> 1%<span class="id">R</span> <span class="id">val1</span> <span class="id">val2</span> <span class="id">A</span> <span class="id">f</span> <span class="id">g</span> <span class="id">l</span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">fenv1</span> <span class="id">fenv2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">replace</span> (1 * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv2</span> <span class="id">val2</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv2</span> <span class="id">val2</span>) <span class="kwd">in</span> <span class="id">H6</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (1 * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv3</span> <span class="id">v2</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">fenv3</span> <span class="id">v2</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H3</span> <span class="id">i</span> <span class="id">env0</span> <span class="id">env3</span> <span class="id">fenv0</span> <span class="id">fenv3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">grad_env1</span> <span class="id">grad_env2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) (<span class="id">c</span>:<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> <span class="id">c</span> <span class="id">grad</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">grad_env1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> <span class="id">c</span> <span class="id">grad</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>) <span class="id">c</span> <span class="id">e</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">grad_env2</span> <span class="id">grad</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2344')">Proof.</div>
<div class="proofscript" id="proof2344">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">x0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">genv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">x0</span> <span class="id">genv</span> <span class="id">g</span>) <span class="id">grad_env2</span> <span class="id">x</span> <span class="id">grad</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_list_env_iter">scalarMult_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">c</span> <span class="id">d0</span> <span class="id">d</span> {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> (<span class="id">grad</span> <span class="id">i</span>) <span class="id">env1</span> <span class="id">env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H9</span> <span class="id">H10</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env1</span> (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env2</span> (<span class="id">grad</span> <span class="id">i</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>);  [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H11</span> <span class="id">H12</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H6</span>, <span class="id">H7</span>, <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">x0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">genv</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">x0</span> <span class="id">genv</span> <span class="id">g</span>) <span class="id">grad_env2</span> <span class="id">x</span> <span class="id">grad</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_list_env_iter">scalarMult_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">c</span> <span class="id">d0</span> <span class="id">d</span> {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_list_env_iter">scalarMult_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">c</span> <span class="id">v1</span> <span class="id">v2</span>  {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env1</span> <span class="id">env2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">i0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">env0</span> <span class="id">env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H13</span> <span class="id">H14</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">env0</span> (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">i0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">env3</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">i0</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>);  [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H15</span> <span class="id">H16</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>, <span class="id">H10</span>, <span class="id">H11</span>, <span class="id">H12</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H9</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H9</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env</span> <span class="id">fenv</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H7</span>).          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env</span> <span class="id">fenv</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H7</span>).                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_dec">vart_dec</a></span> <span class="id">v</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d1</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> <span class="id">grad</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d6</span> <span class="id">d</span> <span class="id">d4</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d5</span> <span class="id">d3</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d6</span> <span class="id">d4</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">inversion</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">grad</span>)%<span class="id">R</span> <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d1</span> (-(<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> (-<span class="id">grad</span>)%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d6</span> <span class="id">d</span> <span class="id">d4</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * -<span class="id">grad</span>)%<span class="id">R</span> <span class="kwd">with</span> (-(<span class="id">c</span>*<span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d5</span> <span class="id">d3</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d6</span> <span class="id">d4</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">inversion</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">d</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="id">d</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">H2</span>, <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> (<span class="id">d</span> * <span class="id">grad</span>)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id">d0</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * (<span class="id">d</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">d</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf1</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span> (<span class="id">d0</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="id">d0</span> * <span class="id">grad</span>)%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d2</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d1</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * (<span class="id">d0</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">d0</span> * (<span class="id">c</span>*<span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d2</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d1</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">grad</span> / <span class="id">d</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="id">c</span> * <span class="id">grad</span> / <span class="id">d</span>)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> (<span class="id">grad</span> / <span class="id">d</span>)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (- <span class="id">d0</span> / (<span class="id">d</span>*<span class="id">d</span>) * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * (<span class="id">grad</span> / <span class="id">d</span>))%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * <span class="id">grad</span> / <span class="id">d</span> )%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf1</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span> (- <span class="id">d0</span> /(<span class="id">d</span> * <span class="id">d</span>) * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (- <span class="id">d0</span> / (<span class="id">d</span> * <span class="id">d</span>) * <span class="id">grad</span>)%<span class="id">R</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d2</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d1</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * (-<span class="id">d0</span> / (<span class="id">d</span> * <span class="id">d</span>) * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">with</span> (- <span class="id">d0</span>/(<span class="id">d</span> * <span class="id">d</span>) * (<span class="id">c</span>*<span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d2</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d1</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (2 * <span class="id">d1</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">d1</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * (2 * <span class="id">d1</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">d1</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * (2 * <span class="id">d1</span> * <span class="id">grad</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d1</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * <span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d1</span>))%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * <span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d1</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> / <span class="id">d1</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> ); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * <span class="id">grad</span> / <span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * (<span class="id">grad</span> / <span class="id">d1</span>))%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * <span class="id">grad</span> / <span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">c</span> * (<span class="id">grad</span> / <span class="id">d1</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d1</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * <span class="id">grad</span> * (@<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">d1</span>))%<span class="id">R</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">c</span> * (<span class="id">grad</span> * (@<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">d1</span>)))%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">c</span> * <span class="id">grad</span> * (@<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">d1</span>))%<span class="id">R</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">c</span> * (<span class="id">grad</span> * (@<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">d1</span>)))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0%<span class="id">R</span>) <span class="kwd">with</span> (<span class="id">c</span> * 0)%<span class="id">R</span> <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0%<span class="id">R</span>) <span class="kwd">with</span> (<span class="id">c</span> * 0)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0%<span class="id">R</span>) <span class="kwd">with</span> (<span class="id">c</span> * 0)%<span class="id">R</span> <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0%<span class="id">R</span>) <span class="kwd">with</span> (<span class="id">c</span> * 0)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span>  (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d1</span> <span class="id">d2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorDot</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [ | <span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> =&gt; (<span class="id">rv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d2</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>) <span class="id">d2</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span>  <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d2</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> =&gt; (<span class="id">lv</span> *<span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d1</span>) <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">rv</span> * <span class="id">grad</span>) <span class="id">d2</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>) <span class="id">d2</span>) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>) <span class="id">d1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d0</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">c</span> * <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">lv</span> * <span class="id">grad</span>) <span class="id">d1</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>) <span class="id">d1</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d0</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vmap_mult">vmap_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="kwd">fun</span> <span class="id">lv</span> =&gt; (<span class="id">lv</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>) = (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; (<span class="id">c</span> * (<span class="id">x0</span> * <span class="id">grad</span>))%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vmap_mult">vmap_mult</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="kwd">fun</span> <span class="id">rv</span> =&gt; (<span class="id">rv</span> * (<span class="id">c</span> * <span class="id">grad</span>))%<span class="id">R</span>) = (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; (<span class="id">c</span> * (<span class="id">x0</span> * <span class="id">grad</span>))%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0%<span class="id">R</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i0</span> =&gt; (<span class="id">c</span> * (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0))%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> (<span class="id">c</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j0</span>) (` <span class="id">j</span>) <span class="kwd">then</span>  <span class="id">grad</span> <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0))%<span class="id">R</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)); [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x0</span>) (` <span class="id">j</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> * <span class="id">d</span> <span class="id">j</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d</span> <span class="id">j</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>) <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d</span> <span class="id">j</span>))%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> * <span class="id">d</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="id">match_case</span>; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d2</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d1</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j</span> <span class="id">i0</span>) <span class="id">grad</span>) <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d2</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d1</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d4</span> <span class="id">d0</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d3</span> <span class="id">d</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>; <span class="tactic">rewrite</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d5</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d6</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_list_env_iter">scalarMult_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">c</span> <span class="id">d5</span> <span class="id">d6</span> {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id">grad</span> <span class="id">i0</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">d1</span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [<span class="tactic">congruence</span>|].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i0</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">i</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env2</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>) <span class="id">env1</span> <span class="id">env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H15</span> <span class="id">H16</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H17</span> <span class="id">H18</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>, <span class="id">H12</span>, <span class="id">H14</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H13</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="id">now</span> <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H10</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H10</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">inversion</span> <span class="id">H10</span>; <span class="tactic">rewrite</span> <span class="id">H13</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d</span> <span class="id">j</span> <span class="id">i</span>)) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d</span> <span class="id">j</span> <span class="id">i</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d</span> <span class="id">j</span> <span class="id">i</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)  <span class="id">grad</span>) <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">p</span> <span class="id">grad</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">j0</span> <span class="id">i0</span>)) <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d</span> <span class="id">j</span> <span class="id">i</span>)) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="id">match_case</span>; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d2</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d1</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">p</span> <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j0</span> <span class="id">i0</span>) <span class="id">grad</span>) <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d2</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d1</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="kwd">fun</span> <span class="id">i</span>  =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d1</span> (<span class="kwd">fun</span> <span class="id">i</span>  =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> <span class="id">grad</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d6</span> <span class="id">d</span> <span class="id">d4</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d5</span> <span class="id">d3</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d6</span> <span class="id">d4</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">inversion</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="kwd">fun</span> <span class="id">i</span>  =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> )%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (- <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d1</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (- (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (- <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>)); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d6</span> <span class="id">d</span> <span class="id">d4</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * - <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (-( <span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span>))%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d5</span> <span class="id">d3</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d6</span> <span class="id">d4</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">inversion</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d1</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> <span class="id">grad</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d6</span> <span class="id">d</span> <span class="id">d4</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d5</span> <span class="id">d3</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d6</span> <span class="id">d4</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">inversion</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (- <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">d1</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d1</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span>  =&gt; (- (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (- <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d6</span> <span class="id">d</span> <span class="id">d4</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * - <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span>  =&gt; (-( <span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d1</span> <span class="id">d0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d2</span> <span class="id">d</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d5</span> <span class="id">d3</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d6</span> <span class="id">d4</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">inversion</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>)) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">j</span> * (<span class="id">c</span> * <span class="id">grad</span> <span class="id">j</span>))%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">rewrite</span>  <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span>  (<span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)))%<span class="id">R</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>})  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">j</span> * (<span class="id">c</span> * <span class="id">grad</span> <span class="id">j</span>))%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d0</span> * (<span class="id">c</span> * <span class="id">grad</span> <span class="id">j</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d0</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d2</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d1</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d0</span>))%<span class="id">R</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d0</span> * (<span class="id">c</span> * <span class="id">grad</span> <span class="id">j</span>))%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <span class="kwd">with</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d0</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d2</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d1</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)) <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">H2</span>, <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <span class="id">d3</span> <span class="id">d4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)))%<span class="id">R</span> <span class="kwd">with</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">tauto</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d2</span> <span class="id">d5</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d1</span> <span class="id">d6</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>))%<span class="id">R</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d3</span> <span class="id">d2</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d4</span> <span class="id">d1</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d7</span> <span class="id">d5</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d8</span> <span class="id">d6</span>)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H13</span>; <span class="tactic">inversion</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>; <span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">v0</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq0</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">v1</span> = (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * <span class="id">v0</span> <span class="id">i</span>)%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>; <span class="tactic">inversion</span> <span class="id">H5</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">eqq2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">subst</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq0</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m1</span> = (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">m0</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">x</span>); <span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">H4</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">H5</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">x0</span>); <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H6</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H7</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">inversion</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H8</span>; <span class="tactic">subst</span> <span class="id">r</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>; <span class="tactic">subst</span> <span class="id">r1</span> <span class="id">r2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">eqq1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">eqq2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H10</span>; <span class="tactic">subst</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">m0</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">m1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq0</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">v0</span> = (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">c</span> * <span class="id">v</span> <span class="id">i</span>)%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">x</span>); <span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">eqq1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">eqq2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>; <span class="tactic">inversion</span> <span class="id">H5</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">v</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [ |<span class="tactic">tauto</span>]; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span>); [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">eqq0</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m1</span> = (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">c</span> * <span class="id">m0</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">x</span>); <span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">H4</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vectoro_assert_forall_in</span> <span class="id">H5</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">x0</span>); <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">eqq1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">eqq2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H8</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">inversion</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">m0</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>; <span class="tactic">trivial</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">simpl_closed_backprop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> ?σ ?<span class="id">df1</span> ?<span class="id">grad_env1</span> ?<span class="id">grad</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>]] =&gt; <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="kwd">let</span> <span class="id">env</span> := <span class="tactic">fresh</span> "<span class="id">env</span>" <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span> <span class="tactic">intros</span> <span class="id">env</span> <span class="id">eqq</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; [<span class="tactic">clear</span> <span class="id">eqq</span> | <span class="tactic">eapply</span> <span class="id">eqq</span>]; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">simpler2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> ] =&gt; <span class="tactic">congruence</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> ] =&gt; <span class="tactic">congruence</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env</span> ?<span class="id">a</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id">context</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env</span> ?<span class="id">a</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">a</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">d</span> := <span class="tactic">fresh</span> "<span class="id">val</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">intros</span> ?; <span class="id">eelim</span> <span class="id">H</span>; <span class="id">solve</span>[<span class="tactic">auto</span>]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> ?σ ?<span class="id">df1</span> ?<span class="id">grad_env1</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id">context</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env2</span> ?<span class="id">a</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">a</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">d</span> := <span class="tactic">fresh</span> "<span class="id">val</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>; <span class="id">eelim</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span>; [<span class="tactic">apply</span> <span class="id">H</span> | <span class="id">idtac</span> | <span class="tactic">apply</span> <span class="id">eqq</span>]; <span class="id">solve</span>[<span class="tactic">auto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env</span> ?<span class="id">a</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id">context</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env</span> ?<span class="id">a</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">a</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">d</span> := <span class="tactic">fresh</span> "<span class="id">val</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">intros</span> ?; <span class="id">eelim</span> <span class="id">H</span>; <span class="id">solve</span>[<span class="tactic">auto</span> || <span class="tactic">congruence</span>]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> ?σ ?<span class="id">df1</span> ?<span class="id">grad_env1</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id">context</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env2</span> ?<span class="id">a</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">a</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">d</span> := <span class="tactic">fresh</span> "<span class="id">val</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>; <span class="id">eelim</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span>; [<span class="tactic">apply</span> <span class="id">H</span> | <span class="id">idtac</span> | <span class="tactic">apply</span> <span class="id">eqq</span>]; <span class="id">solve</span>[<span class="tactic">auto</span> || <span class="tactic">congruence</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env</span> ?<span class="id">a</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>:<span class="id">context</span> [<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env</span> ?<span class="id">a</span> <span class="kwd">with</span> | <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">a</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">d</span> := <span class="tactic">fresh</span> "<span class="id">val</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d</span>; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">intros</span> ?; <span class="id">eelim</span> <span class="id">H</span>; <span class="id">solve</span>[<span class="tactic">auto</span> || <span class="tactic">congruence</span>]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> ?σ ?<span class="id">df1</span> ?<span class="id">grad_env1</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">grad_env2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>: <span class="id">context</span> [<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> ?<span class="id">grad_env2</span> ?<span class="id">a</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] |- <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">a</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">d</span> := <span class="tactic">fresh</span> "<span class="id">val</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">d</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d</span>; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>; <span class="id">eelim</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span>; [<span class="tactic">apply</span> <span class="id">H</span> | <span class="id">idtac</span> | <span class="tactic">apply</span> <span class="id">eqq</span>]; <span class="id">solve</span>[<span class="tactic">auto</span> || <span class="tactic">congruence</span>]]<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_indep_env">backprop_indep_env</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">s</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad_env1</span> <span class="id">grad_env2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">grad_env1</span> <span class="id">grad</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">grad_env2</span> <span class="id">grad</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2345')">Proof.</div>
<div class="proofscript" id="proof2345">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_simpl">DefinedFunction_ind_simpl</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_subvar_env2">list_env_iter_subvar_env2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">d</span> <span class="id">d0</span> {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">d1</span> <span class="id">d2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> (<span class="id">grad</span> <span class="id">i</span>) <span class="id">env1</span> <span class="id">env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">eauto</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id">H2</span>, <span class="id">H3</span>, <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_subvar_env2">list_env_iter_subvar_env2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">d</span> <span class="id">d0</span> {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">d1</span> <span class="id">d2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_subvar_env2">list_env_iter_subvar_env2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">v1</span> <span class="id">v2</span> {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env1</span> <span class="id">env2</span> <span class="id">fenv1</span> <span class="id">fenv2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">i0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">env0</span> <span class="id">env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H6</span>, <span class="id">H7</span>, <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env</span> <span class="id">fenv</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env</span> <span class="id">fenv</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env2</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env1</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">v</span> == (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">invcs</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#addvar">addvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update">lookup_update</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update">lookup_update</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">v</span>&lt;&gt; (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update_neq">lookup_update_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update_neq">lookup_update_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#lookup_update_neq">lookup_update_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>,<span class="id">eqq3</span>,<span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">env</span> <span class="id">env1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">val</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val0</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id">H3</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>,<span class="id">eqq3</span>,<span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">grad</span>)%<span class="id">R</span> <span class="id">env</span> <span class="id">env1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="id">invcs</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>,<span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="id">invcs</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">val</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val0</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>, <span class="id">H3</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">d1</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq6</span>,<span class="id">eqq2</span>,<span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id">d0</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">env</span> <span class="id">env1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="id">invcs</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="id">invcs</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val0</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>, <span class="id">H5</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">grad</span>/<span class="id">d1</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq6</span>,<span class="id">eqq2</span>,<span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">d0</span>/(<span class="id">d1</span>*<span class="id">d1</span>) * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">env</span> <span class="id">env1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val0</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>, <span class="id">H5</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (2 * <span class="id">d0</span> * <span class="id">grad</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>,<span class="id">eqq2</span>,<span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">inversion</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>,<span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">inversion</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (<span class="id">grad</span>/<span class="id">d0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> (<span class="id">grad</span>/<span class="id">d0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> / <span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">inversion</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad</span> * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">inversion</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (0)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> (0)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">inversion</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (0)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> (0)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>; <span class="tactic">inversion</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H0</span>).        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d0</span> <span class="id">d1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorDot</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d1</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d1</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d3</span> <span class="id">d4</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d0</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad</span>)%<span class="id">R</span>) <span class="id">d0</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d2</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H11</span>, <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad</span> <span class="kwd">else</span> 0%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d3</span> <span class="id">d4</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d2</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H11</span>, <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span>); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">H4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>))                     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">d1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H10</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H11</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>))                     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">d2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H11</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H12</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf1</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf1</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d3</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_r">Rplus_eq_compat_r</a></span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_subvar_env2">list_env_iter_subvar_env2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">d5</span> <span class="id">d6</span>  {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) <span class="id">d1</span> <span class="id">d2</span> <span class="id">d3</span> <span class="id">d4</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad</span> <span class="id">i</span>) <span class="id">env1</span> <span class="id">env2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span>, <span class="id">H13</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>, <span class="id">H15</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H12</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H13</span>).        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H12</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H13</span>).        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d3</span> <span class="id">d4</span> <span class="id">H6</span> <span class="id">H8</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d2</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d0</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d0</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d3</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="id">d0</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d3</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d0</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad</span> <span class="id">d0</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d3</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> <span class="id">grad</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span>                                       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d3</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df1</span> <span class="id">grad_env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d3</span> <span class="id">d4</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d2</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H11</span>, <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df1</span> <span class="id">grad_env1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">neq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d3</span> <span class="id">d4</span> <span class="id">H6</span> <span class="id">H7</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d7</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d8</span> <span class="id">d2</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H11</span>, <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">v0</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">m0</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">v</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">df2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">m0</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">neq1</span> <span class="id">neq2</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_exchange_order">backprop_exchange_order</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df1</span> <span class="id">df2</span> :<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad1</span> <span class="id">grad2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df1</span> <span class="id">vl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df2</span> <span class="id">vl</span> -&gt;     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">env</span> <span class="id">grad1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> <span class="id">grad2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">oval</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">oval</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">env2</span> <span class="id">grad1</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">oval</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env1</span> <span class="id">grad2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.               <br/>
<div class="toggleproof" onclick="toggleDisplay('proof2346')">Proof.</div>
<div class="proofscript" id="proof2346">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> <span class="id">v</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">v</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d2</span> <span class="id">d1</span> <span class="id">d4</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d</span> <span class="id">d3</span> <span class="id">d1</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_indep_env">backprop_indep_env</a></span> σ <span class="id">df1</span> <span class="id">s</span> <span class="id">env</span> <span class="id">d0</span> <span class="id">grad1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_indep_env">backprop_indep_env</a></span> σ <span class="id">df2</span> <span class="id">s</span> <span class="id">env</span> <span class="id">d</span> <span class="id">grad2</span>); <span class="tactic">intros</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H6</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H7</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>,  <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">inversion</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>, <span class="id">H10</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d</span> <span class="id">grad2</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">d0</span> <span class="id">grad1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_id">list_env_iter_id</a></span> {<span class="id">A</span>} (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> (<span class="kwd">fun</span> (<span class="id">_</span> : <span class="id">A</span>) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2347')">Proof.</div>
<div class="proofscript" id="proof2347">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_grad_sum_list_env_iter">backprop_grad_sum_list_env_iter</a></span> {<span class="id">m</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vecdf</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">m</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">grad2</span> : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">val1</span> <span class="id">val2</span> <span class="id">val3</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">m</span>' | <span class="id">m</span>' &lt; <span class="id">m</span>} )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span>:{<span class="id">m</span>' | <span class="id">m</span>' &lt; <span class="id">m</span>}), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id">vecdf</span> <span class="id">i</span>) <span class="id">vl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span>:{<span class="id">m</span>' | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env1</span> <span class="id">env2</span> <span class="id">env3</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env3</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ (<span class="id">vecdf</span> <span class="id">i</span>) <span class="id">v</span> <span class="id">env3</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i</span> + <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ (<span class="id">vecdf</span> <span class="id">i</span>) <span class="id">v</span> <span class="id">env1</span> (<span class="id">grad1</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ (<span class="id">vecdf</span> <span class="id">i</span>) <span class="id">v</span> <span class="id">env2</span> (<span class="id">grad2</span> <span class="id">i</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env3</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val3</span> -&gt;     <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env3</span>) <span class="id">l</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env1</span>) <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env2</span>) <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2348')">Proof.</div>
<div class="proofscript" id="proof2348">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">val1</span> <span class="id">val2</span> <span class="id">val3</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>,<span class="id">H2</span>,<span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">grad_env3</span> (<span class="id">grad1</span> <span class="id">a</span> + <span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">grad_env3</span> (<span class="id">grad1</span> <span class="id">a</span> + <span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> <span class="id">v</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H7</span> <span class="id">v</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H9</span> <span class="id">v</span>); <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">v</span>); [<span class="tactic">intros</span> <span class="id">v3</span> <span class="id">eq3</span>  |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> <span class="id">v</span>); [<span class="tactic">intros</span> <span class="id">v1</span> <span class="id">eq1</span> |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> <span class="id">v</span>); [<span class="tactic">intros</span> <span class="id">v2</span> <span class="id">eq2</span> |<span class="tactic">tauto</span>].          <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">d0</span> <span class="id">d1</span> <span class="id">d</span> <span class="id">eq1</span> <span class="id">eq2</span> <span class="id">eq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span>) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d1</span>) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H13</span>, <span class="id">H14</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d</span> <span class="id">d2</span> <span class="id">val3</span> <span class="id">v3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d4</span> <span class="id">val1</span> <span class="id">v1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d3</span> <span class="id">val2</span> <span class="id">v2</span>); <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">a</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>,<span class="id">H2</span>,<span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>,<span class="id">H7</span>,<span class="id">H9</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d1</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_mat_grad_sum_list_env_iter">backprop_mat_grad_sum_list_env_iter</a></span> {<span class="id">m</span> <span class="id">n</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df</span> :  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">grad2</span> : (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">val1</span> <span class="id">val2</span> <span class="id">val3</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">m</span>' | <span class="id">m</span>' &lt; <span class="id">m</span>} )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span>:{<span class="id">m</span>' | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env1</span> <span class="id">env2</span> <span class="id">env3</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env3</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;     <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">env3</span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> +  <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">env1</span> (<span class="id">grad1</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">env2</span> (<span class="id">grad2</span> <span class="id">i</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env3</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val3</span> -&gt;     <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (<span class="id">grad1</span> <span class="id">j</span> <span class="id">k</span> + <span class="id">grad2</span> <span class="id">j</span> <span class="id">k</span>)%<span class="id">R</span>) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env3</span>) <span class="id">l</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env1</span>) <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="id">grad2</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env2</span>) <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2349')">Proof.</div>
<div class="proofscript" id="proof2349">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">val1</span> <span class="id">val2</span> <span class="id">val3</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>,<span class="id">H2</span>,<span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">grad1</span> <span class="id">a</span> <span class="id">k</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">k</span>)%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">grad1</span> <span class="id">a</span> <span class="id">k</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">k</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H5</span> <span class="id">v</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H7</span> <span class="id">v</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H9</span> <span class="id">v</span>); <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> <span class="id">v</span>); [<span class="tactic">intros</span> <span class="id">v3</span> <span class="id">eq3</span>  |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> <span class="id">v</span>); [<span class="tactic">intros</span> <span class="id">v1</span> <span class="id">eq1</span> |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d1</span> <span class="id">v</span>); [<span class="tactic">intros</span> <span class="id">v2</span> <span class="id">eq2</span> |<span class="tactic">tauto</span>].          <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">d0</span> <span class="id">d1</span> <span class="id">d</span> <span class="id">eq1</span> <span class="id">eq2</span> <span class="id">eq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span>) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="id">grad2</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d1</span>) <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H13</span>, <span class="id">H14</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d</span> <span class="id">d2</span> <span class="id">val3</span> <span class="id">v3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d4</span> <span class="id">val1</span> <span class="id">v1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d1</span> <span class="id">d3</span> <span class="id">val2</span> <span class="id">v2</span>); <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">a</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>,<span class="id">H2</span>,<span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>,<span class="id">H7</span>,<span class="id">H9</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="id">grad2</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d1</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span> (<span class="id">grad1</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d0</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">grad1</span> <span class="id">j</span> <span class="id">k</span> + <span class="id">grad2</span> <span class="id">j</span> <span class="id">k</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="matrix_zip_m_n">matrix_zip_m_n</a></span> {<span class="id">T</span>} {<span class="id">m</span> <span class="id">n</span>} {<span class="id">i</span> <span class="id">j</span>} {<span class="id">m1</span> <span class="id">m2</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id">T</span> <span class="id">m</span> <span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">i</span> <span class="id">j</span> = (<span class="id">m1</span> <span class="id">i</span> <span class="id">j</span>, <span class="id">m2</span> <span class="id">i</span> <span class="id">j</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2350')">Proof.</div>
<div class="proofscript" id="proof2350">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="backprop_grad_sum">backprop_grad_sum</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">grad2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env3</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env3</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> <span class="id">grad1</span> <span class="id">grad2</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env1</span> <span class="id">grad1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env2</span> <span class="id">grad2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2351')">Proof.</div>
<div class="proofscript" id="proof2351">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">induction</span> <span class="id">T</span>, <span class="id">df</span> <span class="kwd">using</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit">DefinedFunction_ind_unit</a></span>) <span class="id">Case</span><br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DefinedFunction_cases&nbsp;(induction&nbsp;T,&nbsp;df&nbsp;using&nbsp;DefinedFunction_ind_simpl)&nbsp;Case<br/>
*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env3</span> (<span class="id">grad1</span> <span class="id">a</span> + <span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env3</span> (<span class="id">grad1</span> <span class="id">a</span> + <span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">i</span> + <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H3</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H3</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d4</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H3</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H7</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H8</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H9</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].          <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d5</span> <span class="id">d</span> <span class="id">d8</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d6</span> <span class="id">d0</span> <span class="id">d9</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d7</span> <span class="id">d1</span> <span class="id">d10</span>); <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">d3</span> <span class="id">d4</span> <span class="id">d2</span> <span class="id">H14</span> <span class="id">H15</span> <span class="id">H13</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>, <span class="id">H17</span>, <span class="id">H18</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq3</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H20</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">a</span> (<span class="id">grad1</span> <span class="id">a</span>) (<span class="id">grad2</span> <span class="id">a</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id">H3</span> <span class="id">a</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>,<span class="id">eqq0</span>,<span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>, <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>); <span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_id">list_env_iter_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_id">list_env_iter_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_id">list_env_iter_id</a></span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env3</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">a0</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">a0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">a0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span> <span class="id">a0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env3</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">a0</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">a0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env1</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">a0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env2</span> (<span class="id">grad2</span> <span class="id">a</span> <span class="id">a0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span>) <span class="id">l0</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span>) <span class="id">l0</span> ); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d3</span>) <span class="id">l0</span> ); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">a</span> <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d4</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d4</span>) <span class="id">l0</span> ); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">a0</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">i</span> <span class="id">a0</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">a0</span>)%<span class="id">R</span>) <span class="id">l0</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d5</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a1</span> <span class="id">a0</span>) <span class="id">env0</span> (<span class="id">grad1</span> <span class="id">a1</span> <span class="id">a0</span> + <span class="id">grad2</span> <span class="id">a1</span> <span class="id">a0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a1</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a1</span> <span class="id">a0</span>) <span class="id">env0</span> (<span class="id">grad1</span> <span class="id">a1</span> <span class="id">a0</span> + <span class="id">grad2</span> <span class="id">a1</span> <span class="id">a0</span>)%<span class="id">R</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a1</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">a0</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">i</span> <span class="id">a0</span>)%<span class="id">R</span>) <span class="id">l0</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d6</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a1</span> <span class="id">a0</span>) <span class="id">env0</span> (<span class="id">grad1</span> <span class="id">a1</span> <span class="id">a0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a1</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a1</span> <span class="id">a0</span>) <span class="id">env0</span> (<span class="id">grad1</span> <span class="id">a1</span> <span class="id">a0</span>)%<span class="id">R</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a1</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">a0</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">i</span> <span class="id">a0</span>)%<span class="id">R</span>) <span class="id">l0</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d7</span>) <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a1</span> <span class="id">a0</span>) <span class="id">env0</span> (<span class="id">grad2</span> <span class="id">a1</span> <span class="id">a0</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a1</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a1</span> <span class="id">a0</span>) <span class="id">env0</span> (<span class="id">grad2</span> <span class="id">a1</span> <span class="id">a0</span>)%<span class="id">R</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a1</span>); <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">apply</span> <span class="id">H3</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H7</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H8</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H9</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hc</span> := <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H3c</span> := <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">a</span> <span class="id">a0</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">a0</span>) (<span class="id">grad2</span> <span class="id">a</span> <span class="id">a0</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id">H3</span> <span class="id">a0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>, <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> (<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> <span class="id">d2</span> <span class="id">d5</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H25</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H26</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d5</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> (<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> <span class="id">d3</span> <span class="id">d6</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H27</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H28</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d7</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> (<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span> <span class="id">j</span>) <span class="id">env</span> (<span class="id">grad2</span> <span class="id">a</span> <span class="id">j</span>)%<span class="id">R</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l0</span> <span class="id">d4</span> <span class="id">d7</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H29</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H30</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d7</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">d6</span> <span class="id">d7</span> <span class="id">d5</span> <span class="id">H27</span> <span class="id">H29</span> <span class="id">H25</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H28</span>, <span class="id">H30</span>, <span class="id">H26</span> <span class="kwd">in</span> <span class="id">IHl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>,<span class="id">eqq3</span>,<span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d5</span> <span class="id">d8</span> <span class="id">d</span> <span class="id">d14</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d6</span> <span class="id">d9</span> <span class="id">d0</span> <span class="id">d15</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d7</span> <span class="id">d10</span> <span class="id">d1</span> <span class="id">d16</span>); <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d5</span> <span class="id">d</span> <span class="id">d11</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d3</span> <span class="id">d6</span> <span class="id">d0</span> <span class="id">d12</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d7</span> <span class="id">d1</span> <span class="id">d13</span>); <span class="tactic">trivial</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H32</span>, <span class="id">H33</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_grad_sum_list_env_iter">backprop_grad_sum_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">s</span> <span class="id">d3</span> <span class="id">d4</span> <span class="id">d2</span> (<span class="id">grad1</span> <span class="id">a</span>) (<span class="id">grad2</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d12</span> <span class="id">d13</span> <span class="id">d11</span> <span class="id">l0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H31</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H11</span>,<span class="id">H13</span>,<span class="id">H15</span> <span class="kwd">in</span> <span class="id">H31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H35</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hc</span> <span class="id">a</span> <span class="id">i</span> (<span class="id">grad1</span> <span class="id">a</span> <span class="id">i</span>) (<span class="id">grad2</span> <span class="id">a</span> <span class="id">i</span>) <span class="id">env1</span> <span class="id">env2</span> <span class="id">env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hc</span> <span class="id">H34</span> <span class="id">H35</span> <span class="id">H36</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hc</span> (<span class="id">H3</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">trivial</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>| <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>| <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">v</span> == (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">invcs</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span>, <span class="id">H4</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">v</span>&lt;&gt; (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">match_option</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">H4</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env2</span> <span class="id">v</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>, <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">match_option</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H4</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">match_option</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">H3</span>, <span class="id">H4</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span>, <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val1</span> <span class="id">val4</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H6</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">grad1</span>)%<span class="id">R</span> (-<span class="id">grad2</span>)%<span class="id">R</span> <span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span>, <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (- <span class="id">grad1</span> + - <span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">with</span> (- (<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val1</span> <span class="id">val4</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H6</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">d1</span> * <span class="id">grad1</span>)%<span class="id">R</span> (<span class="id">d1</span> * <span class="id">grad2</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="id">d0</span> * <span class="id">grad1</span>)%<span class="id">R</span> (<span class="id">d0</span> * <span class="id">grad2</span>)%<span class="id">R</span> <span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq8</span>, <span class="id">eqq9</span>, <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">d1</span> *<span class="id">grad1</span> + <span class="id">d1</span>*<span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">d1</span> * (<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf1</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">d0</span> *<span class="id">grad1</span> + <span class="id">d0</span> *<span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">d0</span> *(<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>,<span class="id">eqq5</span>,<span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> (<span class="id">grad1</span>/<span class="id">d1</span>)%<span class="id">R</span> (<span class="id">grad2</span>/<span class="id">d1</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (-<span class="id">d0</span>/(<span class="id">d1</span>*<span class="id">d1</span>) * <span class="id">grad1</span>)%<span class="id">R</span> (-<span class="id">d0</span>/(<span class="id">d1</span>*<span class="id">d1</span>) * <span class="id">grad2</span>)%<span class="id">R</span> <span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq8</span>, <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad1</span>/<span class="id">d1</span> + <span class="id">grad2</span>/<span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">with</span> ((<span class="id">grad1</span> + <span class="id">grad2</span>)/<span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf1</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (-<span class="id">d0</span>/(<span class="id">d1</span>*<span class="id">d1</span>) *<span class="id">grad1</span> + -<span class="id">d0</span>/(<span class="id">d1</span>*<span class="id">d1</span>) *<span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">with</span> (-<span class="id">d0</span>/(<span class="id">d1</span>*<span class="id">d1</span>) *(<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq5</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (2 * <span class="id">d0</span> *<span class="id">grad1</span>)%<span class="id">R</span> (2 * <span class="id">d0</span> *<span class="id">grad2</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">d0</span> * <span class="id">grad1</span> + 2 * <span class="id">d0</span> * <span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">with</span> (2 * <span class="id">d0</span> * (<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad1</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d0</span>)%<span class="id">R</span> (<span class="id">grad2</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad1</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d0</span> + <span class="id">grad2</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="kwd">with</span> ((<span class="id">grad1</span> + <span class="id">grad2</span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad1</span>/<span class="id">d0</span>)%<span class="id">R</span> (<span class="id">grad2</span>/<span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad1</span>/<span class="id">d0</span> + <span class="id">grad2</span>/<span class="id">d0</span>)%<span class="id">R</span> <span class="kwd">with</span> ((<span class="id">grad1</span> + <span class="id">grad2</span>) / <span class="id">d0</span>)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id">grad1</span>*<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> (<span class="id">grad2</span>*<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad1</span>*<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span> + <span class="id">grad2</span>*<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="kwd">with</span> ((<span class="id">grad1</span> + <span class="id">grad2</span>) * <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d0</span>)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> (0)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0 + 0)%<span class="id">R</span> <span class="kwd">with</span> 0%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (0)%<span class="id">R</span> (0)%<span class="id">R</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0 + 0)%<span class="id">R</span> <span class="kwd">with</span> 0%<span class="id">R</span> <span class="kwd">in</span> <span class="id">IHdf</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d0</span> <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq2</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorDot</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad1</span>)%<span class="id">R</span>) <span class="id">d1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * <span class="id">grad2</span>)%<span class="id">R</span>) <span class="id">d1</span>)                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad1</span>)%<span class="id">R</span>) <span class="id">d0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * <span class="id">grad2</span>)%<span class="id">R</span>) <span class="id">d0</span>)                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq8</span>, <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">rv</span> * <span class="id">grad1</span>) <span class="id">d1</span> <span class="id">i</span> + <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">rv</span> * <span class="id">grad2</span>) <span class="id">d1</span> <span class="id">i</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * (<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span>) <span class="id">d1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">lv</span> * <span class="id">grad1</span>) <span class="id">d0</span> <span class="id">i</span> + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">lv</span> * <span class="id">grad2</span>) <span class="id">d0</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">lv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">lv</span> * (<span class="id">grad1</span> + <span class="id">grad2</span>))%<span class="id">R</span>) <span class="id">d0</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq5</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad1</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> <span class="id">grad2</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad1</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad2</span>) <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span> (<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad1</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad2</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> (<span class="id">grad1</span> + <span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad1</span> <span class="kwd">else</span> 0) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <span class="id">grad2</span> <span class="kwd">else</span> 0))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad1</span> <span class="kwd">else</span> 0%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad2</span> <span class="kwd">else</span> 0%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> (<span class="id">grad1</span> + <span class="id">grad2</span>)%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0%<span class="id">R</span>) <span class="kwd">with</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j0</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad1</span> <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j0</span>) (` <span class="id">j</span>) <span class="kwd">then</span> <span class="id">grad2</span> <span class="kwd">else</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x0</span>) (` <span class="id">j</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">grad1</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id">grad2</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq8</span>, <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>) <span class="id">grad2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">grad1</span> <span class="id">i</span> + <span class="id">grad2</span> <span class="id">i</span>) * <span class="id">d1</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j</span> <span class="id">i0</span>) <span class="id">grad1</span> <span class="id">i</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j</span> <span class="id">i0</span>) <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt; (<span class="id">grad1</span> <span class="id">i</span> + <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq5</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>,<span class="id">eqq0</span>,<span class="id">eqq1</span>,<span class="id">eqq2</span>,<span class="id">eqq3</span>,<span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_mat_grad_sum_list_env_iter">backprop_mat_grad_sum_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">s</span> <span class="id">env0</span> <span class="id">env1</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad1</span>) (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">d0</span> <span class="id">d1</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H10</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">do</span> 3 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt; ((@<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad1</span> <span class="id">j</span> <span class="id">k</span>) + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">grad2</span> <span class="id">j</span> <span class="id">k</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i0</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i0</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">i</span>)) <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>; <span class="tactic">inversion</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">d2</span> <span class="id">val</span> <span class="id">d1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env0</span> <span class="id">d3</span> <span class="id">val0</span> <span class="id">d</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">d4</span> <span class="id">val1</span> <span class="id">d0</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span>, <span class="id">H13</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad2</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env1</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad1</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env0</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">grad1</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env0</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i0</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i0</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="id">i</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq8</span>, <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> <span class="id">j0</span> <span class="id">i0</span>) <span class="id">i</span> <span class="id">j</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> <span class="id">grad2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> <span class="id">j0</span> <span class="id">i0</span>) <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt; <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span>)) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span>, <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j0</span> <span class="id">i0</span>) <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) (<span class="id">j0</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j0</span> <span class="id">i0</span>) <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <span class="id">d0</span> <span class="id">j</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d</span> <span class="id">val1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val</span> <span class="id">val2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val0</span> <span class="id">val3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>, <span class="id">H8</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq3</span>, <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">val</span> <span class="id">val5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val0</span> <span class="id">val6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val1</span> <span class="id">val7</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">eqq8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">eqq9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">eqq10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq8</span>; <span class="id">invcs</span> <span class="id">eqq9</span>; <span class="id">invcs</span> <span class="id">eqq10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H6</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad1</span> <span class="id">i</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env1</span> <span class="id">env3</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- <span class="id">grad1</span> <span class="id">i</span> + - <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (- (<span class="id">grad1</span> <span class="id">i</span> + <span class="id">grad2</span> <span class="id">i</span>))%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">val</span> <span class="id">val5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env1</span> <span class="id">env2</span> <span class="id">val0</span> <span class="id">val6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env3</span> <span class="id">env4</span> <span class="id">val1</span> <span class="id">val7</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">eqq8</span>; <span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">eqq9</span>; <span class="tactic">rewrite</span> <span class="id">eqq7</span> <span class="kwd">in</span> <span class="id">eqq10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq8</span>; <span class="id">invcs</span> <span class="id">eqq9</span>; <span class="id">invcs</span> <span class="id">eqq10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>, <span class="id">H6</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df1</span> <span class="id">grad_env3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="id">grad1</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> (<span class="id">grad2</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H7</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> (<span class="id">grad1</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span> (<span class="id">grad1</span>)%<span class="id">R</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="id">grad2</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span> (<span class="id">grad2</span>)%<span class="id">R</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq8</span>, <span class="id">H13</span>, <span class="id">H15</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d8</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d9</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d10</span> <span class="id">d3</span> <span class="id">d7</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span>, <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df1</span> <span class="id">grad_env3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> (<span class="id">grad1</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span> (<span class="id">grad2</span>)%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span> <span class="id">grad1</span> <span class="id">grad2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq2</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H7</span> <span class="id">H9</span> <span class="id">H10</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(- (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (- <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(- <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + - <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(- (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq8</span>, <span class="id">H13</span>, <span class="id">H15</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d8</span> <span class="id">d</span> <span class="id">d5</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d9</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d10</span> <span class="id">d3</span> <span class="id">d7</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span>, <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.                  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * (<span class="id">grad1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">j</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad1</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad1</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad1</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d4</span> <span class="id">d6</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq3</span>, <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">d1</span> <span class="id">j</span> * <span class="id">grad1</span> <span class="id">j</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">d1</span> <span class="id">j</span> * <span class="id">grad2</span> <span class="id">j</span>))%<span class="id">R</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d1</span> <span class="id">j</span> * (<span class="id">grad1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">j</span>))%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H11</span> <span class="id">H12</span> <span class="id">H9</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * (<span class="id">grad1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">j</span>))%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad1</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad1</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d6</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d6</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad2</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * <span class="id">grad1</span> <span class="id">i</span> + <span class="id">d0</span> * <span class="id">grad2</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d0</span> * (<span class="id">grad1</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">j</span>))%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq10</span>, <span class="id">H15</span>, <span class="id">H17</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d10</span> <span class="id">d</span> <span class="id">d7</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d11</span> <span class="id">d3</span> <span class="id">d8</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d6</span> <span class="id">d12</span> <span class="id">d5</span> <span class="id">d9</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>, <span class="id">H19</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df1</span> <span class="id">grad_env3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df1</span> <span class="id">grad_env2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d4</span> <span class="id">d6</span> <span class="id">d2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq3</span>, <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>))%<span class="id">R</span>)) <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">eqq2</span>, <span class="id">eqq4</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq4</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq6</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">H11</span> <span class="id">H12</span> <span class="id">H9</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">IHdf2</span>; [|<span class="tactic">tauto</span>].                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">d0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d6</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">d6</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt; (<span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">grad1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">grad2</span> <span class="id">i</span> <span class="id">j</span>) * <span class="id">d0</span>)%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq10</span>, <span class="id">H15</span>, <span class="id">H17</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d10</span> <span class="id">d</span> <span class="id">d7</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d11</span> <span class="id">d3</span> <span class="id">d8</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d6</span> <span class="id">d12</span> <span class="id">d5</span> <span class="id">d9</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>, <span class="id">H19</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq3</span>);<span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq4</span>);<span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq5</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>, <span class="id">eqq7</span>, <span class="id">eqq8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">v1</span> <span class="id">i</span> + <span class="id">v2</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span> <span class="id">v0</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>);<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">x</span>);<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">x</span>);<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H5</span>; <span class="id">invcs</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H6</span>; <span class="id">invcs</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>; <span class="id">invcs</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">eqq10</span>; <span class="id">invcs</span> <span class="id">eqq10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">eqq11</span>; <span class="id">invcs</span> <span class="id">eqq11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq5</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>)] (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq4</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>)] (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq3</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>)] (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq3</span>);<span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq4</span>);<span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq5</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span>, <span class="id">eqq7</span>, <span class="id">eqq8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">m2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span> <span class="id">m0</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>); <span class="id">specialize</span> (<span class="id">H6</span> <span class="id">x</span>); <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H5</span>);<span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H6</span>);<span class="tactic">intros</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H7</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">x0</span>); <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">x0</span>); <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">x0</span>); <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>  <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">H10</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H8</span>; <span class="id">invcs</span> <span class="id">H9</span>; <span class="id">invcs</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq5</span>); <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>)] (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq4</span>); <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>)] (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq3</span>); <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>)] (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq3</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq4</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq5</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">v0</span> <span class="id">v3</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq7</span>, <span class="id">eqq8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">v0</span> <span class="id">i</span> + <span class="id">v3</span> <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span> <span class="id">v</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>);<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">x</span>);<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">x</span>);<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H5</span>; <span class="id">invcs</span> <span class="id">H6</span>; <span class="id">invcs</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq5</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq4</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq3</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>); <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">df2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq3</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq4</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq5</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHdf2</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">grad_env1</span> <span class="id">grad_env2</span> <span class="id">grad_env3</span>).               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">IHdf2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span>, <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq7</span>, <span class="id">eqq8</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m1</span> <span class="id">i</span> <span class="id">j</span> + <span class="id">m2</span> <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>) <span class="kwd">with</span> <span class="id">m0</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHdf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H5</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H6</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H7</span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">x0</span>); <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">x0</span>); <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">x0</span>); <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">H10</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">rewrite</span> <span class="id">eqq9</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H8</span>; <span class="id">invcs</span> <span class="id">H9</span>; <span class="id">invcs</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq5</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span> <span class="id">x0</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq4</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span> <span class="id">x0</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq3</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span> <span class="id">x0</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df1</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vectoro_to_ovector_eNone_None">vectoro_to_ovector_eNone_None</a></span> {<span class="id">A</span> <span class="id">n</span>} {<span class="id">vo</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span>) <span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">i</span> | <span class="id">vo</span> <span class="id">i</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>} -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector">vectoro_to_ovector</a></span> <span class="id">vo</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2352')">Proof.</div>
<div class="proofscript" id="proof2352">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_None_None">vectoro_to_ovector_None_None</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ConstSplitVector">ConstSplitVector</a></span> {<span class="id">T</span>} (<span class="id">middle</span> <span class="id">theend</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)  (<span class="id">part1</span> <span class="id">part2</span>:<span class="id">T</span>)  : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">theend</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">i</span>: {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">theend</span>}%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) <span class="id">middle</span> <span class="kwd">then</span> <span class="id">part1</span> <span class="kwd">else</span> <span class="id">part2</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mergeVectorZero">mergeVectorZero</a></span> {<span class="id">T</span>} {<span class="id">n</span>} (<span class="id">middle</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">part1</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) (<span class="id">c</span>:<span class="id">T</span>) : (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">i</span>: {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) <span class="id">middle</span> <span class="kwd">then</span> (<span class="id">part1</span> <span class="id">i</span>) <span class="kwd">else</span> <span class="id">c</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scaleUnitVector">scaleUnitVector</a></span> {<span class="id">T</span>} (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">j</span> : {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>}) (<span class="id">c</span>:<span class="id">T</span>) (<span class="id">zero</span>:<span class="id">T</span>) : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">T</span> <span class="id">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">i</span>) == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">j</span>) <span class="kwd">then</span> <span class="id">c</span> <span class="kwd">else</span> <span class="id">zero</span>%<span class="id">R</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="ConstSplitVectorSzero">ConstSplitVectorSzero</a></span> <span class="id">bound</span> <span class="id">n</span> (<span class="id">pf</span>:<span class="id">bound</span> &lt; <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#ConstSplitVector">ConstSplitVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">n</span> 1%<span class="id">R</span> 0%<span class="id">R</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#ConstSplitVector">ConstSplitVector</a></span> <span class="id">bound</span> <span class="id">n</span> 1%<span class="id">R</span> 0%<span class="id">R</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound</span> <span class="id">pf</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2353')">Proof.</div>
<div class="proofscript" id="proof2353">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#ConstSplitVector">ConstSplitVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nat_eq_eqdec">nat_eq_eqdec</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">pff</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">bound</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">x</span> <span class="id">bound</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">lia</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mergeVectorSzero">mergeVectorSzero</a></span> {<span class="id">n</span>} (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">pf</span>:<span class="id">bound</span> &lt; <span class="id">n</span>) (<span class="id">part1</span> : <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ind</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound</span> <span class="id">pf</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> (@<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">part1</span> 0%<span class="id">R</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> (@<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id">n</span> <span class="id">bound</span> <span class="id">part1</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">ind</span> (<span class="id">part1</span> <span class="id">ind</span>) 0%<span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2354')">Proof.</div>
<div class="proofscript" id="proof2354">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nat_eq_eqdec">nat_eq_eqdec</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">pff</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">bound</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">x</span> <span class="id">bound</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">lia</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mergeVectorSzero_mat">mergeVectorSzero_mat</a></span> {<span class="id">n</span> <span class="id">m</span>} (<span class="id">bound</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">pf</span> (<span class="id">part1</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ind</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">bound</span> <span class="id">pf</span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>) <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">part1</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>) <span class="id">n</span> <span class="id">bound</span> <span class="id">part1</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>) <span class="id">n</span> <span class="id">ind</span> (<span class="id">part1</span> <span class="id">ind</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2355')">Proof.</div>
<div class="proofscript" id="proof2355">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nat_eq_eqdec">nat_eq_eqdec</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">pff</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">bound</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">x</span> <span class="id">bound</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">lia</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_alt_eq">vsum_alt_eq</a></span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span> = <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fplus">Fplus</a></span> 0%<span class="id">R</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2356')">Proof.</div>
<div class="proofscript" id="proof2356">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right1_as_vector_fold_right">vector_fold_right1_as_vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">Datatypes.id</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_cons">vsum_cons</a></span> {<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} <span class="id">x</span> (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vcons">vcons</a></span> <span class="id">x</span> <span class="id">v</span>) = (<span class="id">x</span> + <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2357')">Proof.</div>
<div class="proofscript" id="proof2357">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_alt_eq">vsum_alt_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_vcons">vector_fold_right_vcons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="constSplitVectorZero">constSplitVectorZero</a></span> {<span class="id">n</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#ConstSplitVector">ConstSplitVector</a></span> 0 <span class="id">n</span> 1%<span class="id">R</span> 0%<span class="id">R</span> = <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2358')">Proof.</div>
<div class="proofscript" id="proof2358">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#ConstSplitVector">ConstSplitVector</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_partvec_bounded">df_eval_backprop_delta_by_unit_partvec_bounded</a></span> {<span class="id">n</span>} <span class="id">bound</span> (<span class="id">pf</span>:(<span class="id">bound</span>&lt;=<span class="id">n</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> (<span class="id">grad</span> <span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>):<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> (<span class="id">grad</span> <span class="id">i</span>) 0%<span class="id">R</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">d</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">bound</span> <span class="id">grad</span> 0%<span class="id">R</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">d</span> <span class="id">bound</span> <span class="id">pf</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2359')">Proof.</div>
<div class="proofscript" id="proof2359">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">closed</span> <span class="id">lo</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> 0 <span class="id">grad</span> 0%<span class="id">R</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) 0%<span class="id">R</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> 0 <span class="id">grad</span> 0%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">pf2</span>:<span class="id">bound</span> &lt; <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pf3</span>:<span class="id">bound</span> &lt;= <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorSzero">mergeVectorSzero</a></span> <span class="id">_</span> <span class="id">pf2</span> <span class="id">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_grad_sum">backprop_grad_sum</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbound</span> <span class="id">pf3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; [<span class="id">lia</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> <span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)); <span class="tactic">intros</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_vdrop_last">vfirstn_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast_vfirstn">vlast_vfirstn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_cons">vsum_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_partvec">df_eval_backprop_delta_by_unit_partvec</a></span> {<span class="id">n</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> (<span class="id">grad</span> <span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>):<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> (<span class="id">grad</span> <span class="id">i</span>) 0%<span class="id">R</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">d</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span> <span class="id">grad</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">d</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2360')">Proof.</div>
<div class="proofscript" id="proof2360">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">n</span> <span class="id">grad</span> 0%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partvec_bounded">df_eval_backprop_delta_by_unit_partvec_bounded</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_eq">vfirstn_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>; <span class="tactic">intros</span> [<span class="id">x</span> <span class="id">pff</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">n</span>); <span class="tactic">trivial</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_parts">df_eval_backprop_delta_by_unit_parts</a></span> {<span class="id">n</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>):<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">d</span> <span class="id">i</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 1%<span class="id">R</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">d</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2361')">Proof.</div>
<div class="proofscript" id="proof2361">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 1%<span class="id">R</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">n</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 1%<span class="id">R</span>) 0%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partvec_bounded">df_eval_backprop_delta_by_unit_partvec_bounded</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_eq">vfirstn_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>; <span class="tactic">intros</span> [<span class="id">x</span> <span class="id">pff</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">n</span>); <span class="tactic">trivial</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scalarMult_mult">scalarMult_mult</a></span> {<span class="id">T</span>} <span class="id">a</span> <span class="id">b</span> <span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> <span class="id">a</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> <span class="id">b</span> <span class="id">grad</span>) = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> (<span class="id">a</span>*<span class="id">b</span>)%<span class="id">R</span> <span class="id">grad</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2362')">Proof.</div>
<div class="proofscript" id="proof2362">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">T</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="tactic">intros</span> ?; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span>; <span class="tactic">intros</span> ?); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span> {<span class="id">Ann</span>} {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id">Ann</span> <span class="id">T</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">grad_env</span> :<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2363')">Proof.</div>
<div class="proofscript" id="proof2363">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;allows&nbsp;us&nbsp;to&nbsp;drop&nbsp;the&nbsp;(unneeded)&nbsp;assumption<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;df_eval_backprop_deriv&nbsp;σ&nbsp;df&nbsp;grad_env1&nbsp;grad&nbsp;&lt;&gt;&nbsp;None<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>)); <span class="tactic">simpl</span>; [| <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_mult">scalarMult_mult</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_mult">scalarMult_mult</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="scaleUnitVec_vec_plus_distr">scaleUnitVec_vec_plus_distr</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>) <span class="id">c</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vec_eq">vec_eq</a></span> <span class="id">c</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">c</span> <span class="id">c</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>) <span class="id">x</span> <span class="id">y</span>) <span class="id">c</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#dfti_gen_plus">dfti_gen_plus</a></span> (<span class="id">T</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> <span class="id">x</span> <span class="id">c</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> <span class="id">y</span> <span class="id">c</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2364')">Proof.</div>
<div class="proofscript" id="proof2364">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intro</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">fa</span> <span class="id">x1</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_partmat_outer_bounded">df_eval_backprop_delta_by_unit_partmat_outer_bounded</a></span> {<span class="id">n</span> <span class="id">m</span>} <span class="id">bound</span> (<span class="id">pf</span>:(<span class="id">bound</span>&lt;=<span class="id">n</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> (<span class="id">grad</span> <span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> (<span class="id">grad</span> <span class="id">i</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="id">d</span> <span class="id">i</span>))) -&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">bound</span> <span class="id">grad</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">d</span>) <span class="id">bound</span> <span class="id">pf</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2365')">Proof.</div>
<div class="proofscript" id="proof2365">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">closed</span> <span class="id">lo</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn0">vfirstn0</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_nil">vsum_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> 0 <span class="id">grad</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) 0%<span class="id">R</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> 0 <span class="id">grad</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">pf2</span>:<span class="id">bound</span> &lt; <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pf3</span>:<span class="id">bound</span> &lt;= <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorSzero_mat">mergeVectorSzero_mat</a></span> (<span class="id">m</span>:=<span class="id">m</span>) <span class="id">_</span> <span class="id">pf2</span> <span class="id">grad</span> ); <span class="tactic">intros</span> <span class="id">HH</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">float</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HH</span>; <span class="tactic">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_grad_sum">backprop_grad_sum</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbound</span> <span class="id">pf3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">d</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)); <span class="tactic">intros</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_vdrop_last">vfirstn_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast_vfirstn">vlast_vfirstn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_cons">vsum_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_partmat_inner_bounded">df_eval_backprop_delta_by_unit_partmat_inner_bounded</a></span> {<span class="id">n</span> <span class="id">m</span>} <span class="id">bound</span> (<span class="id">pf</span>:(<span class="id">bound</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> (<span class="id">grad</span> <span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">i</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">m</span> <span class="id">j</span> (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>) 0%<span class="id">R</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span>)) -&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">bound</span> (<span class="id">grad</span> <span class="id">i</span>) 0%<span class="id">R</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> (<span class="id">d</span> <span class="id">i</span>) <span class="id">bound</span> <span class="id">pf</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2366')">Proof.</div>
<div class="proofscript" id="proof2366">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">closed</span> <span class="id">lo</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn0">vfirstn0</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_nil">vsum_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> <span class="id">n</span> <span class="id">i</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> 0 (<span class="id">grad</span> <span class="id">i</span>) 0%<span class="id">R</span>) (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) 0%<span class="id">R</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> 0 <span class="id">grad</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">pf2</span>:<span class="id">bound</span> &lt; <span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pf3</span>:<span class="id">bound</span> &lt;= <span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorSzero">mergeVectorSzero</a></span> <span class="id">_</span> <span class="id">pf2</span> (<span class="id">grad</span> <span class="id">i</span>) ); <span class="tactic">intros</span> <span class="id">HH</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">float</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HH</span>; <span class="tactic">clear</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVec_vec_plus_distr">scaleUnitVec_vec_plus_distr</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span>) <span class="tactic">by</span> (<span class="tactic">intros</span> ?; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>; <span class="tactic">simpl</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_grad_sum">backprop_grad_sum</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbound</span> <span class="id">pf3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHbound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_Sn_split">vector_Sn_split</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vfirstn">vfirstn</a></span> (<span class="id">d</span> <span class="id">i</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">bound</span>) <span class="id">pf</span>)); <span class="tactic">intros</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vec_eq_eq">vec_eq_eq</a></span> <span class="kwd">in</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_vdrop_last">vfirstn_vdrop_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vlast_vfirstn">vlast_vfirstn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_cons">vsum_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_partmat">df_eval_backprop_delta_by_unit_partmat</a></span> {<span class="id">n</span> <span class="id">m</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grad</span> <span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id">grad</span> <span class="id">i</span> <span class="id">j</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">j</span>))) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span> <span class="id">grad</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">d</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2367')">Proof.</div>
<div class="proofscript" id="proof2367">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">closed</span> <span class="id">lo</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">n</span> <span class="id">grad</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat_outer_bounded">df_eval_backprop_delta_by_unit_partmat_outer_bounded</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_eq">vfirstn_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">fa</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">grad</span> <span class="id">i</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span> <span class="id">m</span> (<span class="id">grad</span> <span class="id">i</span>) 0%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>; <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat_inner_bounded">df_eval_backprop_delta_by_unit_partmat_inner_bounded</a></span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_refl">le_refl</a></span> <span class="id">m</span>) σ <span class="id">df</span> <span class="id">s</span> <span class="id">grad_env</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vfirstn_eq">vfirstn_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">fa</span> <span class="id">j</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_destr</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mergeVectorZero">mergeVectorZero</a></span>; <span class="tactic">intros</span> [<span class="id">x</span> <span class="id">pff</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">n</span>); <span class="tactic">trivial</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="df_eval_backprop_delta_by_unit_parts_mat">df_eval_backprop_delta_by_unit_parts_mat</a></span> {<span class="id">n</span> <span class="id">m</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span> <span class="id">m</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">df</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>})  (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">j</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">df</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">n</span> <span class="id">m</span> 1%<span class="id">R</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">d</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2368')">Proof.</div>
<div class="proofscript" id="proof2368">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat">df_eval_backprop_delta_by_unit_partmat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env2</span> := <span class="id">grad_env</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="scalarMult_backprop_list_env_iter_grad0">scalarMult_backprop_list_env_iter_grad0</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">grad_env</span> :<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id">T</span>) <span class="id">old</span> <span class="id">n</span> <span class="id">x</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id">x</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> : {<span class="id">v</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#var_type">var_type</a></span> &amp; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">v</span>)} =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> (<span class="id">Ann</span>:=<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span>) σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>) <span class="id">l</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2369')">Proof.</div>
<div class="proofscript" id="proof2369">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env</span> <span class="id">old</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">grad_env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id">T</span> 0%<span class="id">R</span> <span class="id">grad</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span> σ (<span class="id">x</span> <span class="id">a</span>) <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">eqq0</span>; <span class="id">invcs</span> <span class="id">eqq0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eelim</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_gen_delta0">list_env_iter_gen_delta0</a></span> {<span class="id">n</span>}  (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">init_env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">init_env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span> :  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> <span class="id">i</span> <span class="id">env</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">f</span> <span class="id">i</span> <span class="id">env</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xenv</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">xenv</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> ) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">i</span> <span class="id">l</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>  (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">val</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val</span>) (<span class="id">f</span> <span class="id">i</span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0%<span class="id">R</span>)) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">old</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">init_env</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">init_env</span> <span class="id">v</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2370')">Proof.</div>
<div class="proofscript" id="proof2370">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">init_env</span> <span class="id">H</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H0c</span> := <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">a</span> <span class="id">init_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">init_env</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">init_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0c</span> <span class="id">i</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0c</span>; <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H6</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">init_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>, <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_gen_delta">list_env_iter_gen_delta</a></span> {<span class="id">n</span>}  (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">init_env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">old</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">i0</span> :  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">init_env</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span> :  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> <span class="id">i</span> <span class="id">env</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">f</span> <span class="id">i</span> <span class="id">env</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xenv</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">xenv</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> ) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">env2</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> <span class="id">v</span>, <span class="id">f</span> <span class="id">i</span> <span class="id">env</span>, <span class="id">f</span> <span class="id">i</span> <span class="id">env2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xenv</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">xenv2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">xenv</span> <span class="id">val1</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">xenv2</span> <span class="id">val2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id">i</span> &lt;&gt; <span class="id">i0</span> -&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>  (<span class="kwd">fun</span> <span class="id">e</span> <span class="id">val</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">val</span>) (<span class="id">f</span> <span class="id">i</span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0%<span class="id">R</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) (<span class="id">f</span> <span class="id">i0</span> <span class="id">init_env</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span> <span class="id">f</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">init_env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2371')">Proof.</div>
<div class="proofscript" id="proof2371">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq_break_at">bounded_seq_break_at</a></span> 0 <span class="id">n</span> <span class="id">i0</span>) <span class="kwd">as</span> [<span class="id">b</span> [<span class="id">c</span> [<span class="id">eqq1</span> [<span class="id">fa1</span> <span class="id">fa2</span>]]]]; [<span class="id">lia</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_app">list_env_iter_app</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eqq</span>': <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">d</span> <span class="id">old</span> = 0%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_gen_delta0">list_env_iter_gen_delta0</a></span> <span class="id">s</span> <span class="id">init_env</span> <span class="id">f</span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H4</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">fa1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">fa1</span> <span class="id">i</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">eq1</span>; <span class="tactic">rewrite</span> <span class="id">eq1</span> <span class="kwd">in</span> <span class="id">fa1</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">b</span>); <span class="tactic">intros</span> <span class="id">vart</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id">vart</span> <span class="id">init_env</span> <span class="id">d</span> <span class="id">eqq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">vartinit</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">init_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">vart</span> <span class="id">vartinit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">i0</span> <span class="id">d</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">i0</span> <span class="id">d</span>); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_gen_delta0">list_env_iter_gen_delta0</a></span> <span class="id">s</span> <span class="id">d0</span> <span class="id">f</span> <span class="id">c</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d1</span> <span class="id">old</span> <span class="id">d2</span>);<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d</span> <span class="id">d0</span> <span class="id">old</span> <span class="id">d4</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i0</span> <span class="id">init_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H6</span>; <span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H4</span>, <span class="id">eqq3</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="id">cut_to</span> <span class="id">vart</span>; [<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i0</span> <span class="id">init_env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span> <span class="id">f</span> <span class="id">d0</span> <span class="id">c</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H4</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">cut_to</span> <span class="id">vart</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i0</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>;<span class="tactic">destruct</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">i</span> &lt;&gt; <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">fa2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">fa2</span> <span class="id">i</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">eq1</span>; <span class="tactic">rewrite</span> <span class="id">eq1</span> <span class="kwd">in</span> <span class="id">fa2</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span> <span class="id">f</span> <span class="id">init_env</span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_vec_delta">list_env_iter_vec_delta</a></span> {<span class="id">n</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i0</span> :  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">old</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">j</span>: {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id">x</span> <span class="id">j</span>) <span class="id">vl</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i0</span>) <span class="id">grad_env</span> 1%<span class="id">R</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i0</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2372')">Proof.</div>
<div class="proofscript" id="proof2372">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_gen_delta">list_env_iter_gen_delta</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">grad_env</span> <span class="id">old</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i0</span> <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i0</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="kwd">with</span> (<span class="id">xv</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">in</span> <span class="id">eqq</span>;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_indep_env">backprop_indep_env</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">s</span> <span class="id">env</span> <span class="id">env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i0</span> <span class="id">i</span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>,<span class="id">eqq0</span>,<span class="id">eqq1</span>,<span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) (` <span class="id">i0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">s</span> <span class="id">env</span> 0%<span class="id">R</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0 * 0)%<span class="id">R</span> <span class="kwd">with</span> 0%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H3</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i0</span> <span class="id">i</span>) <span class="kwd">with</span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#Fzero">Fzero</a></span> <span class="kwd">in</span> <span class="id">eqq</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) (` <span class="id">i0</span>)); [|<span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.                      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i0</span> <span class="id">i</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_backprop_indep_env_vec">list_env_iter_backprop_indep_env_vec</a></span> {<span class="id">m</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vecdf</span>: <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">m</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">env</span> <span class="id">env2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">grad</span>: <span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">old1</span> <span class="id">old2</span>: <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env2</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old2</span> -&gt;     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">vl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">e</span> <span class="id">old1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">e</span> <span class="id">old2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env2</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2373')">Proof.</div>
<div class="proofscript" id="proof2373">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">old1</span> <span class="id">old2</span> <span class="id">env</span> <span class="id">env2</span> <span class="id">H</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">a</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">env2</span> (<span class="id">grad</span> <span class="id">a</span>)); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d0</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">d1</span> <span class="id">d2</span> <span class="id">d</span> <span class="id">d0</span> <span class="id">H4</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d</span> <span class="id">d3</span> <span class="id">old1</span> <span class="id">d1</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d0</span> <span class="id">d4</span> <span class="id">old2</span> <span class="id">d2</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_indep_env">backprop_indep_env</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env</span> <span class="id">env2</span> (<span class="id">grad</span> <span class="id">a</span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H6</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>, <span class="id">H2</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H6</span>; [<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id">grad</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H6</span>; [<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="kwd">with</span> (<span class="id">xv</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">in</span> <span class="id">H3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">trivial</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="kwd">with</span> (<span class="id">xv</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">in</span> <span class="id">H2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">trivial</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">env2</span> (<span class="id">grad</span> <span class="id">a</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">vecdf</span> <span class="id">a</span>) <span class="id">env</span> (<span class="id">grad</span> <span class="id">a</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_mat_delta">list_env_iter_mat_delta</a></span> {<span class="id">n</span> <span class="id">m</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">n</span> <span class="id">m</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i0</span> :  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j0</span> :  {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">old</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">i</span>: {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span>: {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">vl</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i0</span> <span class="id">j0</span>) <span class="id">grad_env</span> 1%<span class="id">R</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="id">v</span> <span class="id">e</span> <span class="id">old</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>) (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2374')">Proof.</div>
<div class="proofscript" id="proof2374">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_gen_delta">list_env_iter_gen_delta</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">grad_env</span> <span class="id">old</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span> <span class="id">j</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)) <span class="id">i0</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_gen_delta">list_env_iter_gen_delta</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">grad_env</span> <span class="id">old</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i0</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i0</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">j0</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i0</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j0</span>) (` <span class="id">j0</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="kwd">with</span> (<span class="id">xv</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">in</span> <span class="id">eqq</span>;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_indep_env">backprop_indep_env</a></span> σ (<span class="id">x</span> <span class="id">i0</span> <span class="id">i</span>) <span class="id">s</span> <span class="id">env</span> <span class="id">env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i0</span> <span class="id">i</span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>,<span class="id">eqq0</span>,<span class="id">eqq1</span>,<span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i0</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) (` <span class="id">j0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e0</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span> σ (<span class="id">x</span> <span class="id">i0</span> <span class="id">i</span>) <span class="id">s</span> <span class="id">env</span> 0%<span class="id">R</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0 * 0)%<span class="id">R</span> <span class="kwd">with</span> 0%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H3</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>, <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i0</span> <span class="id">i</span>) <span class="id">env</span> 0%<span class="id">R</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup_list_env_iter">vartlookup_list_env_iter</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> (<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>) <span class="id">env</span> <span class="id">d</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="kwd">with</span> (<span class="id">xv</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_backprop_indep_env_vec">list_env_iter_backprop_indep_env_vec</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">s</span> <span class="id">env</span> <span class="id">env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">d0</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">eqq</span> <span class="id">eqq0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> (<span class="id">H0</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span> <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span> 0%<span class="id">R</span> 0%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_list_env_iter_grad0">scalarMult_backprop_list_env_iter_grad0</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) (` <span class="id">i0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_env_iter_matvec_delta">list_env_iter_matvec_delta</a></span> {<span class="id">m</span> <span class="id">n</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">df2</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">m</span>)) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i0</span> :  {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j0</span> :  {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">old</span> : <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span>) :      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">old</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df2</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">e</span> <span class="id">old</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">grad_env</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> <span class="id">j0</span>)) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (<span class="kwd">fun</span> <span class="id">e</span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">e</span> <span class="id">old</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span>) <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad_env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2375')">Proof.</div>
<div class="proofscript" id="proof2375">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_gen_delta">list_env_iter_gen_delta</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span> <span class="id">grad_env</span> <span class="id">old</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">df2</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span>) <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i0</span>) (` <span class="id">i0</span>)); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="kwd">with</span> (<span class="id">xv</span> := (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="kwd">in</span> <span class="id">eqq</span>;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_indep_env">backprop_indep_env</a></span> σ <span class="id">df2</span> <span class="id">s</span> <span class="id">env</span> <span class="id">env2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i0</span> <span class="id">j0</span> <span class="id">i</span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>,<span class="id">eqq0</span>,<span class="id">eqq1</span>,<span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">inversion</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) (` <span class="id">i0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift2">lift2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad0">scalarMult_backprop_grad0</a></span> σ <span class="id">df2</span> <span class="id">s</span> <span class="id">env</span> (<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0%<span class="id">R</span>)); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt; (0 * <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">m</span> 0 <span class="id">i</span>)%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt; 0%<span class="id">R</span>) <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">df2</span> <span class="id">env</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0%<span class="id">R</span>) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vmap_eta">vmap_eta</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">n</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> <span class="id">f</span> <span class="id">d</span> = <span class="id"><a href="FormalML.utils.Vector.html#vmap">vmap</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span>) <span class="id">d</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2376')">Proof.</div>
<div class="proofscript" id="proof2376">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_ext">vmap_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_eta">vsum_eta</a></span> {<span class="id">n</span>} (<span class="id">d</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">d</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">d</span> <span class="id">i</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2377')">Proof.</div>
<div class="proofscript" id="proof2377">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_unitvector">msum_unitvector</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">x</span> <span class="id">d1</span> <span class="id">d0</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> <span class="id">x</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">x</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2378')">Proof.</div>
<div class="proofscript" id="proof2378">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt; (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> <span class="id">x</span> <span class="id">i</span> * <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> <span class="id">x</span> <span class="id">i</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) =&gt; <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>))%<span class="id">R</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt; <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>) * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> <span class="id">x</span> <span class="id">i</span>)%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> ?; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vsum_as_sum">vsum_as_sum</a></span> {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">n</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id">v</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R0">R0</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2379')">Proof.</div>
<div class="proofscript" id="proof2379">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_alt_eq">vsum_alt_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right">vector_fold_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_0">vector_fold_right_dep_0</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_dep_Sn">vector_fold_right_dep_Sn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_as_sum">msum_as_sum</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span>:<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R0">R0</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list">matrix_to_list</a></span> <span class="id">mat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2380')">Proof.</div>
<div class="proofscript" id="proof2380">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list">matrix_to_list</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list_list">matrix_to_list_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R0">R0</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> (<span class="id">mat</span> <span class="id">i</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_ext">vsum_ext</a></span>; <span class="tactic">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_as_sum">vsum_as_sum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_as_sum">vsum_as_sum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#fold_right_plus_concat">fold_right_plus_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#map_vector_to_list_vmap">map_vector_to_list_vmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vector_to_list_ext">vector_to_list_ext</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="transpose_perm_bounded">transpose_perm_bounded</a></span> {<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">bound_m</span> <span class="id">pf_m</span> <span class="id">bound_n</span> <span class="id">pf_n</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">Datatypes.cons</a></span>) []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">Datatypes.cons</a></span>) [] (<span class="id">mat</span> <span class="id">i</span>) <span class="id">bound_n</span> <span class="id">pf_n</span>) <span class="id">bound_m</span> <span class="id">pf_m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">Datatypes.cons</a></span>) []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#vector_fold_right_bounded_dep">vector_fold_right_bounded_dep</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">Datatypes.cons</a></span>) [] (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">mat</span> <span class="id">i</span>) <span class="id">bound_m</span> <span class="id">pf_m</span>) <span class="id">bound_n</span> <span class="id">pf_n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2381')">Proof.</div>
<div class="proofscript" id="proof2381">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#Permutation">Permutation</a></span> : <span class="id">fml</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">bound_n</span> <span class="id">pf_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound_m</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">bound_n</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHbound_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">IHbound_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound_n</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">IHbound_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">IHbound_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_cons">Permutation_cons</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_ass">app_ass</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app">Permutation_app</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="transpose_perm">transpose_perm</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list">matrix_to_list</a></span> <span class="id">mat</span>) (<span class="id"><a href="FormalML.utils.Vector.html#matrix_to_list">matrix_to_list</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">mat</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2382')">Proof.</div>
<div class="proofscript" id="proof2382">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#transpose_perm_bounded">transpose_perm_bounded</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="msum_transpose">msum_transpose</a></span> {<span class="id">m</span> <span class="id">n</span>} (<span class="id">mat</span> : <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id">m</span> <span class="id">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id">mat</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">mat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2383')">Proof.</div>
<div class="proofscript" id="proof2383">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_as_sum">msum_as_sum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#fold_right_perm">fold_right_perm</a></span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#transpose_perm">transpose_perm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">match_nested_case</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span>[<span class="kwd">match</span> <span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">match_nested_case_in</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">context</span>[<span class="kwd">match</span> <span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">eqq</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="df_eval_deriv_genvar_same">df_eval_deriv_genvar_same</a></span> (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function">is_scalar_function</a></span> <span class="id">df</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">forward</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> σ <span class="id">df</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#transpose_lifted_type">transpose_lifted_type</a></span> <span class="id">forward</span> = <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">df</span> (<span class="id">v</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2384')">Proof.</div>
<div class="proofscript" id="proof2384">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pattern</span> <span class="id">df</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">df</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_scalar_cases</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#is_scalar_function_ind">is_scalar_function_ind</a></span>) <span class="id">Case</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(  <span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">e</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span>; <span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">match_nested_case</span>; [|<span class="tactic">tauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="id">now</span> <span class="id">match_nested_case</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">refl_simpler</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option_in</span> <span class="id">H0</span>.                       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option_in</span> <span class="id">H0</span>.                       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>; [<span class="tactic">trivial</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">e</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>; [<span class="tactic">trivial</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">e</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">is_scalar</span>; <span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#pos_sign">pos_sign</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d</span> <span class="id">d0</span>); <span class="tactic">intros</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_dec">Rge_dec</a></span> (<span class="id">d0</span> - <span class="id">d</span>) 0); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_dec">Rge_dec</a></span> (<span class="id">d0</span> - <span class="id">d</span>) 0); <span class="id">lra</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="yay">yay</a></span> {<span class="id">T</span>} (σ:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">df</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">T</span>) (<span class="id">hs</span>:<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#has_scalar_functions">has_scalar_functions</a></span> <span class="id">df</span>) (<span class="id">s</span>: <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#SubVar">SubVar</a></span>) <span class="id">grad_env</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> <span class="id">v</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ve</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">ve</span>) σ <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_over">fully_closed_over</a></span> <span class="id">df</span> <span class="id">vl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">forward</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">backward</span> := <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top">df_eval_backward_gen_top</a></span> σ <span class="id">df</span> <span class="id">v</span> <span class="id">grad_env</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#transpose_lifted_type">transpose_lifted_type</a></span> <span class="id">forward</span> = <span class="id">backward</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2385')">Proof.</div>
<div class="proofscript" id="proof2385">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">vin</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top">df_eval_backward_gen_top</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">pattern</span> <span class="id">T</span>, <span class="id">df</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">T</span> <span class="id">df</span> <span class="id">hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">DefinedFunction_cases</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DefinedFunction_ind_unit_has_scalar_functions">DefinedFunction_ind_unit_has_scalar_functions</a></span>) <span class="id">Case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Number</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Constant</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_destr</span>; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_destr</span>; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_destr</span>; [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DVector</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_vector_env_iter_alt">two_vector_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">closedb</span> := <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">closed</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vin</span> <span class="id">closed</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ (<span class="id">x</span> <span class="id">i</span>) <span class="id">env</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x0</span> <span class="kwd">then</span> 1%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_vec_delta">list_env_iter_vec_delta</a></span> σ <span class="id">x</span> <span class="id">s</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l</span>) <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H0</span> <span class="id">closedb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">closedb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ (<span class="id">x</span> <span class="id">x0</span>) [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H1</span> (<span class="id">closed</span> <span class="id">x0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">DMatrix</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H1</span>); <span class="tactic">intros</span>.           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">i0</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#two_matrix_env_iter_alt">two_matrix_env_iter_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span> <span class="id">i0</span> <span class="id">grad_env</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">closedb</span> := <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">closed</span> <span class="id">i</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">closed</span> <span class="id">i0</span>).           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vin</span> <span class="id">closed</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) (<span class="id">env0</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ (<span class="id">x</span> <span class="id">i</span> <span class="id">j</span>) <span class="id">env0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x1</span> <span class="id">l0</span>) <span class="id">i</span> <span class="id">j</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_mat_delta">list_env_iter_mat_delta</a></span> σ <span class="id">x</span> <span class="id">s</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x1</span> <span class="id">l0</span>) <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">closedb</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closedb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">closedb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">closedb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closedb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">closedb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">eqq</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ (<span class="id">x</span> <span class="id">x0</span> <span class="id">x1</span>) [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">closed</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vforall_forall">vforall_forall</a></span> <span class="kwd">in</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H1</span> (<span class="id">closed</span> <span class="id">x1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Var</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_eqdec">vart_eqdec</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vart_dec">vart_dec</a></span> <span class="id">v</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">refl_simpler</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_eq">subvar_addvar_scalar_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s0</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>; <span class="tactic">simpl</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s0</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s0</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar_addvar_scalar_neq">subvar_addvar_scalar_neq</a></span>.             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">f_equal</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Plus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))| <span class="tactic">apply</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_option_in</span> <span class="id">H0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">elim</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">vin</span> <span class="id">eqq3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq2</span> | <span class="tactic">intros</span> <span class="id">eqq2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Minus</span>"%<span class="id">string</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">r</span> <span class="id">d1</span> (- (1))%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">r</span> <span class="id">s</span> <span class="id">d1</span> <span class="id">d1</span> 1%<span class="id">R</span> (-1)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (-1 * 1)%<span class="id">R</span> <span class="kwd">with</span> (- (1))%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H0</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span>, <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">simpl</span>; <span class="tactic">replace</span> (-1 * 1)%<span class="id">R</span> <span class="kwd">with</span> (- (1))%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">H</span> (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d1</span> (- (1))%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq4</span> (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span>  <span class="id">eqq5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d1</span> (1%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Times</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">r</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> <span class="id">d1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> (<span class="id">d1</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>); <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H7</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d3</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H2</span>).           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">r</span> <span class="id">s</span> <span class="id">d2</span> <span class="id">d3</span> 1%<span class="id">R</span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">H12</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>, <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d2</span> (<span class="id">d</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H14</span> <span class="id">H2</span>); <span class="id">specialize</span> (<span class="id">H11</span> <span class="id">H14</span> <span class="id">H9</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H11</span>; [|<span class="tactic">congruence</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d7</span> <span class="id">d0</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; <span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">invcs</span> <span class="id">H11</span>; <span class="id">invcs</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Divide</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">r</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (1 / <span class="id">d1</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> (1 / <span class="id">d1</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>) ; <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H7</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 / <span class="id">d1</span> * 1)%<span class="id">R</span> <span class="kwd">with</span> (1/<span class="id">d1</span>)%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H7</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d3</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H2</span>).           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">r</span> <span class="id">s</span> <span class="id">d2</span> <span class="id">d3</span> 1%<span class="id">R</span> (- <span class="id">d</span> / (<span class="id">d1</span> * <span class="id">d1</span>))%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">H12</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>, <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d2</span> (- <span class="id">d</span> / (<span class="id">d1</span> * <span class="id">d1</span>) * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H14</span> <span class="id">H2</span>); <span class="id">specialize</span> (<span class="id">H11</span> <span class="id">H14</span> <span class="id">H9</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H11</span>; [|<span class="tactic">congruence</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d7</span> <span class="id">d0</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>; <span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">invcs</span> <span class="id">H11</span>; <span class="id">invcs</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Square</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">e</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (2 * <span class="id">d</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> (2 * <span class="id">d</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>); <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">match_option_in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Exp</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">e</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>); <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">d</span> * 1)%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">match_option_in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Log</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">e</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (1 / <span class="id">d</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> (1 / <span class="id">d</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>); <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 / <span class="id">d</span>)%<span class="id">R</span> <span class="kwd">with</span> (1 /  <span class="id">d</span> * 1)%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">match_option_in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Abs</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">e</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id">d</span> * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>); <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 * (@<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">d</span>))%<span class="id">R</span> <span class="kwd">with</span> ((@<span class="id"><a href="FormalML.utils.Floatish.FloatishOps.html#sign">sign</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">d</span>) * 1)%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">match_option_in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Sign</span>"%<span class="id">string</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">e</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (0)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> (0 * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">closed</span>); <span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0)%<span class="id">R</span> <span class="kwd">with</span> (0 * 1)%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">match_option_in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">PSign</span>"%<span class="id">string</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">e</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (0)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> (0 * 1)%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">closed</span>); <span class="id">specialize</span> (<span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0)%<span class="id">R</span> <span class="kwd">with</span> (0 * 1)%<span class="id">R</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">match_option_in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">e</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">Max</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H2</span>).        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">r</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H0</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">d</span> <span class="id">d1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorDot</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">r</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">rv</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">rv</span> * 1)%<span class="id">R</span>) <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#id">id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_id">vmap_id</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_id">vmap_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d1</span> <span class="id">eqq1</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> <span class="id">d0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> σ <span class="id">r</span> <span class="id">d4</span> <span class="id">d</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d4</span> <span class="id">H10</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d4</span> <span class="id">d5</span> <span class="id">d1</span> <span class="id">d6</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partvec">df_eval_backprop_delta_by_unit_partvec</a></span> σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">d0</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">d2</span> <span class="id">i</span> * <span class="id">d0</span> <span class="id">i</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">H1</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partvec">df_eval_backprop_delta_by_unit_partvec</a></span> σ <span class="id">r</span> <span class="id">s</span> <span class="id">d4</span> <span class="id">d</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">d</span> <span class="id">i</span> * <span class="id">d3</span> <span class="id">i</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">H2</span> <span class="id">H10</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H12</span>; <span class="id">invcs</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>, <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> (@<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id">n</span> <span class="id">i</span> (<span class="id">d</span> <span class="id">i</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id">d</span> <span class="id">i</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env1</span> := <span class="id">d4</span>) (<span class="id">grad_env2</span>:=<span class="id">d4</span>);<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> (@<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id">n</span> <span class="id">i</span> (<span class="id">d0</span> <span class="id">i</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id">d0</span> <span class="id">i</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env1</span> := <span class="id">grad_env</span>) (<span class="id">grad_env2</span>:=<span class="id">grad_env</span>);<span class="tactic">trivial</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#id">id</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span> <span class="id">HH</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">e</span> <span class="id">d0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">v</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 1%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">v</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id">n</span> 1%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_parts">df_eval_backprop_delta_by_unit_parts</a></span> <span class="kwd">with</span> (<span class="id">d1</span> := <span class="id">d</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HH</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">v</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">v</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">x</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixSum</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span> <span class="id">HH</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">e</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span> =&gt; <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#subvar">subvar</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">e</span> <span class="id">d0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">v</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 1%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> σ <span class="id">v</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> <span class="id">m</span> <span class="id">n</span> 1%<span class="id">R</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_parts_mat">df_eval_backprop_delta_by_unit_parts_mat</a></span> <span class="kwd">with</span> (<span class="id">d1</span> := <span class="id">d</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HH</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">HH</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">j</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span> <span class="id">m</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">i</span> <span class="id">j</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">v</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">v</span> <span class="id">m</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span> <span class="id">x0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">x</span> <span class="id">x0</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) (` <span class="id">i</span>) <span class="kwd">then</span> 1%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">x</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixElem</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">k1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k2</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k1</span>) (` <span class="id">i</span>) <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k2</span>) (` <span class="id">j</span>) <span class="kwd">then</span> 1%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span> <span class="kwd">else</span> 0%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">i</span> <span class="id">j</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">invcs</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">closed</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">l</span> <span class="id">m</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span> <span class="id">x0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">x</span> <span class="id">x0</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">closed</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">r</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d3</span> <span class="id">val</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H9</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d2</span> <span class="id">j</span> + <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d2</span> <span class="id">j</span>)%<span class="id">R</span>)) + (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>)))%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>; <span class="tactic">f_equal</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_vector_mult">matrix_vector_mult</a></span> <span class="kwd">in</span> <span class="id">eqq3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">j</span> <span class="id">i</span> * (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">j</span>)%<span class="id">R</span>)%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>)) <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partvec">df_eval_backprop_delta_by_unit_partvec</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">s</span> <span class="id">env</span> (<span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span> ))  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; ((<span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span> ) <span class="id">i</span>) * (<span class="id">d2</span> <span class="id">i</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H12</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_l">Rplus_eq_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat">df_eval_backprop_delta_by_unit_partmat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0) * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0) * (<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span>) * (<span class="id">d0</span> <span class="id">j</span>))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H12</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0) * <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>)  <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x</span> <span class="id">l0</span>) <span class="id">i</span> * <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_unitvector">msum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env2</span>:=<span class="id">grad_env</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H13</span>); <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H15</span> <span class="id">j</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> (@<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id">n</span> <span class="id">i</span> (<span class="id">d</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">n</span>' <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">i</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">i</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env1</span> := <span class="id">env</span>) (<span class="id">grad_env2</span>:=<span class="id">env</span>);<span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>,<span class="id">eqq5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">invcs</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x0</span>) (` <span class="id">i</span>)); <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixVectorAdd</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H3</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d2</span> <span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>;  <span class="tactic">simpl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_total_fun">list_env_iter_total_fun</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)) <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d2</span> (<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter">list_env_iter</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)) <span class="id">i</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#bounded_seq0">bounded_seq0</a></span> <span class="id">n</span>)); [<span class="tactic">intros</span> |<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d5</span> <span class="id">d0</span> <span class="id">d3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#list_env_iter_matvec_delta">list_env_iter_matvec_delta</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">s</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">eqq3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">i</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) (<span class="id">env</span> : <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_env">df_env</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">m</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)) <span class="id">i</span>)) <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H4</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">r</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">r</span>); [<span class="tactic">intros</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl_closed_backprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">env</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpler2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">env</span> <span class="id">env0</span> <span class="id">d3</span> <span class="id">val</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H9</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">p</span> (<span class="kwd">fun</span> <span class="id">j</span>  =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d2</span> <span class="id">j</span> <span class="id">i0</span> + <span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span> <span class="id">i0</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> ((<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d2</span> <span class="id">j</span> <span class="id">i0</span>)%<span class="id">R</span>)) + (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> (<span class="kwd">fun</span> <span class="id">j</span> =&gt; (<span class="id">d1</span> <span class="id">i</span> <span class="id">j</span> * <span class="id">d0</span> <span class="id">j</span> <span class="id">i0</span>)%<span class="id">R</span>)))%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_plus">vsum_plus</a></span>; <span class="tactic">f_equal</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="kwd">in</span> <span class="id">eqq3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_mult">matrix_mult</a></span>,<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat">df_eval_backprop_delta_by_unit_partmat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <span class="kwd">else</span> 0) * <span class="id">d0</span> <span class="id">k</span> <span class="id">j</span>)%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <span class="kwd">else</span> 0) * <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> <span class="id">i</span> <span class="id">k</span>) * <span class="id">d0</span> <span class="id">k</span> <span class="id">j</span>)%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">H1</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H12</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>  (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>}) (<span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">m</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">i</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <span class="kwd">else</span> 0) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">d1</span> <span class="id">i</span> <span class="id">k</span> * <span class="id">d0</span> <span class="id">k</span> <span class="id">j</span>))%<span class="id">R</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | (<span class="id">n</span>' &lt; <span class="id">p</span>)%<span class="id">nat</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">j</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">j</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x0</span> <span class="id">l1</span>))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_transpose">msum_transpose</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) (<span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j0</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0) * <span class="id">d1</span> <span class="id">j</span> <span class="id">i</span> * <span class="id">d0</span> <span class="id">i</span> <span class="id">j0</span>)%<span class="id">R</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">p</span>}) (<span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x</span> <span class="id">l0</span>) <span class="id">i</span> * <span class="id">d0</span> <span class="id">i</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x0</span> <span class="id">l1</span>))%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span>  (<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">x1</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">x1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x0</span> <span class="id">l1</span>))%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> 0%<span class="id">R</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">d1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">x1</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d0</span> <span class="id">x1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">m</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x0</span> <span class="id">l1</span>))%<span class="id">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x</span> <span class="id">l0</span>) <span class="id">j</span>))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x2</span>) <span class="id">x</span>); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ( <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x2</span>) <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j0</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0) * <span class="id">d1</span> <span class="id">x2</span> <span class="id">x1</span> * <span class="id">d0</span> <span class="id">x1</span> <span class="id">j0</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">d1</span> <span class="id">x2</span> <span class="id">x1</span> * <span class="id">d0</span> <span class="id">x1</span> <span class="id">j0</span>) * (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x0</span> <span class="id">l1</span>) <span class="id">j0</span>))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x3</span>) <span class="id">x0</span>); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_r">Rplus_eq_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat">df_eval_backprop_delta_by_unit_partmat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">s</span> <span class="id">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) (<span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">j</span> <span class="id">i</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <span class="kwd">else</span> 0))%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">p</span>}) (<span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">j</span> <span class="id">i</span> * <span class="id">d2</span> <span class="id">i</span> <span class="id">k</span> * <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <span class="kwd">else</span> 0))%<span class="id">R</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H13</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">j</span> <span class="id">x1</span> * <span class="id">d2</span> <span class="id">x1</span> <span class="id">k</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">j</span>) <span class="id">x</span> <span class="kwd">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">k</span>) <span class="id">x0</span> <span class="kwd">then</span> 1 <span class="kwd">else</span> 0 <span class="kwd">else</span> 0))%<span class="id">R</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">j</span> <span class="id">x1</span> * <span class="id">d2</span> <span class="id">x1</span> <span class="id">k</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x</span> <span class="id">l0</span>) <span class="id">j</span>))%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x0</span> <span class="id">l1</span>) <span class="id">k</span>))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x2</span>) <span class="id">x0</span>); <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x3</span>) <span class="id">x</span>); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env2</span>:=<span class="id">env</span>); <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H11</span>); <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H15</span> <span class="id">j</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env2</span>:=<span class="id">grad_env</span>); <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span> <span class="id">i</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H13</span> <span class="id">j</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_mult">vsum_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d2</span> <span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">d2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>;  <span class="id">specialize</span> (<span class="id">H6</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">inversion</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span> <span class="id">d3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">x</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d2</span> <span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">d2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>;  <span class="id">specialize</span> (<span class="id">H6</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">s</span> <span class="id">d2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(-1)%<span class="id">R</span> ); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H4</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (-1)%<span class="id">R</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>;  <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H8</span> <span class="id">H6</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(- (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>)) <span class="id">i</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(-1 * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>) <span class="id">i</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span> <span class="id">d3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">x</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixPlus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H3</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d2</span> <span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H6</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>;  <span class="tactic">simpl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x0</span> <span class="id">l1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>;  <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">inversion</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span> <span class="id">d3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> <span class="id">n</span> <span class="id">m</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x0</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">x</span> <span class="id">x0</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixMinus</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">match_option_in</span> <span class="id">H</span>; [|<span class="tactic">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H3</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d2</span> <span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H6</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>;  <span class="tactic">simpl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x0</span> <span class="id">l1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>;  <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H2</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">s</span> <span class="id">d2</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span>  <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x0</span> <span class="id">l1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(-1)%<span class="id">R</span> ); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H5</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">r</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (-1)%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x0</span> <span class="id">l1</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>;  <span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H10</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x0</span> <span class="id">l1</span>)) <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(-1 *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">n</span>)%<span class="id">nat</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">n</span>' &lt; <span class="id">m</span>)%<span class="id">nat</span>) <span class="id">x0</span> <span class="id">l1</span>) <span class="id">i</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d4</span> <span class="id">d0</span> <span class="id">d3</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span> σ <span class="id">r</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>]); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> <span class="id">n</span> <span class="id">m</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x0</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">x</span> <span class="id">x0</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">x</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum">vsum</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">n</span>' <span class="id">n</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span> (<span class="id">d1</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>) <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">i</span>) <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">d1</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">x</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (<span class="id">d1</span> <span class="id">i</span>)); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">x</span> <span class="id">grad_env</span> (<span class="id">d1</span> <span class="id">i</span> * 1)%<span class="id">R</span> ); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>); <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H7</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">d1</span> <span class="id">i</span>) <span class="kwd">with</span> (<span class="id">d1</span> <span class="id">i</span> * 1)%<span class="id">R</span>  <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">l</span> <span class="id">s</span> <span class="id">d2</span> <span class="id">d3</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>) <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H11</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>, <span class="id">H12</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span> <span class="id">i0</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.                                   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H14</span> <span class="id">H2</span>); <span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H14</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">d3</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H15</span> <span class="id">H2</span>); <span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H15</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>; [|<span class="tactic">congruence</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">j</span> : @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">n</span>' <span class="id">n</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">n</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>) <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>)) <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">i</span>) <span class="id">j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i0</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>} =&gt; (<span class="id">d</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span> <span class="id">i0</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d7</span> <span class="id">d0</span> <span class="id">d6</span>); <span class="tactic">trivial</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>; <span class="tactic">inversion</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H7</span>; <span class="id">invcs</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">eqq5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vsum_unitvector">vsum_unitvector</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">H7</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_2">df_eval_backward_gen_top_obligation_2</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">l</span> <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">x0</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">x</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixScalMult</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d0</span> <span class="id">eqq0</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> σ <span class="id">l</span>); [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">x</span> <span class="id">grad_env</span> 1%<span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i1</span> : @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">n</span>' <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">m</span>' <span class="id">m</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span> (<span class="id">d1</span> <span class="id">i1</span> <span class="id">j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>) <span class="id">n</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) <span class="id">i</span> <span class="id">i0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">i1</span> <span class="id">j</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">d1</span> <span class="id">i</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">x</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span> 1%<span class="id">R</span> (<span class="id">d1</span> <span class="id">i</span> <span class="id">i0</span>)); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">vin</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq0</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">x</span> <span class="id">grad_env</span> (<span class="id">d1</span> <span class="id">i</span> <span class="id">i0</span> * 1)%<span class="id">R</span> ); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">H1</span>); <span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H7</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">d1</span> <span class="id">i</span> <span class="id">i0</span>) <span class="kwd">with</span> (<span class="id">d1</span> <span class="id">i</span> <span class="id">i0</span> * 1)%<span class="id">R</span>  <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> σ <span class="id">l</span> <span class="id">s</span> <span class="id">d2</span> <span class="id">d3</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d2</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H11</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>, <span class="id">H12</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H13</span>); <span class="tactic">intros</span>.           <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H14</span> <span class="id">i0</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">d2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i1</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">m</span>}) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">i0</span> <span class="id">i1</span> <span class="id">j</span>)%<span class="id">R</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H15</span> <span class="id">H2</span>); <span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H15</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">d3</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">i0</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H16</span> <span class="id">H2</span>); <span class="id">specialize</span> (<span class="id">H10</span> <span class="id">H16</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>; [|<span class="tactic">congruence</span>]; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">i1</span> : @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">n</span>' <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="kwd">fun</span> <span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">m</span>' <span class="id">m</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span> <span class="id">m</span>) (<span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">n</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#MatrixScalMult">MatrixScalMult</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">ann</span> <span class="id">x</span> <span class="id">l</span>) <span class="id">n</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#definition_function_types">definition_function_types</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>)) <span class="id">i</span> <span class="id">i0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">i0</span>) <span class="id">i1</span> <span class="id">j</span>) <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i1</span> <span class="id">j</span> =&gt; (<span class="id">d</span> * <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">i</span> <span class="id">i0</span> <span class="id">i1</span> <span class="id">j</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#split_subvar">split_subvar</a></span> <span class="id">d2</span> <span class="id">d7</span> <span class="id">d0</span> <span class="id">d6</span>); <span class="tactic">trivial</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>; <span class="tactic">inversion</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H18</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H7</span>; <span class="id">invcs</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">eqq5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_unitmatrix">msum_unitmatrix</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">d3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv_preserves_lookup_not_none">df_eval_backprop_deriv_preserves_lookup_not_none</a></span> <span class="id">eqq1</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">H7</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">d3</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> | <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="id">e</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">d3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.BasicUtils.html#coerce">coerce</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backward_gen_top_obligation_3">df_eval_backward_gen_top_obligation_3</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitAnn">UnitAnn</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">n</span> <span class="id">m</span>) <span class="id">l</span> <span class="id">n</span> <span class="id">m</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">x0</span> <span class="id">x1</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">n</span> <span class="id">m</span> <span class="id">x0</span> <span class="id">x1</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">x</span> <span class="id">grad_env</span> 1%<span class="id">R</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VectorApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (0%<span class="id">R</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d1</span> <span class="id">eqq1</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> <span class="id">v1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H10c</span> := <span class="id">H10</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">x</span> <span class="id">l0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">x</span>); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H8</span>; <span class="tactic">rewrite</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">v1</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10c</span> <span class="id">x0</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10c</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H10c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span> <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq6</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">replace</span> (1 * <span class="id">d4</span>)%<span class="id">R</span> <span class="kwd">with</span> <span class="id">d4</span> <span class="kwd">in</span> <span class="id">H10</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>)) <span class="id">d4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">cut_to</span> <span class="id">H11</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="kwd">in</span> <span class="id">eqq3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H11</span>; <span class="tactic">rewrite</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H7</span>; <span class="tactic">rewrite</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar_same">df_eval_deriv_genvar_same</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x</span> <span class="id">l0</span>) )]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s0</span> <span class="id">v</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">H</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> <span class="id">H7</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="kwd">in</span> <span class="id">eqq4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>, <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H7</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">destruct</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x0</span>)] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s0</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>; <span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>)] <span class="id">s0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MatrixApply</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (0%<span class="id">R</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d1</span> <span class="id">eqq1</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_b_strong">vectoro_to_ovector_forall_some_b_strong</a></span>; <span class="tactic">intros</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> <span class="id">m1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H8</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H7</span>); <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">i0</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H12c</span> := <span class="id">H12</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H12</span>); <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">i0</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">x</span>); [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">x0</span>); [|<span class="tactic">congruence</span>].               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H13</span>; <span class="id">invcs</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m1</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span>) <span class="id">d4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12c</span> <span class="id">x1</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H12c</span>); <span class="tactic">intros</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">x2</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x1</span>; <span class="tactic">destruct</span> <span class="id">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x2</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span> <span class="kwd">with</span> (<span class="id">pf2</span> := <span class="id">l0</span>) <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span> <span class="kwd">with</span> (<span class="id">pf1</span> := <span class="id">l3</span>) (<span class="id">pf2</span> := <span class="id">l1</span>) <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">eqq6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqq6</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">replace</span> (1 * <span class="id">d4</span>)%<span class="id">R</span> <span class="kwd">with</span> <span class="id">d4</span> <span class="kwd">in</span> <span class="id">H15</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">grad_env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitMatrix">UnitMatrix</a></span> <span class="id">m</span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)) <span class="id">d4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="id">cut_to</span> <span class="id">H13</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> <span class="kwd">in</span> <span class="id">eqq3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span>  (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq3</span>, <span class="id">eqq6</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar_same">df_eval_deriv_genvar_same</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">m</span>) <span class="id">x</span> <span class="id">l0</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> (<span class="kwd">fun</span> <span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">n</span>' &lt; <span class="id">n</span>) <span class="id">x0</span> <span class="id">l1</span>))]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s0</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H16</span> <span class="id">H</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> <span class="id">H16</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="kwd">in</span> <span class="id">eqq4</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqq4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span>, <span class="id">eqq5</span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H13</span>; <span class="tactic">rewrite</span> <span class="id">H18</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H11</span>; <span class="tactic">rewrite</span> <span class="id">H15</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>; <span class="tactic">destruct</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#matrix_zip_m_n">matrix_zip_m_n</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>)] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s0</span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>; <span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">destruct</span> <span class="id">e</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>)] <span class="id">s0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">VLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (0%<span class="id">R</span>) :: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (0%<span class="id">R</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d1</span> <span class="id">eqq1</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> <span class="id">v0</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="kwd">in</span> <span class="id">d1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>); <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s0</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v0</span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ; <span class="id">specialize</span> (<span class="id">H9</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H9</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id">match_option_in</span> <span class="id">H9</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">inversion</span> <span class="id">H9</span> ;<span class="tactic">f_equal</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partvec">df_eval_backprop_delta_by_unit_partvec</a></span> σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">v0</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">H3</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span> (@<span class="id"><a href="FormalML.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span>) <span class="id">n</span> <span class="id">i</span> (<span class="id">v0</span> <span class="id">i</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>)) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span>) (<span class="id">v0</span> <span class="id">i</span>) (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span> <span class="id">n</span> <span class="id">i</span>)) <span class="tactic">by</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scaleUnitVector">scaleUnitVector</a></span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#UnitVector">UnitVector</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span>; <span class="tactic">intros</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (` <span class="id">x</span>) (` <span class="id">i</span>)); <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env2</span> := <span class="id">grad_env</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar_same">df_eval_deriv_genvar_same</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>); <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s0</span> <span class="id">v1</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">H</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult">scalarMult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span>)] <span class="id">s0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s0</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span>)] <span class="id">s0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Case</span> "<span class="id">MLossfun</span>"%<span class="id">string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">closed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (0%<span class="id">R</span>) :: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (0%<span class="id">R</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">s0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span> σ <span class="id">l</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; [<span class="tactic">intros</span>|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">grad_env</span> <span class="id">vin</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id">grad_env</span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)); [<span class="tactic">intros</span> <span class="id">d1</span> <span class="id">eqq1</span> | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H1</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_nested_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">eqq2</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ( <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id">l</span> <span class="id">grad_env</span> <span class="id">m1</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="kwd">in</span> <span class="id">d1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">d1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> (<span class="id">i</span> : {<span class="id">n</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">m</span>}) (<span class="id">j</span> : {<span class="id">m</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">m</span>' &lt; <span class="id">n</span>}),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s0</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">se</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (1 * <span class="id">se</span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>))%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">m1</span> <span class="id">i</span> <span class="id">j</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">specialize</span> (<span class="id">H9</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H9</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">j</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span>, <span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option</span>; <span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">apply</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta_by_unit_partmat">df_eval_backprop_delta_by_unit_partmat</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <span class="id">l</span> <span class="id">s</span> <span class="id">grad_env</span> <span class="id">m1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> <span class="id">u</span> =&gt; <span class="id">u</span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>))%<span class="id">R</span> <span class="id">m0</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H12</span> <span class="id">H3</span> <span class="id">vin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>, <span class="id">eqq3</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((@<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> <span class="id"><a href="FormalML.utils.Floatish.FloatishReal.html#floatish_R">floatish_R</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id">m0</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>))%<span class="id">R</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum">msum</a></span> (<span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> (<span class="kwd">fun</span> <span class="id">u</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="id">u</span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>))%<span class="id">R</span>) <span class="id">m0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#msum_mmap_div_denom">msum_mmap_div_denom</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#scalarMult_backprop_grad_scalar">scalarMult_backprop_grad_scalar</a></span> <span class="kwd">with</span> (<span class="id">grad_env2</span> := <span class="id">grad_env</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_backprop_delta">df_eval_backprop_delta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">i</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H11</span> <span class="id">i</span> <span class="id">j</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H7</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H13</span> <span class="id">j</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_forall_some_f">vectoro_to_ovector_forall_some_f</a></span> <span class="id">H8</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H14</span> <span class="id">j</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar_same">df_eval_deriv_genvar_same</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s0</span> <span class="id">v1</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H15</span> <span class="id">H</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_gen_top">df_eval_deriv_gen_top</a></span> <span class="kwd">in</span> <span class="id">H15</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span> <span class="kwd">in</span> <span class="id">H15</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_genvar_env">mk_genvar_env</a></span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq4</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">destruct</span> <span class="id">j</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsLift.html#lift">lift</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H15</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+++ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">i</span> <span class="id">j</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">i</span> <span class="id">j</span>)] <span class="id">s0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#backprop_deriv_fully_closed_not_none">backprop_deriv_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#mmap">mmap</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrix_zip">matrix_zip</a></span>,<span class="id"><a href="FormalML.utils.Vector.html#vector_zip">vector_zip</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.Vector.html#vmap_nth">vmap_nth</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval">df_eval</a></span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span> <span class="id">x0</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_deriv">df_deriv</a></span> <span class="id">s0</span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_fully_closed_not_none">eval_fully_closed_not_none</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#fully_closed_deriv">fully_closed_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.Vector.html#matrixo_to_omatrix">matrixo_to_omatrix</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Vector.html#vectoro_to_ovector_exists_None">vectoro_to_ovector_exists_None</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_option_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">d</span> <span class="id">x</span> <span class="id">x0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v2</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">r</span> <span class="id">x</span> <span class="id">x0</span>)] <span class="id">s0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">v1</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#df_eval_deriv_genvar">df_eval_deriv_genvar</a></span> σ <span class="id">l</span> [<span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id">s</span>, <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#DTfloat">DTfloat</a></span>) 1%<span class="id">R</span>] &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#eval_deriv_genvar_fully_closed_not_none">eval_deriv_genvar_fully_closed_not_none</a></span>; <span class="tactic">trivial</span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.NeuralNetworks.DefinedFunctions.html#real_pfs">real_pfs</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
