
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.utils.CoquelicotAdd</title>
<meta name="description" content="Documentation of Coq module FormalML.utils.CoquelicotAdd" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.utils.CoquelicotAdd</h1>
<div class="coq">
<span class="kwd">Set</span> <span class="id">Warnings</span> "-<span class="id">parsing</span>".<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">mathcomp.ssreflect.ssreflect</span> <span class="id">mathcomp.ssreflect.ssrbool</span> <span class="id">mathcomp.ssreflect.eqtype</span> <span class="id">mathcomp.ssreflect.seq</span>.<br/>
<span class="kwd">Set</span> <span class="id">Warnings</span> "+<span class="id">parsing</span>".<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coquelicot.Coquelicot</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbase.html">Reals.Rbase</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rfunctions.html">Reals.Rfunctions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html">Reals.R_sqrt</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html">Rtrigo_def</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html">Rtrigo1</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo_calc.html">Reals.Rtrigo_calc</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html">fixed_point</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="id">Bullet</span> <span class="id">Behavior</span> "<span class="id">Strict</span> <span class="id">Subproofs</span>".<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sqrt2_neq0">sqrt2_neq0</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2 &lt;&gt; 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo_calc.html#Rlt_sqrt2_0">Rlt_sqrt2_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sqrt_2PI_nzero">sqrt_2PI_nzero</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span>(2*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html#PI">PI</a></span>) &lt;&gt; 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html#PI">PI</a></span> &gt; 0) <span class="kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html#PI_RGT_0">PI_RGT_0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sqrt_PI_neq0">sqrt_PI_neq0</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span>(<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html#PI">PI</a></span>) &lt;&gt; 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html#PI">PI</a></span> &gt; 0) <span class="kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo1.html#PI_RGT_0">PI_RGT_0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_Rbar_plus_Finite_l">ex_Rbar_plus_Finite_l</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id">ex_Rbar_plus</span> (<span class="id">Finite</span> <span class="id">x</span>) <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_Rbar_plus_Finite_r">ex_Rbar_plus_Finite_r</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id">ex_Rbar_plus</span> <span class="id">x</span> (<span class="id">Finite</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_Rbar_minus_Finite_l">ex_Rbar_minus_Finite_l</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id">ex_Rbar_minus</span> (<span class="id">Finite</span> <span class="id">x</span>) <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_Rbar_minus_Finite_r">ex_Rbar_minus_Finite_r</a></span> <span class="id">x</span> <span class="id">y</span> : <span class="id">ex_Rbar_minus</span> <span class="id">x</span> (<span class="id">Finite</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>; <span class="id">simpl</span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rbar_mult_p_infty_pos">Rbar_mult_p_infty_pos</a></span> (<span class="id">z</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;0 &lt; <span class="id">z</span> -&gt; <span class="id">Rbar_mult</span> <span class="id">p_infty</span> <span class="id">z</span> = <span class="id">p_infty</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_unique</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_p_infty_pos</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rbar_mult_m_infty_pos">Rbar_mult_m_infty_pos</a></span> (<span class="id">z</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;0 &lt; <span class="id">z</span> -&gt; <span class="id">Rbar_mult</span> <span class="id">m_infty</span> <span class="id">z</span> = <span class="id">m_infty</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_unique</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_m_infty_pos</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rbar_mult_p_infty_neg">Rbar_mult_p_infty_neg</a></span> (<span class="id">z</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;0 &gt; <span class="id">z</span> -&gt; <span class="id">Rbar_mult</span> <span class="id">p_infty</span> <span class="id">z</span> = <span class="id">m_infty</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_unique</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_p_infty_neg</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rbar_mult_m_infty_neg">Rbar_mult_m_infty_neg</a></span> (<span class="id">z</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;0 &gt; <span class="id">z</span> -&gt; <span class="id">Rbar_mult</span> <span class="id">m_infty</span> <span class="id">z</span> = <span class="id">p_infty</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_unique</span>.  <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_Rbar_mult_m_infty_neg</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>; <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rint_lim_gen_m_infty_p_infty">Rint_lim_gen_m_infty_p_infty</a></span> <span class="id">f</span> (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">filterlim</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filter_prod</span> (<span class="id">Rbar_locally</span>' <span class="id">m_infty</span>) (<span class="id">Rbar_locally</span>' <span class="id">p_infty</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Rbar_locally</span> <span class="id">l</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> (<span class="id">V</span>:=<span class="id">R_CompleteNormedModule</span>) <span class="id">f</span> (<span class="id">Rbar_locally</span> <span class="id">m_infty</span>) (<span class="id">Rbar_locally</span> <span class="id">p_infty</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">fex</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">is_RInt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">filterlimi</span>, <span class="id">filterlim</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">filtermap</span>, <span class="id">filtermapi</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">filter_le</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">P</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">Rbar_locally</span>' <span class="id">m_infty</span>) <span class="kwd">with</span> (<span class="id">Rbar_locally</span> <span class="id">m_infty</span>)  <span class="kwd">in</span> * <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">Rbar_locally</span>' <span class="id">p_infty</span>) <span class="kwd">with</span> (<span class="id">Rbar_locally</span> <span class="id">p_infty</span>)  <span class="kwd">in</span> * <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">filter_prod_ind</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Filter_prod</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">split</span>; <span class="id">try</span> <span class="id">eapply</span> <span class="id">H2</span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">RInt_correct</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lim_rint_gen_Rbar">lim_rint_gen_Rbar</a></span> (<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>-&gt;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">b</span>:<span class="id">Rbar</span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span>, <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) <span class="id">b</span> <span class="id">l</span> -&gt; <span class="id">is_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">b</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">fex</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">is_lim</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">filterlim</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">filter_le</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">filtermap</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">P</span> <span class="id">Plocal</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">P</span> <span class="id">Plocal</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">M</span> <span class="id">PltM</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>=<span class="id">a</span>) (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">P</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>)); <span class="id">try</span> <span class="id">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">locally</span>', <span class="id">within</span>, <span class="id">locally</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>).  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> (@<span class="id">RInt_correct</span>).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">M</span> <span class="id">PltM</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>=<span class="id">a</span>) (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">_</span>); <span class="id">try</span> <span class="id">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>).  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> (@<span class="id">RInt_correct</span>).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">M</span> <span class="id">PltM</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span>=<span class="id">a</span>) (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">_</span>); <span class="id">try</span> <span class="id">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>).  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> (@<span class="id">RInt_correct</span>).<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rint_gen_lim_Rbar">rint_gen_lim_Rbar</a></span> {<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>-&gt;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} {<span class="id">a</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} {<span class="id">b</span>:<span class="id">Rbar</span>} {<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} :<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">b</span>) <span class="id">l</span> -&gt; <span class="id">is_lim</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) <span class="id">b</span> <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">H</span> <span class="id">P</span> <span class="id">HP</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">HP</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Q</span> <span class="id">R</span> <span class="id">Qa</span> <span class="id">Rb</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">Rb</span> <span class="kwd">as</span> [<span class="id">M</span> <span class="id">Rb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">xlt</span> <span class="id">xne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">H</span> <span class="id">a</span> <span class="id">x</span> <span class="id">Qa</span> (<span class="id">Rb</span> <span class="id">_</span> <span class="id">xlt</span> <span class="id">xne</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">y</span> [<span class="id">yis</span> <span class="id">iP</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">yis</span>).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">Rb</span> <span class="kwd">as</span> [<span class="id">M</span> <span class="id">Rb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">xlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">H</span> <span class="id">a</span> <span class="id">x</span> <span class="id">Qa</span> (<span class="id">Rb</span> <span class="id">_</span> <span class="id">xlt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">y</span> [<span class="id">yis</span> <span class="id">iP</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">yis</span>).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">Rb</span> <span class="kwd">as</span> [<span class="id">M</span> <span class="id">Rb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">xlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">H</span> <span class="id">a</span> <span class="id">x</span> <span class="id">Qa</span> (<span class="id">Rb</span> <span class="id">_</span> <span class="id">xlt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">y</span> [<span class="id">yis</span> <span class="id">iP</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">yis</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_comp_lin0">is_RInt_gen_comp_lin0</a></span><br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">u</span> <span class="id">v</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">b</span> : <span class="id">Rbar</span>) (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">u</span>&lt;&gt;0 -&gt; (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> (<span class="id">u</span> * <span class="id">a</span> + <span class="id">v</span>)) (<span class="id">Rbar_locally</span>'  (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>) <span class="id">v</span>)) <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">is_RInt_gen</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">scal</span> <span class="id">u</span> (<span class="id">f</span> (<span class="id">u</span> * <span class="id">y</span> + <span class="id">v</span>))) (<span class="id">at_point</span> <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">b</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#lim_rint_gen_Rbar">lim_rint_gen_Rbar</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> (@<span class="id">ex_RInt_comp_lin</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">is_lim_ext</span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">RInt</span> <span class="id">f</span> (<span class="id">u</span>*<span class="id">a</span>+<span class="id">v</span>) (<span class="id">u</span>*<span class="id">x</span>+<span class="id">v</span>))).<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">RInt_comp_lin</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">is_lim_comp_lin</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#rint_gen_lim_Rbar">rint_gen_lim_Rbar</a></span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_comp_lin_point_0">is_RInt_gen_comp_lin_point_0</a></span><br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">u</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">b</span> : <span class="id">Rbar</span>) (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">u</span>&lt;&gt;0 -&gt; (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> (<span class="id">u</span> * <span class="id">a</span>)) (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>)) <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">is_RInt_gen</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">scal</span> <span class="id">u</span> (<span class="id">f</span> (<span class="id">u</span> * <span class="id">y</span>))) (<span class="id">at_point</span> <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">b</span>) <span class="id">l</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">is_RInt_gen_ext</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">scal</span> <span class="id">u</span> (<span class="id">f</span> (<span class="id">u</span>*<span class="id">y</span> + 0)))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">filter_forall</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">replace</span> (<span class="id">u</span> * <span class="id">x0</span> + 0) <span class="kwd">with</span> (<span class="id">u</span> * <span class="id">x0</span>) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#is_RInt_gen_comp_lin0">is_RInt_gen_comp_lin0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">u</span>*<span class="id">a</span>+0) <span class="kwd">with</span> (<span class="id">u</span>*<span class="id">a</span>) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>) 0) <span class="kwd">with</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">Rbar_plus_0_r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RInt_gen_Chasles">RInt_gen_Chasles</a></span> {<span class="id">Fa</span> <span class="id">Fc</span> : (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;{<span class="id">FFa</span> : <span class="id">ProperFilter</span>' <span class="id">Fa</span>} {<span class="id">FFc</span> : <span class="id">ProperFilter</span>' <span class="id">Fc</span>}<br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id">f</span> <span class="id">Fa</span> (<span class="id">at_point</span> <span class="id">b</span>) -&gt; <span class="id">ex_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> <span class="id">b</span>) <span class="id">Fc</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">plus</span> (<span class="id">RInt_gen</span> <span class="id">f</span> <span class="id">Fa</span> (<span class="id">at_point</span> <span class="id">b</span>)) (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> <span class="id">b</span>) <span class="id">Fc</span>) = <span class="id">RInt_gen</span> <span class="id">f</span> <span class="id">Fa</span> <span class="id">Fc</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#sym_eq">sym_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id">is_RInt_gen_unique</span>).<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id">is_RInt_gen_Chasles</span>) <span class="kwd">with</span> (<span class="id">b</span>:=<span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">filter_filter</span>'.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">filter_filter</span>'.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">RInt_gen_correct</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">RInt_gen_correct</span>.  <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_comp_lin">is_RInt_gen_comp_lin</a></span><br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">u</span> <span class="id">v</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id">Rbar</span>) (<span class="id">ll</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">u</span>&lt;&gt;0 -&gt; <span class="id">ex_RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>)) (<span class="id">at_point</span> (<span class="id">u</span>*0+<span class="id">v</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> (<span class="id">u</span>*0+<span class="id">v</span>)) (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>) <span class="id">v</span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>'  (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>)) (<span class="id">Rbar_locally</span>'  (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>) <span class="id">v</span>)) <span class="id">ll</span><br/>
&nbsp;&nbsp;-&gt; <span class="id">is_RInt_gen</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">scal</span> <span class="id">u</span> (<span class="id">f</span> (<span class="id">u</span> * <span class="id">y</span> + <span class="id">v</span>))) (<span class="id">Rbar_locally</span>' <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">b</span>) <span class="id">ll</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">ll</span>) <span class="kwd">with</span> (<span class="id">plus</span> (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>))  (<span class="id">at_point</span> (<span class="id">u</span>*0+<span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> (<span class="id">u</span>*0+<span class="id">v</span>)) (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>) <span class="id">v</span>)))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id">is_RInt_gen_Chasles</span> <span class="id">R_CompleteNormedModule</span>) <span class="kwd">with</span> (<span class="id">b</span> := 0) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l1</span> := (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>))  (<span class="id">at_point</span> (<span class="id">u</span>*0+<span class="id">v</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l2</span> := (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> (<span class="id">u</span>*0+<span class="id">v</span>)) (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">b</span>) <span class="id">v</span>)))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rbar_locally</span>'<span class="id">_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rbar_locally</span>'<span class="id">_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>)) (<span class="id">at_point</span> (<span class="id">u</span> * 0 + <span class="id">v</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opp</span> (<span class="id">opp</span> (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>)) (<span class="id">at_point</span> (<span class="id">u</span> * 0 + <span class="id">v</span>))))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id">is_RInt_gen_swap</span> <span class="id">R_CompleteNormedModule</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> := (<span class="id">opp</span> (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>)) (<span class="id">at_point</span> (<span class="id">u</span> * 0 + <span class="id">v</span>))))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rbar_locally</span>'<span class="id">_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">at_point_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#is_RInt_gen_comp_lin0">is_RInt_gen_comp_lin0</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id">is_RInt_gen_swap</span> <span class="id">R_CompleteNormedModule</span>) <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> := (<span class="id">RInt_gen</span> <span class="id">f</span> (<span class="id">Rbar_locally</span>' (<span class="id">Rbar_plus</span> (<span class="id">Rbar_mult</span> <span class="id">u</span> <span class="id">a</span>) <span class="id">v</span>)) (<span class="id">at_point</span> (<span class="id">u</span> * 0 + <span class="id">v</span>)))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">at_point_filter</span>.  <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rbar_locally</span>'<span class="id">_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">RInt_gen_correct</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">opp_opp</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#is_RInt_gen_comp_lin0">is_RInt_gen_comp_lin0</a></span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (@<span class="id">RInt_gen_correct</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Proper_StrongProper</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">at_point_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Proper_StrongProper</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rbar_locally</span>'<span class="id">_filter</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#RInt_gen_Chasles">RInt_gen_Chasles</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">is_RInt_gen_unique</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html">Sets.Ensembles</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_not_contains">lub_not_contains</a></span> (<span class="id">S1</span>  <span class="id">S2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Ensemble">Ensemble</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">L1</span> <span class="id">L2</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_lub">is_lub</a></span> <span class="id">S1</span> <span class="id">L1</span>) /\ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_upper_bound">is_upper_bound</a></span> <span class="id">S2</span> <span class="id">L2</span>) -&gt; <span class="id">L1</span> &gt; <span class="id">L2</span> -&gt; ~ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Included">Included</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S1</span> <span class="id">S2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_lub">is_lub</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_upper_bound">is_upper_bound</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Included">Included</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (~ (<span class="id">L1</span> &lt;= <span class="id">L2</span>)) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">intuition</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="not_included">not_included</a></span> (<span class="id">S1</span>  <span class="id">S2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Ensemble">Ensemble</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;~ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Included">Included</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S1</span> <span class="id">S2</span> -&gt; <span class="kwd">exists</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S1</span> <span class="id">x</span> /\ ~ <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S2</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Included">Included</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">Classical_Pred_Type.not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H</span>.  <br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">Classical_Prop.imply_to_and</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lub_witness">lub_witness</a></span> (<span class="id">S1</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Ensemble">Ensemble</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">L1</span> <span class="id">L2</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">S2</span> :<span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#Ensemble">Ensemble</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> := (<span class="kwd">fun</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S1</span> <span class="id">x</span> /\ <span class="id">x</span> &lt;= <span class="id">L2</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_lub">is_lub</a></span> <span class="id">S1</span> <span class="id">L1</span>) -&gt; <span class="id">L1</span> &gt; <span class="id">L2</span> -&gt; <span class="kwd">exists</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S1</span> <span class="id">x</span> /\ <span class="id">x</span> &gt; <span class="id">L2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S1</span> <span class="id">x</span> /\ ~<span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id">S2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#not_included">not_included</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#lub_not_contains">lub_not_contains</a></span> <span class="kwd">with</span> (<span class="id">L1</span> := <span class="id">L1</span>) (<span class="id">L2</span> := <span class="id">L2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_upper_bound">is_upper_bound</a></span>, <span class="id">S2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">S2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Sets.Ensembles.html#In">In</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="increasing_bounded_limit">increasing_bounded_limit</a></span> (<span class="id">M</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">f</span>: <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>-&gt;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#increasing">Ranalysis1.increasing</a></span> <span class="id">f</span> -&gt; <br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">M</span>) -&gt; <span class="id">ex_finite_lim</span> <span class="id">f</span> <span class="id">p_infty</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#increasing">Ranalysis1.increasing</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">ex_finite_lim</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> { <span class="id">m</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_lub">is_lub</a></span> (<span class="kwd">fun</span> <span class="id">y</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; (<span class="kwd">exists</span> <span class="id">x</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id">y</span> = <span class="id">f</span> <span class="id">x</span>)) <span class="id">m</span> }.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#completeness">completeness</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#bound">bound</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_upper_bound">is_upper_bound</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id">f</span> 0); <span class="id">now</span> <span class="kwd">exists</span> (0).<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">L</span> <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">is_lim_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">is_lim</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">Rbar_locally</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_lub">is_lub</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;since&nbsp;L-eps&nbsp;is&nbsp;not&nbsp;an&nbsp;upper&nbsp;bound,&nbsp;there&nbsp;exists&nbsp;(f&nbsp;x0)&nbsp;&gt;&nbsp;L-eps&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="kwd">exists</span> <span class="id">y0</span>, (<span class="kwd">exists</span> <span class="id">x0</span>, <span class="id">y0</span> = <span class="id">f</span> <span class="id">x0</span>) /\ <span class="id">y0</span> &gt; <span class="id">L</span>-<span class="id">eps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#lub_witness">lub_witness</a></span> <span class="kwd">with</span> (<span class="id">L1</span> := <span class="id">L</span>) (<span class="id">L2</span> := <span class="id">L</span>-<span class="id">eps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_lub">is_lub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_gt">Rminus_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">L</span> - (<span class="id">L</span> - (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>))) <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">f</span> <span class="id">x1</span> - <span class="id">L</span>) <span class="kwd">with</span> (- (<span class="id">L</span> - <span class="id">f</span> <span class="id">x1</span>)) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">assert</span> (<span class="id">f</span> <span class="id">x0</span> &lt;= <span class="id">f</span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#is_upper_bound">is_upper_bound</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_minus">Rge_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="kwd">exists</span> <span class="id">x1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_lim_rint_gen_Rbar">ex_lim_rint_gen_Rbar</a></span> (<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>-&gt;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">b</span>:<span class="id">Rbar</span>):<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span>, <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_finite_lim</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) <span class="id">b</span> -&gt; <span class="id">ex_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">b</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">ex_RInt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">ex_finite_lim</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#lim_rint_gen_Rbar">lim_rint_gen_Rbar</a></span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_RInt_gen_bounded">ex_RInt_gen_bounded</a></span> (<span class="id">M</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">f</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">b</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">f</span> <span class="id">b</span> &gt;= 0) -&gt; <br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">b</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) -&gt; <br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">b</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> &lt;= <span class="id">M</span>) -&gt; <span class="id">ex_RInt_gen</span> <span class="id">f</span> (<span class="id">at_point</span> <span class="id">a</span>) (<span class="id">Rbar_locally</span>' <span class="id">p_infty</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> ( <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#increasing">Ranalysis1.increasing</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">z</span>)).<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#increasing">Ranalysis1.increasing</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) <span class="kwd">with</span> (<span class="id">plus</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> &lt;- <span class="id">RInt_Chasles</span> <span class="kwd">with</span> (<span class="id">b</span>:=<span class="id">x</span>) (<span class="id">c</span>:=<span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">RInt_ge_0</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">apply</span> <span class="id">ex_RInt_Chasles</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">apply</span> <span class="id">ex_RInt_swap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id">ex_RInt_Chasles</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">apply</span> <span class="id">ex_RInt_swap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#ex_lim_rint_gen_Rbar">ex_lim_rint_gen_Rbar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#increasing_bounded_limit">increasing_bounded_limit</a></span> <span class="kwd">with</span> (<span class="id">M</span>:=<span class="id">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">sqrt2_neq0</span> <span class="id">sqrt_PI_neq0</span> <span class="id">sqrt_2PI_nzero</span> : <span class="id">Rarith</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_zero_eq">ball_zero_eq</a></span> {<span class="id">K</span> : <span class="id">AbsRing</span>} (<span class="id">X</span> : <span class="id">NormedModule</span> <span class="id">K</span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">X</span>, <span class="id">ball</span> <span class="id">x</span> 0 <span class="id">y</span> -&gt; <span class="id">x</span>=<span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hxy</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eq_close</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">e1</span> := 0).<br/>
&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="minus_zero_iff_eq">minus_zero_iff_eq</a></span> {<span class="id">G</span> : <span class="id">AbelianGroup</span>} : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">G</span>, (<span class="id">minus</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">zero</span>) &lt;-&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id">minus</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">plus_reg_r</span> <span class="kwd">with</span> (<span class="id">opp</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">symmetry</span>. <span class="id">apply</span> <span class="id">plus_opp_r</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">minus_eq_zero</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_Lipschitz_le_zero_const">is_Lipschitz_le_zero_const</a></span> {<span class="id">K1</span> <span class="id">K2</span> : <span class="id">AbsRing</span>} {<span class="id">X</span> : <span class="id">NormedModule</span> <span class="id">K1</span>} {<span class="id">Y</span> : <span class="id">NormedModule</span> <span class="id">K2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">F</span> : <span class="id">X</span> -&gt; <span class="id">Y</span>}:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">X</span>, <span class="id">norm</span> (<span class="id">minus</span> (<span class="id">F</span> <span class="id">y</span>) (<span class="id">F</span> <span class="id">x</span>)) &lt;= 0) -&gt; (<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">F</span> <span class="id">x</span> = <span class="id">F</span> <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Hnorm</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hnorm</span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hnorm</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#ball_zero_eq">ball_zero_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">norm_compat1</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span> (<span class="id">norm_eq_zero</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> &lt;-<span class="id"><a href="FormalML.utils.CoquelicotAdd.html#minus_zero_iff_eq">minus_zero_iff_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rlt_forall_le">Rlt_forall_le</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : (<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">a</span> &lt; <span class="id">b</span> + <span class="id">eps</span>) -&gt; <span class="id">a</span> &lt;= <span class="id">b</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">b</span>); <span class="id">intros</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">n</span>); <span class="id">intros</span> <span class="id">Hab</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hpos</span> : 0 &lt; (<span class="id">a</span> - <span class="id">b</span>)/2) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">abs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> ((<span class="id">a</span> - <span class="id">b</span>)/2) <span class="id">Hpos</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">abs</span>).<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span> ; <span class="id">clear</span> <span class="id">abs</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Rlt_forall_le</span>' (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : (<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">a</span> + <span class="id">eps</span> &lt; <span class="id">b</span>) -&gt; <span class="id">a</span> &lt;= <span class="id">b</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">b</span>); <span class="id">intros</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">n</span>); <span class="id">intros</span> <span class="id">Hab</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hpos</span> : 0 &lt; (<span class="id">a</span> - <span class="id">b</span>)/2) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">abs</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> ((<span class="id">a</span> - <span class="id">b</span>)/2) <span class="id">Hpos</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">abs</span>).<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span> ; <span class="id">clear</span> <span class="id">abs</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_Lipschitz_cond">is_Lipschitz_cond</a></span> {<span class="id">K</span> : <span class="id">AbsRing</span>} {<span class="id">X</span> : <span class="id">NormedModule</span> <span class="id">K</span>}{<span class="id">Y</span> : <span class="id">NormedModule</span> <span class="id">R_AbsRing</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">F</span> : <span class="id">X</span> -&gt; <span class="id">Y</span>} (γ : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;(0 &lt;= γ &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">X</span>) (<span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">norm</span>(<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>) &lt; <span class="id">r</span> -&gt; <span class="id">norm</span>(<span class="id">minus</span> (<span class="id">F</span> <span class="id">y</span>) (<span class="id">F</span> <span class="id">x</span>)) &lt; γ*<span class="id">r</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">X</span>), <span class="id">norm</span> (<span class="id">minus</span> (<span class="id">F</span> <span class="id">y</span>) (<span class="id">F</span> <span class="id">x</span>)) &lt;= γ*<span class="id">norm</span>( <span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">H</span>γ <span class="id">H</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.utils.CoquelicotAdd.html#Rlt_forall_le">Rlt_forall_le</a></span>; <span class="id">intros</span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">eps</span> <span class="kwd">as</span> [<span class="id">eps</span> <span class="id">Heps</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span>γ <span class="kwd">as</span> [<span class="id">H1</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id">Rle_mult_Rlt</span>; <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hxy</span> : <span class="id">norm</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>) &lt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>) + <span class="id">eps</span>) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">x</span> <span class="id">y</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>) + <span class="id">eps</span>) <span class="id">Hxy</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H2</span>; <span class="id">subst</span> ; <span class="id">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">eps</span>) <span class="kwd">with</span> (1*<span class="id">eps</span>) <span class="kwd">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span>; <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>; <span class="id">trivial</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
