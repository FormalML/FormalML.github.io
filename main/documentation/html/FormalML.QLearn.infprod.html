
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.QLearn.infprod</title>
<meta name="description" content="Documentation of Coq module FormalML.QLearn.infprod" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.QLearn.infprod</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span> <span class="id"><a href="FormalML.utils.Sums.html">Sums</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coquelicot.Coquelicot</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.QLearn.sumtest.html">sumtest</a></span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="id">Bullet</span> <span class="id">Behavior</span> "<span class="kwd">Strict</span> <span class="id">Subproofs</span>".<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="fold_iter">fold_iter</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_mult_acc">fold_right_mult_acc</a></span> (<span class="id">acc</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span> <span class="id">acc</span> <span class="id">l</span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span> 1 <span class="id">l</span> * <span class="id">acc</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4715')">Proof.</div>
<div class="proofscript" id="proof4715">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">acc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">acc</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_is_an_annoying_seq">iota_is_an_annoying_seq</a></span> <span class="id">m</span> <span class="id">n</span> : <span class="id">seq.iota</span> <span class="id">m</span> <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4716')">Proof.</div>
<div class="proofscript" id="proof4716">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_mult_pos">fold_right_mult_pos</a></span> {<span class="id">A</span>} (<span class="id">a</span>: <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> (<span class="kwd">fun</span> (<span class="id">a1</span> : <span class="id">A</span>) (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) =&gt; <span class="id">a</span> <span class="id">a1</span> * <span class="id">b</span>) 1 <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4717')">Proof.</div>
<div class="proofscript" id="proof4717">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_max_upper_list">fold_right_max_upper_list</a></span>  <span class="id">acc</span> <span class="id">l</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">x</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4718')">Proof.</div>
<div class="proofscript" id="proof4718">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">inn</span>; [<span class="tactic">intuition</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_l">Rmax_l</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_r">Rmax_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_max_upper_acc">fold_right_max_upper_acc</a></span> <span class="id">acc</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;<span class="id">acc</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4719')">Proof.</div>
<div class="proofscript" id="proof4719">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_r">Rmax_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_max_in">fold_right_max_in</a></span> <span class="id">acc</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc</span> <span class="id">l</span>) = <span class="id">acc</span> \/<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">List.In</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc</span> <span class="id">l</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4720')">Proof.</div>
<div class="proofscript" id="proof4720">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_case">Rmax_case</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_case">Rmax_case</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_max_acc">fold_right_max_acc</a></span> (<span class="id">acc1</span> <span class="id">acc2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc1</span> <span class="id">l</span>) =<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc2</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4721')">Proof.</div>
<div class="proofscript" id="proof4721">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">acc1</span> <span class="id">acc2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">acc1</span> <span class="id">acc2</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_comm">Rmax_comm</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_comm">Rmax_comm</a></span>, &lt;- <span class="id">Rmax_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_comm">Rmax_comm</a></span> <span class="id">_</span> <span class="id">acc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Rmax_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_comm">Rmax_comm</a></span> <span class="id">a</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">Rmax_assoc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_plus_acc">fold_right_plus_acc</a></span> {<span class="id">G</span>: <span class="id">AbelianGroup</span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">G</span>) (<span class="id">acc</span> : <span class="id">G</span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">acc</span> : <span class="id">G</span>) =&gt; <span class="id">plus</span> (<span class="id">f</span> <span class="id">i</span>) <span class="id">acc</span>) <span class="id">acc</span> <span class="id">l</span> =<br/>
&nbsp;&nbsp;<span class="id">plus</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> (<span class="kwd">fun</span> (<span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">acc</span> : <span class="id">G</span>) =&gt; <span class="id">plus</span> (<span class="id">f</span> <span class="id">i</span>) <span class="id">acc</span>) <span class="id">zero</span> <span class="id">l</span>) <span class="id">acc</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4722')">Proof.</div>
<div class="proofscript" id="proof4722">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">acc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">acc</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">plus_zero_l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">plus_assoc</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_rmax_const">fold_right_rmax_const</a></span> <span class="id">acc</span> <span class="id">l</span> <span class="id">c</span>:<br/>
&nbsp;&nbsp;0 &lt;= <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">acc</span> <span class="id">l</span> * <span class="id">c</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (<span class="id">acc</span>*<span class="id">c</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> * <span class="id">c</span>) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4723')">Proof.</div>
<div class="proofscript" id="proof4723">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> <span class="id">c</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#RmaxRmult">RmaxRmult</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iter_plus_times_const">iter_plus_times_const</a></span> {<span class="id">A</span>} <span class="id">F</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>)  <span class="id">c</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Iter.iter</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 <span class="id">l</span> (<span class="kwd">fun</span> <span class="id">k</span>  =&gt; <span class="id">F</span> <span class="id">k</span> * <span class="id">c</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Iter.iter</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 <span class="id">l</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id">F</span> <span class="id">k</span>) * <span class="id">c</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4724')">Proof.</div>
<div class="proofscript" id="proof4724">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_seq_init_map">list_seq_init_map</a></span> <span class="id">init</span> <span class="id">len</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> <span class="id">init</span> <span class="id">len</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">init</span> + <span class="id">x</span>)%<span class="id">nat</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 <span class="id">len</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4725')">Proof.</div>
<div class="proofscript" id="proof4725">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">init</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_id">List.map_id</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_shift">List.seq_shift</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHinit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">List.map_map</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_iter">fold_iter</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="products">products</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="part_prod_n">part_prod_n</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>  :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rmult">Rmult</a></span> 1 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">a</span> <span class="id">x</span>).(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> - <span class="id">n</span>)%<span class="id">nat</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="part_prod">part_prod</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> 0 <span class="id">n</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pos_part_prod_n">pos_part_prod_n</a></span>  (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4726')">Proof.</div>
<div class="proofscript" id="proof4726">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id">m</span>)%<span class="id">nat</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n0</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [|<span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pos_part_prod">pos_part_prod</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4727')">Proof.</div>
<div class="proofscript" id="proof4727">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="part_prod_n_pos">part_prod_n_pos</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="part_prod_pos">part_prod_pos</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod">pos_part_prod</a></span> <span class="id">a</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part_prod_n_S">part_prod_n_S</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;(<span class="id">m</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) = <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span> * <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4728')">Proof.</div>
<div class="proofscript" id="proof4728">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">mle</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) - <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">with</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id">m</span>) + 1)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">List.map_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right_app">List.fold_right_app</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_mult_acc">fold_right_mult_acc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part_prod_n_k_k">part_prod_n_k_k</a></span> <span class="id">a</span> <span class="id">k</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">k</span> <span class="id">k</span> = <span class="id">a</span> <span class="id">k</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4729')">Proof.</div>
<div class="proofscript" id="proof4729">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span> - <span class="id">k</span>)%<span class="id">nat</span> <span class="kwd">with</span> (1%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part_prod_n_1">part_prod_n_1</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;(<span class="id">m</span> &gt; <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span>) = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4730')">Proof.</div>
<div class="proofscript" id="proof4730">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">with</span> (0%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ln_part_prod">ln_part_prod</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span> <span class="id">n</span>) = <span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">n1</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id">a</span> <span class="id">n1</span>)) <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4731')">Proof.</div>
<div class="proofscript" id="proof4731">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span>, <span class="id">sum_n_m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Iter.iter_nat</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Iter.iter_iter</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#iota_is_an_annoying_seq">iota_is_an_annoying_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Iter.iter</span>', <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - 0)); <span class="tactic">intros</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#fold_right_map">ListAdd.fold_right_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln_1">ln_1</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln_mult">ln_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_mult_pos">fold_right_mult_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="initial_seg_prod">initial_seg_prod</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">k</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)%<span class="id">nat</span> = (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> <span class="id">m</span>) * (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)%<span class="id">nat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4732')">Proof.</div>
<div class="proofscript" id="proof4732">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">k</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span>+1)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_k_k">part_prod_n_k_k</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>))%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHk</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>]; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="initial_seg_prod_n">initial_seg_prod_n</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">k</span> <span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;(<span class="id">k</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span> = (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">k</span> <span class="id">m</span>) * (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4733')">Proof.</div>
<div class="proofscript" id="proof4733">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id">m</span>+0)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_k_k">part_prod_n_k_k</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part_prod_n_shift">part_prod_n_shift</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">F</span> (<span class="id">m</span> + <span class="id">k</span>)%<span class="id">nat</span>) 0 <span class="id">n</span> = <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">m</span> (<span class="id">n</span> +  <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4734')">Proof.</div>
<div class="proofscript" id="proof4734">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - 0)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">n</span> + <span class="id">m</span>) - <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">replace</span> (<span class="id">m</span> + 0)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>+1)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>, <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">List.map_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="kwd">with</span> (<span class="id">n</span>+1)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">List.map_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="initial_seg_prod2">initial_seg_prod2</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">k</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> (<span class="id">k</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> =<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> <span class="id">m</span>) * (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> (<span class="kwd">fun</span> <span class="id">k0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">k0</span>)%<span class="id">nat</span>) <span class="id">k</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4735')">Proof.</div>
<div class="proofscript" id="proof4735">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#initial_seg_prod">initial_seg_prod</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">k</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">k</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_shift">part_prod_n_shift</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">replace</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">k</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="pos_sq">pos_sq</a></span> (<span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> (<span class="id">c</span> * <span class="id">c</span>) <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4736')">Next Obligation.</div>
<div class="proofscript" id="proof4736">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">c</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pos_sq_fun">pos_sq_fun</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq">pos_sq</a></span> (<span class="id">a</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part_prod_pos_sq_pos">part_prod_pos_sq_pos</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">a</span>) <span class="id">n</span>).(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span>) = (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) <span class="id">n</span>).(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4737')">Proof.</div>
<div class="proofscript" id="proof4737">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq">pos_sq</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>]; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inf_prod_sq_0">inf_prod_sq_0</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">a</span>)) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4738')">Proof.</div>
<div class="proofscript" id="proof4738">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos_sq_pos">part_prod_pos_sq_pos</a></span> <span class="id">a</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">replace</span> (0) <span class="kwd">with</span> (0 * 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">is_lim_seq_mult</span> <span class="kwd">with</span> (<span class="id">l1</span> := 0) (<span class="id">l2</span> := 0).<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inf_prod_m_0">inf_prod_m_0</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>):<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">a</span> (<span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span>)) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4739')">Proof.</div>
<div class="proofscript" id="proof4739">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id">is_lim_seq_incr_n</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (/ (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> <span class="id">m</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> (<span class="id">k</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#initial_seg_prod2">initial_seg_prod2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="kwd">with</span> (<span class="id">r2</span> := <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">a</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r_simpl_r">Rinv_r_simpl_r</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod">pos_part_prod</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">is_lim_seq_mult</span> <span class="kwd">with</span> (<span class="id">l1</span> := / (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span> <span class="id">m</span>)) (<span class="id">l2</span> := 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">is_lim_seq_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">is_Rbar_mult</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inf_prod_n_m_0">inf_prod_n_m_0</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>):<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_pos">part_prod_n_pos</a></span> <span class="id">a</span> <span class="id">m</span>) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4740')">Proof.</div>
<div class="proofscript" id="proof4740">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_pos">part_prod_n_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_incr_n</span> <span class="kwd">with</span> (<span class="id">N</span> := <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">a</span> (<span class="id">m</span> + <span class="id">k</span>)%<span class="id">nat</span>) <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_shift">part_prod_n_shift</a></span>.  <br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#inf_prod_m_0">inf_prod_m_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.QLearn.infprod.html#products">products</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="series_sequences">series_sequences</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="series_seq">series_seq</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_series</span> <span class="id">a</span> <span class="id">l</span> &lt;-&gt; <span class="id">is_lim_seq</span> (<span class="id">sum_n</span> <span class="id">a</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4741')">Proof.</div>
<div class="proofscript" id="proof4741">
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">is_series</span>, <span class="id">is_lim_seq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="log_product_iff_sum_logs">log_product_iff_sum_logs</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>): <br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span> <span class="id">n</span>))) <span class="id">l</span> &lt;-&gt; <span class="id">is_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id">a</span> <span class="id">n</span>)) <span class="id">l</span> .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4742')">Proof.</div>
<div class="proofscript" id="proof4742">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#series_seq">series_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">is_lim_seq_ext</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#ln_part_prod">ln_part_prod</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">is_lim_seq_ext</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.QLearn.infprod.html#ln_part_prod">ln_part_prod</a></span>.  <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="derivable_pt_ln">derivable_pt_ln</a></span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;0 &lt; <span class="id">x</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt">derivable_pt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4743')">Proof.</div>
<div class="proofscript" id="proof4743">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt">derivable_pt</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_abs">derivable_pt_abs</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (/ <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#derivable_pt_lim_ln">derivable_pt_lim_ln</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="log_product_iff_product">log_product_iff_product</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>): <br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span> <span class="id">n</span>))) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">l</span>) &lt;-&gt; <span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) <span class="id">l</span> .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4744')">Proof.</div>
<div class="proofscript" id="proof4744">
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">l</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt;  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span> <span class="id">n</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#exp_ln">exp_ln</a></span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod">pos_part_prod</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">l</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">l</span>))) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#exp_ln">exp_ln</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_continuous</span>; [|<span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_continuous_pt">derivable_continuous_pt</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis4.html#derivable_pt_exp">derivable_pt_exp</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">is_lim_seq_continuous</span>; [|<span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_continuous_pt">derivable_continuous_pt</a></span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#derivable_pt_ln">derivable_pt_ln</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_product_iff_is_log_sum">is_product_iff_is_log_sum</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) <span class="id">l</span> &lt;-&gt; <span class="id">is_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id">a</span> <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4745')">Proof.</div>
<div class="proofscript" id="proof4745">
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.QLearn.infprod.html#log_product_iff_sum_logs">log_product_iff_sum_logs</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#log_product_iff_product">log_product_iff_product</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_lim_seq_pos">is_lim_seq_pos</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">lb</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>):<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">lb</span> &lt;= <span class="id">a</span> <span class="id">n</span>) -&gt; <span class="id">is_lim_seq</span> <span class="id">a</span> <span class="id">l</span> -&gt; 0 &lt; <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4746')">Proof.</div>
<div class="proofscript" id="proof4746">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">is_lim_seq_const</span> <span class="id">lb</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">is_lim_seq_le</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">lb</span>) <span class="id">a</span> <span class="id">lb</span> <span class="id">l</span> <span class="id">H0</span> <span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">lb</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_product_iff_ex_log_sum">ex_product_iff_ex_log_sum</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">lb</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>):<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">lb</span> &lt;= <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span> <span class="id">n</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id">ex_finite_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) &lt;-&gt; <span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id">a</span> <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4747')">Proof.</div>
<div class="proofscript" id="proof4747">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_finite_lim_seq</span>, <span class="id">ex_series</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#is_lim_seq_pos">is_lim_seq_pos</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) <span class="id">x</span> <span class="id">lb</span> <span class="id">H</span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#is_product_iff_is_log_sum">is_product_iff_is_log_sum</a></span> <span class="kwd">with</span> (<span class="id">l</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">x</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;- <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>)) <span class="kwd">in</span> <span class="id">H0</span> <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln_exp">ln_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Exp_prop.html#exp_pos">exp_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#is_product_iff_is_log_sum">is_product_iff_is_log_sum</a></span> <span class="kwd">with</span> (<span class="id">l</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>) <span class="id">H1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sum_split">sum_split</a></span> {<span class="id">G</span> : <span class="id">AbelianGroup</span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id">G</span>) (<span class="id">n1</span> <span class="id">n2</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id">n1</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt; (<span class="id">m</span> &lt; <span class="id">n2</span>)%<span class="id">nat</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id">sum_n_m</span> <span class="id">f</span> <span class="id">n1</span> <span class="id">n2</span> = <span class="id">plus</span> (<span class="id">sum_n_m</span> <span class="id">f</span> <span class="id">n1</span> <span class="id">m</span>) (<span class="id">sum_n_m</span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4748')">Proof.</div>
<div class="proofscript" id="proof4748">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n_m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Iter.iter_nat</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Iter.iter_iter</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Iter.iter</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#iota_is_an_annoying_seq">iota_is_an_annoying_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#iota_is_an_annoying_seq">iota_is_an_annoying_seq</a></span> <span class="id">n1</span>  (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> - <span class="id">n1</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#iota_is_an_annoying_seq">iota_is_an_annoying_seq</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n2</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)).  <br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n2</span> - <span class="id">n1</span>)%<span class="id">nat</span> <span class="kwd">with</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> - <span class="id">n1</span>) + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n2</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>))%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right_app">List.fold_right_app</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_plus_acc">fold_right_plus_acc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">replace</span> (<span class="id">n1</span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> - <span class="id">n1</span>))%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nneg_sum_n_m_sq">nneg_sum_n_m_sq</a></span>  (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;0 &lt;= <span class="id">sum_n_m</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">a</span> <span class="id">k</span>)) <span class="id">n</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4749')">Proof.</div>
<div class="proofscript" id="proof4749">
&nbsp;&nbsp;<span class="tactic">replace</span> (0) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> - <span class="id">n</span>) * 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">sum_n_m_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sum_n_m_le</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nneg_series_sq">nneg_series_sq</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fnsq</span> := (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">a</span> <span class="id">n</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">ex_series</span> <span class="id">fnsq</span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id">Series</span> <span class="id">fnsq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4750')">Proof.</div>
<div class="proofscript" id="proof4750">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Series</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0) = 0).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Series</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">Lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Lim_seq_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_n_const</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Series_le</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sub_sum_limit">sub_sum_limit</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fnsq</span> := (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">a</span> <span class="id">n</span>)) <span class="kwd">in</span>      <br/>
&nbsp;&nbsp;<span class="id">ex_series</span> <span class="id">fnsq</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sum_n</span> <span class="id">fnsq</span> <span class="id">n</span> &lt;= <span class="id">Series</span> <span class="id">fnsq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4751')">Proof.</div>
<div class="proofscript" id="proof4751">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">Series_incr_n</span> <span class="id">fnsq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">H0</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">sum_n_Reals</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Nat.html#pred">Init.Nat.pred</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">with</span> (<span class="id">n</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">sum_n</span> <span class="id">fnsq</span> <span class="id">n</span>) <span class="kwd">with</span> (<span class="id">sum_n</span> <span class="id">fnsq</span> <span class="id">n</span> + 0) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#nneg_series_sq">nneg_series_sq</a></span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> + <span class="id">k</span>)%<span class="id">nat</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">ex_series_incr_n</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">a</span> <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sum_n_le_loc">sum_n_le_loc</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, (<span class="id">n</span> &lt;= <span class="id">k</span>)%<span class="id">nat</span> -&gt; <span class="id">a</span> <span class="id">n</span> &lt;= <span class="id">b</span> <span class="id">n</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id">sum_n</span> <span class="id">a</span> <span class="id">k</span> &lt;= <span class="id">sum_n</span> <span class="id">b</span> <span class="id">k</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4752')">Proof.</div>
<div class="proofscript" id="proof4752">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_O</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_O</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_Sn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_Sn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, (<span class="id">n</span> &lt;= <span class="id">k</span>)%<span class="id">nat</span> -&gt; <span class="id">a</span> <span class="id">n</span> &lt;= <span class="id">b</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHk</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>; <span class="tactic">trivial</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lim_sq_0">lim_sq_0</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_series</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">a</span> <span class="id">k</span>)) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, 0 = <span class="id">a</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4753')">Proof.</div>
<div class="proofscript" id="proof4753">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' := <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_series_unique</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">a</span> <span class="id">k</span>)²)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_series</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> 0; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#sub_sum_limit">sub_sum_limit</a></span> <span class="id">a</span> <span class="id">n</span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#nneg_sum_n_m_sq">nneg_sum_n_m_sq</a></span>  <span class="id">a</span> 0%<span class="id">nat</span> <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span>  (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span> <span class="id">H1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_n_n</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_eq_0">Rsqr_eq_0</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_n_Sm</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id">plus</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> (<span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#nneg_sum_n_m_sq">nneg_sum_n_m_sq</a></span>  <span class="id">a</span> 0%<span class="id">nat</span> <span class="id">n</span>); <span class="tactic">intros</span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_R0">Rplus_eq_R0</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H4</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_eq_0">Rsqr_eq_0</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.QLearn.infprod.html#series_sequences">series_sequences</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="max_prod">max_prod</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="max_prod_fun">max_prod_fun</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span>)).<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_prod_le">max_prod_le</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">k</span> <span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id">k</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt;  <br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span> &lt;= <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4754')">Proof.</div>
<div class="proofscript" id="proof4754">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_max_upper_list">fold_right_max_upper_list</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">List.in_map_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">List.in_seq</a></span>; <span class="id">lia</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_bounded1_pre_le">max_bounded1_pre_le</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">n</span> &lt;= <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4755')">Proof.</div>
<div class="proofscript" id="proof4755">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">n</span> - <span class="id">m</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">with</span> (1 + (<span class="id">n</span> - <span class="id">m</span>))%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">List.map_app</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span> + 1)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#fold_right_map">ListAdd.fold_right_map</a></span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_mult_pos">fold_right_mult_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_bounded1">max_bounded1</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">n</span> = <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4756')">Proof.</div>
<div class="proofscript" id="proof4756">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + 1)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">List.map_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right_app">List.fold_right_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> (0 + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> (0 + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>))))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_max_acc">fold_right_max_acc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHm</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span> <span class="id">_</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_bounded1_pre_le">max_bounded1_pre_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">r2</span> := <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> 0 <span class="id">n</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_l">Rmax_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lim_max_bounded1">lim_max_bounded1</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">F</span>) 0 -&gt; <span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">F</span> <span class="id">m</span> (<span class="id">n</span>+<span class="id">m</span>)%<span class="id">nat</span>) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4757')">Proof.</div>
<div class="proofscript" id="proof4757">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">F</span> (<span class="id">m</span> + <span class="id">k</span>)%<span class="id">nat</span>))).<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_bounded1">max_bounded1</a></span>; [|<span class="tactic">trivial</span>|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_shift">part_prod_n_shift</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#inf_prod_m_0">inf_prod_m_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pos_sq_bounded1">pos_sq_bounded1</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">F</span> <span class="id">n</span> &lt;= 1 -&gt; (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">n</span> &lt;= 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4758')">Proof.</div>
<div class="proofscript" id="proof4758">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq">pos_sq</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (1) <span class="kwd">with</span> (1 * 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">F</span> <span class="id">n</span>) <span class="tactic">by</span> (<span class="tactic">destruct</span> (<span class="id">F</span> <span class="id">n</span>); <span class="tactic">simpl</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lim_max_bounded1_sq">lim_max_bounded1_sq</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">F</span>) 0 -&gt; <span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">m</span> (<span class="id">n</span>+<span class="id">m</span>)%<span class="id">nat</span>) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4759')">Proof.</div>
<div class="proofscript" id="proof4759">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#lim_max_bounded1">lim_max_bounded1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_bounded1">pos_sq_bounded1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#inf_prod_sq_0">inf_prod_sq_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_prod_index_n">max_prod_index_n</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">mle</span>:(<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span> = <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4760')">Proof.</div>
<div class="proofscript" id="proof4760">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_max_in">fold_right_max_in</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)))).<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span> <span class="id">F</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_l">Rmax_l</a></span>  (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> 0 <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 1 <span class="id">m</span>)))); <span class="tactic">intros</span> <span class="id">ineq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">ineq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> 0%<span class="id">nat</span> <span class="id">n</span>); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">List.in_map_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">k</span> [<span class="id">keqq</span> <span class="id">ink</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">List.in_seq</a></span> <span class="kwd">in</span> <span class="id">ink</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_prod_n_S">max_prod_n_S</a></span> (<span class="id">a</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">a</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) = <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">a</span> <span class="id">m</span> <span class="id">n</span> * <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4761')">Proof.</div>
<div class="proofscript" id="proof4761">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">mle</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_rmax_const">fold_right_rmax_const</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">List.map_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext_in">List.map_ext_in</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_seq">List.in_seq</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="initial_max_prod_n">initial_max_prod_n</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">k</span> <span class="id">m</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;(<span class="id">k</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">a</span> <span class="id">k</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span> = (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">a</span> <span class="id">k</span> <span class="id">m</span>) * (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4762')">Proof.</div>
<div class="proofscript" id="proof4762">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id">m</span>+0)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_k_k">part_prod_n_k_k</a></span>, <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_n_S">max_prod_n_S</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_n_S">max_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_prod_index">max_prod_index</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">k</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), (<span class="id">k</span>&lt;=<span class="id">m</span>)%<span class="id">nat</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), (<span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> <span class="id">k</span> <span class="id">n</span> = <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4763')">Proof.</div>
<div class="proofscript" id="proof4763">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_index_n">max_prod_index_n</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">k</span> <span class="id">H0</span>]; <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">m</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;+ <span class="id">remember</span> (<span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>)%<span class="id">nat</span> <span class="kwd">as</span> <span class="id">nm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">n</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> + <span class="id">nm</span>)%<span class="id">nat</span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#initial_seg_prod_n">initial_seg_prod_n</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#initial_max_prod_n">initial_max_prod_n</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id">n</span>) <span class="kwd">with</span> (<span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lim_max_prod_m_0">lim_max_prod_m_0</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>):<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span> <span class="id">a</span>) 0 -&gt; <br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> <span class="id">a</span> <span class="id">m</span>) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4764')">Proof.</div>
<div class="proofscript" id="proof4764">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_index">max_prod_index</a></span> <span class="id">a</span> <span class="id">m</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">k</span> <span class="id">H0</span>]; <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_incr_n</span> <span class="kwd">with</span> (<span class="id">N</span>:=<span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">a</span> <span class="id">k</span> (<span class="id">n</span>+<span class="id">m</span>)%<span class="id">nat</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H1</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#inf_prod_n_m_0">inf_prod_n_m_0</a></span> <span class="id">a</span> <span class="id">H</span> <span class="id">k</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_incr_n</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_pos">part_prod_n_pos</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod">max_prod</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="prod_sq_bounded_1">prod_sq_bounded_1</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">r</span> <span class="id">s</span> :<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt; <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">r</span> <span class="id">s</span> &lt;= 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4765')">Proof.</div>
<div class="proofscript" id="proof4765">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_bounded1">pos_sq_bounded1</a></span> <span class="id">F</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">s</span>-<span class="id">r</span>)%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="kwd">with</span> (<span class="id">n</span>+1)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#seq_plus">seq_plus</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">List.map_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right_app">List.fold_right_app</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1) <span class="kwd">with</span> (1*1) <span class="tactic">at</span> 2 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_mult_acc">fold_right_mult_acc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#fold_right_map">ListAdd.fold_right_map</a></span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#fold_right_mult_pos">fold_right_mult_pos</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.      <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part_prod_le">part_prod_le</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">m</span> <span class="id">k</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="id">m</span> + <span class="id">k</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">m</span> <span class="id">n</span> &lt;= <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id">m</span> + <span class="id">k</span>)%<span class="id">nat</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4766')">Proof.</div>
<div class="proofscript" id="proof4766">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id">m</span> + 0)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">m</span>) <span class="tactic">by</span> <span class="id">lia</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">m</span> + <span class="id">k</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHk</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">r2</span> := <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id">m</span> + <span class="id">k</span>) <span class="id">n</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">m</span>+<span class="id">k</span>)%<span class="id">nat</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_gt_dec">le_gt_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">m</span>+<span class="id">k</span>)) <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_bounded1_pre_le">max_bounded1_pre_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_bounded1">pos_sq_bounded1</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_1">part_prod_n_1</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">m</span> + <span class="id">k</span>)%<span class="id">nat</span>)) ; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#prod_sq_bounded_1">prod_sq_bounded_1</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Dvoretsky">Dvoretsky</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Dvoretzky4_0">Dvoretzky4_0</a></span> (<span class="id">F</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> <span class="id">V</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) &lt;= (<span class="id">F</span> <span class="id">n</span>) * (<span class="id">V</span> <span class="id">n</span>) + (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) &lt;= <span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (<span class="id">sigma</span> <span class="id">k</span>)*(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) <span class="id">n</span>)) <span class="id">n</span> + <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">V</span> 0%<span class="id">nat</span>)*(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> 0 <span class="id">n</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4767')">Proof.</div>
<div class="proofscript" id="proof4767">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">sum_n</span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n_m</span>, <span class="id">Iter.iter_nat</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> 0%<span class="id">nat</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">plus</span>, <span class="id">zero</span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_Sn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n_m</span>, <span class="id">Iter.iter_nat</span> <span class="kwd">in</span> *; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">plus</span>, <span class="id">zero</span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">Iter.iter_ext</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">sigma</span> <span class="id">k</span> * <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">sigma</span> <span class="id">k</span> * <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> <span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) <span class="id">n</span>) * <span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#iter_plus_times_const">iter_plus_times_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_1">part_prod_n_1</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">r2</span> := <span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) * <span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + <span class="id">sigma</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">in</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">sigma</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))  <span class="kwd">in</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n_S">part_prod_n_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id">Iter.In_iota</span> 1 <span class="id">x</span> <span class="id">n</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - 1)%<span class="id">nat</span> <span class="kwd">with</span> <span class="id">n</span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">HH</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sum_bound_prod_A">sum_bound_prod_A</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">A</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">r</span> <span class="id">s</span> &lt;= <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">sum_n_m</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>))*(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span> &lt;=<br/>
&nbsp;&nbsp;(<span class="id">sum_n_m</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>) * <span class="id">A</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4768')">Proof.</div>
<div class="proofscript" id="proof4768">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">sum_n_m_mult_r</span> <span class="kwd">with</span> (<span class="id">a</span> := <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sum_n_m_le</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sum_bound3_max">sum_bound3_max</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>))*(<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">k</span>) <span class="id">n</span>)) <span class="id">m</span> &lt;=<br/>
&nbsp;&nbsp;(<span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>))) <span class="id">m</span>) * (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4769')">Proof.</div>
<div class="proofscript" id="proof4769">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">sum_n_mult_r</span> <span class="kwd">with</span> (<span class="id">a</span> := (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#sum_n_le_loc">sum_n_le_loc</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_le">max_prod_le</a></span>; <span class="id">lia</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Dvoretzky4_8_5">Dvoretzky4_8_5</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> <span class="id">V</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">r</span> <span class="id">s</span> &lt;= <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="id">m</span>&lt;<span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id">sum_n_m</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>) * <span class="id">A</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>) + <span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>))) <span class="id">m</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4770')">Proof.</div>
<div class="proofscript" id="proof4770">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">F1</span> <span class="id">Vsqle</span> <span class="id">mn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretzky4_0">Dvoretzky4_0</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>(<span class="id">sigma</span> <span class="id">k</span>)) (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">k</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">Vsqle</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.QLearn.infprod.html#sum_split">sum_split</a></span> <span class="kwd">with</span> (<span class="id">m0</span> := <span class="id">m</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">trivial</span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#sum_bound_prod_A">sum_bound_prod_A</a></span> <span class="id">F</span> <span class="id">sigma</span> <span class="id">A</span> <span class="id">n</span> <span class="id">m</span> <span class="id">F1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_le">max_prod_le</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#sum_bound3_max">sum_bound3_max</a></span> <span class="id">F</span> <span class="id">sigma</span> <span class="id">n</span> <span class="id">m</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>)) <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="id">lia</span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> &lt;= <span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">H1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span> <span class="id">H4</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">plus</span>, <span class="id">zero</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Dvoretzky4_8_5_1">Dvoretzky4_8_5_1</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> <span class="id">V</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">A</span> <span class="id">sigmasum</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">r</span> <span class="id">s</span> &lt;= <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) <span class="id">sigmasum</span> -&gt;   <br/>
&nbsp;&nbsp;(<span class="id">m</span>&lt;<span class="id">n</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sum_n_m</span> (<span class="kwd">fun</span> <span class="id">k</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">k</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>) * <span class="id">A</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>) + <span class="id">sigmasum</span>) * (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>).      <br/>
<div class="toggleproof" onclick="toggleDisplay('proof4771')">Proof.</div>
<div class="proofscript" id="proof4771">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretzky4_8_5">Dvoretzky4_8_5</a></span> <span class="id">F</span> <span class="id">sigma</span> <span class="id">V</span> <span class="id">n</span> <span class="id">m</span> <span class="id">A</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">sigma</span> <span class="id">k</span>)²) <span class="id">m</span> &lt;= <span class="id">sigmasum</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H1</span>' := <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_series_unique</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">sigma</span> <span class="id">k</span>)²)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_series</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">sigmasum</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#sub_sum_limit">sub_sum_limit</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>)) <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">r</span> := <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>) <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span> &lt;=  <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_le">max_prod_le</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>) <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>  <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H6</span> <span class="id">H5</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Dvoretzky4_sigma_v0_2_0">Dvoretzky4_sigma_v0_2_0</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> <span class="id">V</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">Series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>) = 0 -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">V</span> <span class="id">n</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4772')">Proof.</div>
<div class="proofscript" id="proof4772">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">Series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>))) <span class="kwd">as</span> <span class="id">sigma_sum</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#nneg_series_sq">nneg_series_sq</a></span> <span class="id">sigma</span> <span class="id">H0</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqsigma_sum</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_R0">Rplus_eq_R0</a></span> <span class="id">sigma_sum</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>)) <span class="id">H2</span> <span class="id">H3</span> <span class="id">H1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#lim_sq_0">lim_sq_0</a></span> <span class="id">sigma</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqsigma_sum</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">Series_correct</span> <span class="id">_</span> <span class="id">H0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_eq_0">Rsqr_eq_0</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">H</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>, &lt;- <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr_0">Rsqr_0</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_eq_0">Rsqr_eq_0</a></span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Dvoretzky4_A">Dvoretzky4_A</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> <span class="id">V</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">A</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>, <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_n">part_prod_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">r</span> <span class="id">s</span> &lt;= <span class="id">A</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">F</span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;   <br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>)) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4773')">Proof.</div>
<div class="proofscript" id="proof4773">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">Cauchy_ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">sigma</span> <span class="id">n</span>)²) <span class="id">H2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Cauchy_series</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#inf_prod_sq_0">inf_prod_sq_0</a></span> <span class="id">F</span> <span class="id">H1</span>); <span class="tactic">intros</span> <span class="id">lim_prod_sq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#lim_max_prod_m_0">lim_max_prod_m_0</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">lim_prod_sq</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_lim_seq_Reals</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rseries.html#Un_cv">Un_cv</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">eps</span>/(2*<span class="id">A</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> (<span class="id">eps</span>/(2*<span class="id">A</span>)) <span class="id">H6</span>) <span class="kwd">as</span> <span class="id">half_eps_div_A</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">half_eps_div_A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">Nsigma</span> <span class="id">H3</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">norm</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">abs</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H2</span>' := <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_series</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">sigma_sum</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id">sigma_sum</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> 0%<span class="id">nat</span>)) <span class="kwd">as</span> <span class="id">sigma_V0_2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">sigma_V0_2</span> 0).<br/>
&nbsp;&nbsp;- <span class="id">exists</span> (0%<span class="id">nat</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqsigma_V0_2</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_series_unique</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretzky4_sigma_v0_2_0">Dvoretzky4_sigma_v0_2_0</a></span> <span class="id">F</span> <span class="id">sigma</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr_0">Rsqr_0</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_0_r">Rminus_0_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (0 &lt;= <span class="id">sigma_V0_2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqsigma_V0_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H2</span>'' := <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_series_unique</span> <span class="kwd">in</span> <span class="id">H2</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#nneg_series_sq">nneg_series_sq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>; [|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ((<span class="id">eps</span> / 2) / <span class="id">sigma_V0_2</span>) <span class="kwd">as</span> <span class="id">part_prod_eps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">Nsigma</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_lim_seq_Reals</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rseries.html#Un_cv">Un_cv</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">part_prod_eps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">part_prod_eps</span> &gt; 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpart_prod_eps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span>  <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">trivial</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">H9</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">NH4</span> <span class="id">H4</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ( <span class="id">NH4</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">Nsigma</span>)%<span class="id">nat</span> <span class="kwd">as</span> <span class="id">NV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">NV</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_0_r">Rminus_0_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>; [| <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretzky4_8_5_1">Dvoretzky4_8_5_1</a></span> <span class="id">F</span> <span class="id">sigma</span> <span class="id">V</span> (<span class="id">n</span>-1)%<span class="id">nat</span> <span class="id">Nsigma</span> <span class="id">A</span> <span class="id">sigma_sum</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">n</span>-1)%<span class="id">nat</span>) <span class="kwd">with</span> <span class="id">n</span> <span class="tactic">by</span> <span class="id">lia</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H11</span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">Nsigma</span>) (<span class="id">n</span>-1)%<span class="id">nat</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">in</span> <span class="id">H3</span>; [|<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#nneg_sum_n_m_sq">nneg_sum_n_m_sq</a></span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> (<span class="id">n</span> - 1)%<span class="id">nat</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_0_r">Rminus_0_r</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_fun">max_prod_fun</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">Nsigma</span>) (<span class="id">n</span> - 1)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#max_prod_index_n">max_prod_index_n</a></span> (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">Nsigma</span>) (<span class="id">n</span>-1)%<span class="id">nat</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H12</span> <span class="kwd">as</span> [<span class="id">k</span> <span class="id">H12</span>]; [<span class="id">lia</span>|]; <span class="tactic">destruct</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#pos_part_prod_n">pos_part_prod_n</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">in</span> <span class="id">H4</span>; [|<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">H12</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">sigma_V0_2</span>) <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpart_prod_eps</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">sigma_V0_2</span> * (<span class="id">eps</span> / 2 / <span class="id">sigma_V0_2</span>)) <span class="kwd">with</span> (<span class="id">eps</span>/2) <span class="kwd">in</span> <span class="id">H4</span>; [|<span class="id">now</span> <span class="id">field_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> <span class="kwd">in</span> <span class="id">Heqsigma_V0_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqsigma_V0_2</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.QLearn.infprod.html#part_prod_pos">part_prod_pos</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqhalf_eps_div_A</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">A</span>) <span class="kwd">in</span> <span class="id">H3</span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">eps</span> / ( 2 * <span class="id">A</span>) * <span class="id">A</span>) <span class="kwd">with</span> (<span class="id">eps</span> / 2) <span class="kwd">in</span> <span class="id">H3</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">field_simplify</span>;<span class="tactic">trivial</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat">Rplus_lt_compat</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span> <span class="id">H4</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">eps</span>/2 + <span class="id">eps</span>/2) <span class="kwd">with</span> (<span class="id">eps</span>) <span class="kwd">in</span> <span class="id">H13</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span>  <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H11</span> <span class="id">H13</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Dvoretzky4B">Dvoretzky4B</a></span> (<span class="id">F</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">sigma</span> <span class="id">V</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">F</span> <span class="id">n</span> &lt;= 1) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) &lt;= (<span class="id"><a href="FormalML.QLearn.infprod.html#pos_sq_fun">pos_sq_fun</a></span> <span class="id">F</span>) <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#part_prod">part_prod</a></span> <span class="id">F</span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">sigma</span> <span class="id">n</span>)) -&gt;   <br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">V</span> <span class="id">n</span>)) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4774')">Proof.</div>
<div class="proofscript" id="proof4774">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretzky4_A">Dvoretzky4_A</a></span> <span class="kwd">with</span> (<span class="id">F</span> := <span class="id">F</span>) (<span class="id">sigma</span> := <span class="id">sigma</span>) (<span class="id">A</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#prod_sq_bounded_1">prod_sq_bounded_1</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Dvoretsky.Generalized_Harmonic_Series">Generalized_Harmonic_Series</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inv_bound_gt">inv_bound_gt</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;/ <span class="id">a</span>  &gt; / (<span class="id">a</span> + <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4775')">Proof.</div>
<div class="proofscript" id="proof4775">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_lt_contravar">Rinv_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">a</span> + 0) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inv_bound_sq_gt">inv_bound_sq_gt</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ <span class="id">a</span>)  &gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ (<span class="id">a</span> + <span class="id">b</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4776')">Proof.</div>
<div class="proofscript" id="proof4776">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#inv_bound_gt">inv_bound_gt</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.    <br/>
&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inv_bound_exists_lt">inv_bound_exists_lt</a></span>  (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">j</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), / (<span class="id">a</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + <span class="id">j</span>))) &lt; / (<span class="id">a</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4777')">Proof.</div>
<div class="proofscript" id="proof4777">
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id">b</span>/<span class="id">a</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span>  (<span class="id"><a href="FormalML.utils.RealAdd.html#up_pos">RealAdd.up_pos</a></span> (<span class="id">b</span>/<span class="id">a</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gt_lt">Z.gt_lt</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_lt_contravar">Rinv_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; [| <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_INR">plus_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b</span>/<span class="id">a</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id">b</span>/<span class="id">a</span>))) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#archimed">archimed</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#INR_IZR_INZ">INR_IZR_INZ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.id">Z2Nat.id</a></span>; <span class="tactic">trivial</span>; [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span>:=<span class="id">a</span>) <span class="kwd">in</span> <span class="id">H0</span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span> * (<span class="id">b</span> / <span class="id">a</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">b</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span>  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_0_compat">Rmult_gt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.    <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genharmonic_series_sq">genharmonic_series_sq</a></span> (<span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ (<span class="id">b</span> + <span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4778')">Proof.</div>
<div class="proofscript" id="proof4778">
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">ex_series_le</span> <span class="id">R_AbsRing</span>) <span class="kwd">with</span> (<span class="id">b</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> ( / (<span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))).<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_lt">Rgt_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#inv_bound_sq_gt">inv_bound_sq_gt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">H</span>) <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> <span class="id"><a href="FormalML.QLearn.sumtest.html#sum_inv_sqr_bounded">sum_inv_sqr_bounded</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_finite_lim_seq</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_series_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ <span class="id">c</span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_mult_distr">Rinv_mult_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_mult">Rsqr_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#INR_zero_lt">RealAdd.INR_zero_lt</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> (@<span class="id">ex_series_scal</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_series</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_series_Reals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Sums.html#infinite_sum_is_lim_seq">infinite_sum_is_lim_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#sum_f_R0">sum_f_R0</a></span> (<span class="kwd">fun</span> <span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; 1 / (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">i</span> + 1)²) <span class="id">n</span>)); <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Sums.html#sum_f_R0_ext">sum_f_R0_ext</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_inv">Rsqr_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#not_0_INR">not_0_INR</a></span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genharmonic_sq_lim">genharmonic_sq_lim</a></span> (<span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ (<span class="id">b</span> + <span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4779')">Proof.</div>
<div class="proofscript" id="proof4779">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ex_series_lim_0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#genharmonic_series_sq">genharmonic_series_sq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="harmonic_increasing">harmonic_increasing</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> =&gt; 1 / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="id">i</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, (<span class="id">n</span> &lt;= <span class="id">m</span>)%<span class="id">nat</span> -&gt; <span class="id">f</span> <span class="id">n</span> &lt;= <span class="id">f</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4780')">Proof.</div>
<div class="proofscript" id="proof4780">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span>) <span class="kwd">with</span> (<span class="id">n</span> + (<span class="id">m</span>-<span class="id">n</span>))%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_f_R0</span>'<span class="id">_plus_n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> (<span class="id">m</span>-<span class="id">n</span>)%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">n</span> + <span class="id">n0</span>)%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="harmonic_series">harmonic_series</a></span> :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> =&gt; 1 / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="id">i</span>) <span class="id">p_infty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4781')">Proof.</div>
<div class="proofscript" id="proof4781">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_spec</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">eventually</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">sum_f_R0</span>'<span class="id">_bound2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (2 * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>))))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (2 ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (2 * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>))))%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>)) &gt; 2*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#archimed">archimed</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (1 + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (2 * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>)))) / 2 &gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#INR_up_pos">RealAdd.INR_up_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#harmonic_increasing">harmonic_increasing</a></span> (2 ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">M</span>))) <span class="id">n</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span> <span class="id">M</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="harmonic_series2">harmonic_series2</a></span> (<span class="id">c</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> =&gt;  1 / (<span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="id">i</span>) <span class="id">p_infty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4782')">Proof.</div>
<div class="proofscript" id="proof4782">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">c</span>); <span class="tactic">intros</span> <span class="id">cpos</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="FormalML.QLearn.infprod.html#harmonic_series">harmonic_series</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_scal_l</span> <span class="kwd">with</span> (<span class="id">a</span> := /<span class="id">c</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">Rbar_mult</span> (/<span class="id">c</span>) <span class="id">p_infty</span>) <span class="kwd">with</span> <span class="id">p_infty</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span> (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; /<span class="id">c</span> * <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; 1 / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>)) <span class="id">n</span>)); <span class="tactic">intros</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">sum_f_R0</span>'<span class="id">_mult_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sum_f_R0</span>'<span class="id">_ext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_mult_distr">Rinv_mult_distr</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#not_0_INR">not_0_INR</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Rbar_mult_comm</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_Rbar_mult_unique</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_Rbar_mult_p_infty_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="harmonic_series3">harmonic_series3</a></span> (<span class="id">j</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' <span class="id">f</span> <span class="id">i</span>) <span class="id">p_infty</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">f</span> (<span class="id">n</span> + <span class="id">j</span>)%<span class="id">nat</span>) <span class="id">i</span>) <span class="id">p_infty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4783')">Proof.</div>
<div class="proofscript" id="proof4783">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_lim_seq_incr_n</span> <span class="id">_</span> <span class="id">j</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_lim_seq_minus</span> <span class="kwd">with</span> (<span class="id">v</span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">sum_f_R0</span>' <span class="id">f</span> <span class="id">j</span>) (<span class="id">l2</span> := <span class="id">sum_f_R0</span>' <span class="id">f</span> <span class="id">j</span>) (<span class="id">l1</span> := <span class="id">p_infty</span>) (<span class="id">l</span> := <span class="id">p_infty</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">is_lim_seq_ext</span>  (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">sum_f_R0</span>' <span class="id">f</span> (<span class="id">n</span> + <span class="id">j</span>) - <span class="id">sum_f_R0</span>' <span class="id">f</span> <span class="id">j</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_f_R0</span>'<span class="id">_split</span> <span class="kwd">with</span> (<span class="id">m</span> := <span class="id">j</span>); [|<span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">n</span>+<span class="id">j</span>-<span class="id">j</span>)%<span class="id">nat</span> <span class="kwd">with</span> <span class="id">n</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">is_lim_seq_const</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">is_Rbar_minus</span>, <span class="id">is_Rbar_plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genharmon">genharmon</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), / ((<span class="id">a</span>+<span class="id">b</span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) &lt;= /(<span class="id">a</span>*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) + <span class="id">b</span>) &lt; /(<span class="id">a</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4784')">Proof.</div>
<div class="proofscript" id="proof4784">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Rinv_le_contravar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; [ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">b</span>) <span class="kwd">with</span> (<span class="id">b</span> * 1) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">left</span>;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_O_plus_INR">S_O_plus_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> 1 <span class="kwd">with</span> (1 + 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos_INR">pos_INR</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (0 &lt; <span class="id">a</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_lt_contravar">Rinv_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; [<span class="tactic">trivial</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">replace</span> (<span class="id">a</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">with</span> (<span class="id">a</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + 0) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genharmon_sq">genharmon_sq</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ ((<span class="id">a</span>+<span class="id">b</span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ (<span class="id">a</span>*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) + <span class="id">b</span>)) &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (/ (<span class="id">a</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4785')">Proof.</div>
<div class="proofscript" id="proof4785">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#genharmon">genharmon</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_0_INR">lt_0_INR</a></span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; (<span class="id">a</span> + <span class="id">b</span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (0 &lt; <span class="id">a</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; [ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>| <span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_1">Rsqr_incr_1</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">trivial</span>.        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | <span class="tactic">trivial</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genharmonic_series">genharmonic_series</a></span> (<span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> =&gt; 1 / (<span class="id">b</span> + <span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="id">i</span>) <span class="id">p_infty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4786')">Proof.</div>
<div class="proofscript" id="proof4786">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">c</span>); <span class="tactic">intros</span> <span class="id">cpos</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#inv_bound_exists_lt">inv_bound_exists_lt</a></span> <span class="id">c</span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">j</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">is_lim_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filterlim_ge_p_infty</span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; 1 / (<span class="id">c</span> *<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">n0</span>) + <span class="id">j</span>))) <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">eventually</span>;  <span class="id">exists</span> (0%<span class="id">nat</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sum_f_R0</span>'<span class="id">_le_f</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#harmonic_series2">harmonic_series2</a></span> <span class="id">c</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#harmonic_series3">harmonic_series3</a></span> <span class="id">j</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; 1 / (<span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="id">H0</span>); <span class="tactic">trivial</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genharmonic_series2">genharmonic_series2</a></span> (<span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_lim_seq</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> =&gt; 1 / (<span class="id">b</span> + <span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="id">i</span>) <span class="id">p_infty</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4787')">Proof.</div>
<div class="proofscript" id="proof4787">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#genharmon">genharmon</a></span> <span class="id">c</span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">c</span> + <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#harmonic_series2">harmonic_series2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">H0</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">is_lim_seq</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filterlim_ge_p_infty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">f</span> := (<span class="kwd">fun</span> <span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_f_R0</span>' (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; 1 / ({| <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> := <span class="id">c</span> + <span class="id">b</span>; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> := <span class="id">H0</span> |} * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="id">i</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">eventually</span>;  <span class="id">exists</span> (0%<span class="id">nat</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sum_f_R0</span>'<span class="id">_le_f</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">i</span>); <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">b</span> + <span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">i</span>)) <span class="kwd">with</span> (<span class="id">c</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">i</span>) + <span class="id">b</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretsky.Generalized_Harmonic_Series">Generalized_Harmonic_Series</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_0">Robbins_Monro_0</a></span> (<span class="id">u</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">A</span> <span class="id">B</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">u</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">u</span> &lt;&gt; 0 -&gt; <span class="id">A</span> &lt;= <span class="id">g</span> <span class="id">u</span> &lt;= <span class="id">B</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">u</span> &lt;&gt; 0) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (1 - <span class="id">a</span> <span class="id">n</span> * <span class="id">g</span> <span class="id">u</span>) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (1-<span class="id">A</span>*(<span class="id">a</span> <span class="id">n</span>)) (<span class="id">B</span>*(<span class="id">a</span> <span class="id">n</span>) - 1).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4788')">Proof.</div>
<div class="proofscript" id="proof4788">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">u</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">B</span>*(<span class="id">a</span> <span class="id">n</span>) - 1) <span class="kwd">with</span> (- (1 - <span class="id">B</span>*<span class="id">a</span> <span class="id">n</span>)) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rcomplements.Rabs_le_between_Rmax</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; <span class="tactic">trivial</span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_1">Robbins_Monro_1</a></span> (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">A</span> <span class="id">B</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">u</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">u</span> &lt;&gt; 0 -&gt; <span class="id">A</span> &lt;= <span class="id">f</span>(<span class="id">u</span>)/<span class="id">u</span> &lt;= <span class="id">B</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id">r</span> <span class="id">n</span> &lt;&gt; 0 -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">r</span> <span class="id">n</span> - <span class="id">a</span> <span class="id">n</span> * <span class="id">f</span> (<span class="id">r</span> <span class="id">n</span>)) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">r</span> <span class="id">n</span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (1-<span class="id">A</span>*(<span class="id">a</span> <span class="id">n</span>)) (<span class="id">B</span>*(<span class="id">a</span> <span class="id">n</span>) - 1).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4789')">Proof.</div>
<div class="proofscript" id="proof4789">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">r</span> <span class="id">n</span> - <span class="id">a</span> <span class="id">n</span> * <span class="id">f</span> (<span class="id">r</span> <span class="id">n</span>)) <span class="kwd">with</span> ((<span class="id">r</span> <span class="id">n</span>)*(1 - <span class="id">a</span> <span class="id">n</span> * (<span class="id">f</span>(<span class="id">r</span> <span class="id">n</span>)/(<span class="id">r</span> <span class="id">n</span>)))).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#Robbins_Monro_0">Robbins_Monro_0</a></span> <span class="kwd">with</span> (<span class="id">g</span> := <span class="kwd">fun</span> <span class="id">u</span> =&gt; <span class="id">f</span> <span class="id">u</span> / <span class="id">u</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="id">field</span>.    <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_1b">Robbins_Monro_1b</a></span> (<span class="id">a</span> <span class="id">A</span> <span class="id">B</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt; 2/(<span class="id">A</span> + <span class="id">B</span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (1-<span class="id">A</span>*<span class="id">a</span>) (<span class="id">B</span>*<span class="id">a</span>-1) = 1-<span class="id">A</span>*<span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4790')">Proof.</div>
<div class="proofscript" id="proof4790">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">A</span> + <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">a</span> * (<span class="id">A</span> + <span class="id">B</span>) * / (<span class="id">A</span> + <span class="id">B</span>)) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">in</span> <span class="id">H</span>; [<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_derive_Rsqr">is_derive_Rsqr</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">x</span> <span class="id">df</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">f</span> <span class="id">x</span> <span class="id">df</span> -&gt; <span class="id">is_derive</span> (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">f</span> <span class="id">x0</span>)) <span class="id">x</span> (2 * (<span class="id">f</span> <span class="id">x</span>) * <span class="id">df</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4791')">Proof.</div>
<div class="proofscript" id="proof4791">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_derive_ext</span> (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; (<span class="id">f</span> <span class="id">x0</span>) * (<span class="id">f</span> <span class="id">x0</span>))); [<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> |].<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">f</span> <span class="id">x</span> * <span class="id">df</span>) <span class="kwd">with</span> ((<span class="id">df</span> * <span class="id">f</span> <span class="id">x</span>) + (<span class="id">f</span> <span class="id">x</span> * <span class="id">df</span>)) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_derive_mult</span> <span class="id">R_AbsRing</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_2a">Robbins_Monro_2a</a></span> (<span class="id">A</span> <span class="id">sigma</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">a0</span> <span class="id">V</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="kwd">fun</span> <span class="id">a</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (1-<span class="id">A</span>*<span class="id">a</span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">V</span>)) + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">a</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">sigma</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">f</span> <span class="id">a0</span> ((2 * (1-<span class="id">A</span>*<span class="id">a0</span>) * (-<span class="id">A</span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">V</span>)) + (2 * <span class="id">a0</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">sigma</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4792')">Proof.</div>
<div class="proofscript" id="proof4792">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_derive_plus</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (@<span class="id">is_derive_scal_l</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#is_derive_Rsqr">is_derive_Rsqr</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (1 - <span class="id">A</span> * <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (-<span class="id">A</span>) <span class="kwd">with</span> (0 - <span class="id">A</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_derive_minus</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> (@<span class="id">is_derive_const</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">A</span>) <span class="kwd">with</span> (<span class="id">A</span>*1) <span class="tactic">at</span> 2 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_derive_scal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_derive_id</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (@<span class="id">is_derive_scal_l</span> <span class="id">R_AbsRing</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">a0</span>) <span class="kwd">with</span> (2 * <span class="id">a0</span> * 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.QLearn.infprod.html#is_derive_Rsqr">is_derive_Rsqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_derive_id</span> <span class="id">R_AbsRing</span>).<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_2b">Robbins_Monro_2b</a></span> (<span class="id">A</span> <span class="id">sigma</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">V</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">a0</span> := (<span class="id">A</span> * <span class="id">V</span>^2) / (<span class="id">sigma</span>^2 + <span class="id">A</span>^2 * <span class="id">V</span>^2) <span class="kwd">in</span><br/>
&nbsp;&nbsp;(2 * (1-<span class="id">A</span>*<span class="id">a0</span>) * (-<span class="id">A</span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">V</span>)) + (2 * <span class="id">a0</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">sigma</span>)) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4793')">Proof.</div>
<div class="proofscript" id="proof4793">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a0</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">field</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">sigma</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_le_0_compat">Rplus_lt_le_0_compat</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> ((<span class="id">A</span> * <span class="id">V</span>)^2) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">A</span>*<span class="id">V</span>)) <span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_2c">Robbins_Monro_2c</a></span> (<span class="id">A</span> <span class="id">sigma</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">V</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="kwd">fun</span> <span class="id">a</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (1-<span class="id">A</span>*<span class="id">a</span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">V</span>)) + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">a</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">sigma</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">a0</span> := (<span class="id">A</span> * <span class="id">V</span>^2) / (<span class="id">sigma</span>^2 + <span class="id">A</span>^2 * <span class="id">V</span>^2) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">f</span> <span class="id">a0</span> 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4794')">Proof.</div>
<div class="proofscript" id="proof4794">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#Robbins_Monro_2a">Robbins_Monro_2a</a></span> <span class="id">A</span> <span class="id">sigma</span> <span class="id">a0</span> <span class="id">V</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.QLearn.infprod.html#Robbins_Monro_2b">Robbins_Monro_2b</a></span> <span class="id">A</span> <span class="id">sigma</span> <span class="id">V</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Robbins_Monro_2d">Robbins_Monro_2d</a></span> (<span class="id">A</span> <span class="id">sigma</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) (<span class="id">V</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="kwd">fun</span> <span class="id">a</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (1-<span class="id">A</span>*<span class="id">a</span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">V</span>)) + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">a</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">sigma</span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">a0</span> := (<span class="id">A</span> * <span class="id">V</span>^2) / (<span class="id">sigma</span>^2 + <span class="id">A</span>^2 * <span class="id">V</span>^2) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">a0</span> = <span class="id">sigma</span>^2 * <span class="id">V</span>^2 / (<span class="id">sigma</span>^2 + (<span class="id">A</span>*<span class="id">V</span>)^2).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4795')">Proof.</div>
<div class="proofscript" id="proof4795">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">f</span>; <span class="tactic">subst</span> <span class="id">a0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">field</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_le_0_compat">Rplus_lt_le_0_compat</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id">A</span> * <span class="id">V</span> * (<span class="id">A</span> * <span class="id">V</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">A</span> * <span class="id">V</span>)) <span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.QLearn.infprod.html#Dvoretsky">Dvoretsky</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
