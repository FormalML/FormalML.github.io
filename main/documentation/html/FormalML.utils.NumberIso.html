
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.utils.NumberIso</title>
<meta name="description" content="Documentation of Coq module FormalML.utils.NumberIso" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.utils.NumberIso</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html">BinNums</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html">BinNat</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Nat.html">Nat</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span> <span class="id"><a href="FormalML.utils.Isomorphism.html">Isomorphism</a></span> <span class="id"><a href="FormalML.utils.PairEncoding.html">PairEncoding</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith.html">QArith</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qcanon.html">Qcanon</a></span>.<br/>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="positive_N_iso">positive_N_iso</a></span> : <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism">Isomorphism</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#N">N</a></span><br/>
&nbsp;&nbsp;:= {<span class="id"><a href="FormalML.utils.Isomorphism.html#iso_f">iso_f</a></span> <span class="id">n</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.pred_N">Pos.pred_N</a></span> <span class="id">n</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Isomorphism.html#iso_b">iso_b</a></span> <span class="id">n</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.succ_pos">N.succ_pos</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1486')">Next Obligation.</div>
<div class="proofscript" id="proof1486">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.pos_pred_succ">N.pos_pred_succ</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1487')">Next Obligation.</div>
<div class="proofscript" id="proof1487">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ_pred_double">Pos.succ_pred_double</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Z_N_iso">Z_N_iso</a></span> : <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism">Isomorphism</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#N">N</a></span><br/>
&nbsp;&nbsp;:= { <span class="id"><a href="FormalML.utils.Isomorphism.html#iso_f">iso_f</a></span> <span class="id">n</span> := (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_ge_lt_dec">Z_ge_lt_dec</a></span> <span class="id">n</span> 0 <span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_N">Z.to_N</a></span> <span class="id">n</span>)*2 <span class="kwd">else</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_N">Z.to_N</a></span> (- <span class="id">n</span>))*2-1)%<span class="id">N</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Isomorphism.html#iso_b">iso_b</a></span> <span class="id">n</span> := <span class="kwd">if</span> (<span class="id">n</span> <span class="id">mod</span> 2)%<span class="id">N</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_N">Z.of_N</a></span> (<span class="id">n</span> / 2)%<span class="id">N</span> <span class="kwd">else</span> (- (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_N">Z.of_N</a></span> ((<span class="id">n</span>+1) / 2)%<span class="id">N</span>))%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1488')">Next Obligation.</div>
<div class="proofscript" id="proof1488">
&nbsp;&nbsp;<span class="id">case_eq</span> ((<span class="id">b</span> <span class="id">mod</span> 2)%<span class="id">N</span>); [<span class="tactic">intros</span> <span class="id">modeq</span> | <span class="tactic">intros</span> ? <span class="id">modeq</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.div_mod">N.div_mod</a></span> <span class="id">b</span> 2); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ( <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_ge_lt_dec">Z_ge_lt_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_N">Z.of_N</a></span> (<span class="id">b</span> / 2)) 0); <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">modeq2</span>:(<span class="id">b</span> <span class="id">mod</span> 2 = 1)%<span class="id">N</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.mod_upper_bound">N.mod_upper_bound</a></span> <span class="id">b</span> 2); <span class="id">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">modeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.div_mod">N.div_mod</a></span> <span class="id">b</span> 2); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">modeq2</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; [| <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (  <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_ge_lt_dec">Z_ge_lt_dec</a></span> (- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_N">Z.of_N</a></span> ((<span class="id">b</span> + 1) / 2)) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#N2Z.is_nonneg">N2Z.is_nonneg</a></span> ((<span class="id">b</span>+1) / 2)); <span class="tactic">intros</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_N">Z.of_N</a></span> ((<span class="id">b</span>+1)  / 2)%<span class="id">N</span> = 0%<span class="id">Z</span>)) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="tactic">f_equal</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_N">Z.to_N</a></span> <span class="id">H</span>); <span class="tactic">intros</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#N2Z.id">N2Z.id</a></span> <span class="kwd">in</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2N.inj_0">Z2N.inj_0</a></span> <span class="kwd">in</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.div_str_pos">N.div_str_pos</a></span> (<span class="id">b</span>+1) 2); <span class="tactic">intros</span> <span class="id">HH4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.opp_involutive">Z.opp_involutive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#N2Z.id">N2Z.id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">modeq3</span>:((<span class="id">b</span>+1) <span class="id">mod</span> 2 = 0)%<span class="id">N</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.add_mod_idemp_l">N.add_mod_idemp_l</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">modeq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.mod_same">N.mod_same</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.div_mod">N.div_mod</a></span> (<span class="id">b</span>+1) 2); <span class="tactic">intros</span> <span class="id">HH5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1489')">Next Obligation.</div>
<div class="proofscript" id="proof1489">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_ge_lt_dec">Z_ge_lt_dec</a></span> <span class="id">a</span> 0).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.mod_mul">N.mod_mul</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.div_mul">N.div_mul</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2N.id">Z2N.id</a></span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id">match_case</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.mod_divide">N.mod_divide</a></span> <span class="kwd">in</span> <span class="id">H</span>; [| <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">k</span> <span class="id">HH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.sub_add">N.sub_add</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.div_mul">N.div_mul</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2N.id">Z2N.id</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.opp_involutive">Z.opp_involutive</a></span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Q_Zpos_iso">Q_Zpos_iso</a></span> : <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism">Isomorphism</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Q">Q</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>)<br/>
&nbsp;&nbsp;:= { <span class="id"><a href="FormalML.utils.Isomorphism.html#iso_f">iso_f</a></span> <span class="id">q</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qnum">Qnum</a></span> <span class="id">q</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qden">Qden</a></span> <span class="id">q</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Isomorphism.html#iso_b">iso_b</a></span> '(<span class="id">z</span>,<span class="id">p</span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qmake">Qmake</a></span> <span class="id">z</span> <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1490')">Next Obligation.</div>
<div class="proofscript" id="proof1490">
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> <span class="id">a</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Q_N_iso">Q_N_iso</a></span> : <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism">Isomorphism</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Q">Q</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#N">N</a></span><br/>
&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism_trans">Isomorphism_trans</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.NumberIso.html#Q_Zpos_iso">Q_Zpos_iso</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism_trans">Isomorphism_trans</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism_prod">Isomorphism_prod</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.NumberIso.html#Z_N_iso">Z_N_iso</a></span> <span class="id"><a href="FormalML.utils.NumberIso.html#positive_N_iso">positive_N_iso</a></span>) <span class="id"><a href="FormalML.utils.PairEncoding.html#N_pair_encoder">N_pair_encoder</a></span>).<br/>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Q_nat_iso">Q_nat_iso</a></span> : <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism">Isomorphism</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Q">Q</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span><br/>
&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism_trans">Isomorphism_trans</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.NumberIso.html#Q_N_iso">Q_N_iso</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism_symm">Isomorphism_symm</a></span> <span class="id"><a href="FormalML.utils.Isomorphism.html#nat_to_N_iso">nat_to_N_iso</a></span>).<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Qc_Qpos_iso">Qc_Qpos_iso</a></span> : <span class="id"><a href="FormalML.utils.Isomorphism.html#Isomorphism">Isomorphism</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Q">Q</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qcanon.html#Qc">Qc</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>)<br/>
&nbsp;&nbsp;:= {<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Isomorphism.html#iso_f">iso_f</a></span> <span class="id">q</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qcanon.html#Q2Qc">Q2Qc</a></span> <span class="id">q</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_pos">Z.to_pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gcd">Z.gcd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qnum">Qnum</a></span> <span class="id">q</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qden">Qden</a></span> <span class="id">q</span>))));<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Isomorphism.html#iso_b">iso_b</a></span> '(<span class="id">qc</span>,<span class="id">m</span>) := ((<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qcanon.html#this">this</a></span> <span class="id">qc</span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span> # <span class="id">m</span>))%<span class="id">Q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1491')">Next Obligation.</div>
<div class="proofscript" id="proof1491">
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qcanon.html#Qc_is_canon">Qc_is_canon</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qeq">Qeq</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> ( (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd">Z.ggcd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qnum">Qnum</a></span> <span class="id">q</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qden">Qden</a></span> <span class="id">q</span> * <span class="id">p</span>)))); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd_correct_divisors">Z.ggcd_correct_divisors</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qnum">Qnum</a></span> <span class="id">q</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qden">Qden</a></span> <span class="id">q</span> * <span class="id">p</span>))); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">eqq1</span> <span class="id">eqq2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">this</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.inj_mul">Pos2Z.inj_mul</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eqq12</span>:(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span> * (<span class="id">Qnum</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>)%<span class="id">Z</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span> * (<span class="id">z</span> * <span class="id">z0</span>)%<span class="id">Z</span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">eqq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eqq22</span>:(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span> * (<span class="id">Qnum</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>)%<span class="id">Z</span> = <span class="id">Qnum</span> * (<span class="id">z</span> * <span class="id">z1</span>)%<span class="id">Z</span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">eqq2</span>; <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq12</span> <span class="kwd">in</span> <span class="id">eqq22</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eqq3</span>:( <span class="id">z</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span> * <span class="id">z0</span>) = <span class="id">z</span> * (<span class="id">Qnum</span> * <span class="id">z1</span>))%<span class="id">Z</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z2Pos.id">Z2Pos.id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_cancel_l">Z.mul_cancel_l</a></span> <span class="kwd">in</span> <span class="id">eqq3</span>; [ | <span class="id">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.inj_mul">Pos2Z.inj_mul</a></span> <span class="kwd">in</span> <span class="id">eqq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.pos_is_pos">Pos2Z.pos_is_pos</a></span> (<span class="id">Qden</span> * <span class="id">p</span>)); <span class="tactic">intros</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span> <span class="kwd">in</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd_gcd">Z.ggcd_gcd</a></span> (<span class="id">Qnum</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id">Qden</span> * <span class="id">p</span>))); <span class="tactic">intros</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">HH2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gcd_nonneg">Z.gcd_nonneg</a></span> (<span class="id">Qnum</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id">Qden</span> * <span class="id">p</span>))); <span class="tactic">intros</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">HH2</span> <span class="kwd">in</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HH4</span>:(<span class="id">z</span> = 0 \/ 0 &lt; <span class="id">z</span>)%<span class="id">Z</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HH4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_gt_0_lt_0_reg_r">Zmult_gt_0_lt_0_reg_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_gt">Z.lt_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.inj_mul">Pos2Z.inj_mul</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gcd_mul_mono_r">Z.gcd_mul_mono_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">q</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qcanon.html#Qred_iff">Qred_iff</a></span> <span class="kwd">in</span> <span class="id">canon</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">canon</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1492')">Next Obligation.</div>
<div class="proofscript" id="proof1492">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qreduction.html#Qred_correct">Qred_correct</a></span> <span class="id">a</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd_gcd">Z.ggcd_gcd</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.Qreduction.html#Qred">Qred</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd_correct_divisors">Z.ggcd_correct_divisors</a></span> <span class="id">Qnum</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span>)).<br/>
&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd">Z.ggcd</a></span> <span class="id">Qnum</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">z</span> [<span class="id">p</span> <span class="id">q</span>] <span class="id">eqq</span> [<span class="id">HH1</span> <span class="id">HH2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>, <span class="id">HH1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qmult">Qmult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">zn</span>:(<span class="id">z</span> &lt;&gt; 0)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">zpos</span>:(<span class="id">z</span> &gt; 0)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gcd_nonneg">Z.gcd_nonneg</a></span> <span class="id">Qnum</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">Qden</span>)); <span class="tactic">intros</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ggcd_gcd">Z.ggcd_gcd</a></span> <span class="kwd">in</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">HH3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">qpos</span>:(<span class="id">q</span>&gt;0)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.is_pos">Pos2Z.is_pos</a></span> <span class="id">Qden</span>); <span class="tactic">intros</span> <span class="id">HH3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_gt">Z.lt_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_0_reg_r">Zmult_lt_0_reg_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gt_lt">Z.gt_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">zpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lia</span>.<br/>
&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z2Pos.id">Z2Pos.id</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;+ <span class="id">lia</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z2Pos.inj_mul">Z2Pos.inj_mul</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.inj_pos">Pos2Z.inj_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z2Pos.id">Z2Pos.id</a></span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
