
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.utils.RealAdd</title>
<meta name="description" content="Documentation of Coq module FormalML.utils.RealAdd" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.utils.RealAdd</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Basics.html">Program.Basics</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbase.html">Coq.Reals.Rbase</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html">Coq.Reals.RList</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html">Coq.Reals.Rfunctions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rprod.html">Coq.Reals.Rprod</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.ROrderedType.html">Coq.Reals.ROrderedType</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis_reg.html">Ranalysis_reg</a></span> <span class="id"><a href="FormalML.utils.Finite.html">utils.Finite</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coquelicot.Hierarchy</span> <span class="id">Coquelicot.PSeries</span> <span class="id">Coquelicot.Series</span> <span class="id">Coquelicot.ElemFct</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coquelicot.Lim_seq</span> <span class="id">Coquelicot.Lub</span> <span class="id">Coquelicot.Rbar</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Integration.html">Reals.Integration</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html">Rtrigo_def</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="FormalML.utils.Finite.html">Finite</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span> <span class="id"><a href="FormalML.utils.ListAdd.html">ListAdd</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html">Relation_Definitions</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html">Sorted</a></span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="id">Bullet</span> <span class="id">Behavior</span> "<span class="kwd">Strict</span> <span class="id">Subproofs</span>".<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="INR_nzero">INR_nzero</a></span> {<span class="id">n</span>} :<br/>
&nbsp;&nbsp;(<span class="id">n</span> &gt; 0)%<span class="id">nat</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span> &lt;&gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1680')">Proof.</div>
<div class="proofscript" id="proof1680">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos_INR">pos_INR</a></span> <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="INR_nzero_eq">INR_nzero_eq</a></span> {<span class="id">n</span>} :<br/>
&nbsp;&nbsp;(~ <span class="id">n</span> = 0)%<span class="id">nat</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span> &lt;&gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1681')">Proof.</div>
<div class="proofscript" id="proof1681">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos_INR">pos_INR</a></span> <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="INR_zero_lt">INR_zero_lt</a></span> {<span class="id">n</span>} :<br/>
&nbsp;&nbsp;(<span class="id">n</span> &gt; 0)%<span class="id">nat</span> -&gt; 0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1682')">Proof.</div>
<div class="proofscript" id="proof1682">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;- <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos_INR">pos_INR</a></span> <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rinv_pos">Rinv_pos</a></span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;0 &lt; <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;0 &lt; / <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1683')">Proof.</div>
<div class="proofscript" id="proof1683">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> ( / <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdiv_lt_0_compat">Rdiv_lt_0_compat</a></span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pos_Rl_nth">pos_Rl_nth</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html#pos_Rl">pos_Rl</a></span> <span class="id">l</span> <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">n</span> <span class="id">l</span> 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1684')">Proof.</div>
<div class="proofscript" id="proof1684">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pos_Rl_nth">pos_Rl_nth</a></span>  : <span class="id">R_iso</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rlt_le_sub">Rlt_le_sub</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#subrelation">subrelation</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rle">Rle</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1685')">Proof.</div>
<div class="proofscript" id="proof1685">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_bucket_nth_finds_Rle">find_bucket_nth_finds_Rle</a></span> <span class="id">needle</span> <span class="id">l</span> <span class="id">idx</span> <span class="id">d1</span> <span class="id">d2</span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rle">Rle</a></span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">idx</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">idx</span> <span class="id">l</span> <span class="id">d1</span> &lt; <span class="id">needle</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">needle</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">idx</span>) <span class="id">l</span> <span class="id">d2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.ListAdd.html#find_bucket">find_bucket</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">needle</span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id">idx</span> <span class="id">l</span> <span class="id">d1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">idx</span>) <span class="id">l</span> <span class="id">d2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1686')">Proof.</div>
<div class="proofscript" id="proof1686">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#find_bucket_nth_finds">find_bucket_nth_finds</a></span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;; <span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_bucket_bounded_Rle_exists">find_bucket_bounded_Rle_exists</a></span> {<span class="id">a</span> <span class="id">b</span> <span class="id">needle</span>} :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">needle</span> &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">lower</span> <span class="id">upper</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.ListAdd.html#find_bucket">find_bucket</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">needle</span> (<span class="id">a</span>::<span class="id">l</span>++[<span class="id">b</span>]) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">lower</span>, <span class="id">upper</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1687')">Proof.</div>
<div class="proofscript" id="proof1687">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#find_bucket_bounded_le_exists">find_bucket_bounded_le_exists</a></span>; <span class="tactic">intros</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="telescope_plus_fold_right_sub_seq">telescope_plus_fold_right_sub_seq</a></span> <span class="id">f</span> <span class="id">s</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">x</span>)) -  (<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id">x</span>+1)))) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> <span class="id">s</span> <span class="id">n</span>)) = (<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">s</span>)) - (<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id">s</span>+<span class="id">n</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1688')">Proof.</div>
<div class="proofscript" id="proof1688">
&nbsp;&nbsp;<span class="id">Opaque</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">replace</span> (<span class="id">s</span>+0)%<span class="id">nat</span> <span class="kwd">with</span> <span class="id">s</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHn</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span> <span class="kwd">in</span> *.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id">s</span> + <span class="id">n</span>))%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id">s</span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))%<span class="id">nat</span> <span class="kwd">in</span> <span class="id">IHn</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">s</span>+1)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">s</span>) <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Transparent</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_Rplus_mult_const">fold_right_Rplus_mult_const</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">c</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">A</span> =&gt; <span class="id">f</span> <span class="id">x</span> * <span class="id">c</span>) <span class="id">l</span>) =<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">A</span> =&gt; <span class="id">f</span> <span class="id">x</span>) <span class="id">l</span>))*<span class="id">c</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1689')">Proof.</div>
<div class="proofscript" id="proof1689">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bounded_dist_le">bounded_dist_le</a></span>  <span class="id">x</span> <span class="id">lower</span> <span class="id">upper</span> :<br/>
&nbsp;&nbsp;<span class="id">lower</span> &lt;= <span class="id">x</span> &lt;= <span class="id">upper</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> <span class="id">x</span> <span class="id">upper</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> <span class="id">lower</span> <span class="id">upper</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1690')">Proof.</div>
<div class="proofscript" id="proof1690">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist_sym">R_dist_sym</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist_sym">R_dist_sym</a></span> <span class="id">lower</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bounded_dist_le_P2">bounded_dist_le_P2</a></span>  <span class="id">x</span> <span class="id">lower</span> <span class="id">upper</span> :<br/>
&nbsp;&nbsp;<span class="id">lower</span> &lt;= <span class="id">x</span> &lt;= <span class="id">upper</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> <span class="id">x</span> <span class="id">lower</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> <span class="id">upper</span> <span class="id">lower</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1691')">Proof.</div>
<div class="proofscript" id="proof1691">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="interval_increasing">interval_increasing</a></span> <span class="id">f</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id">a</span> &lt;= <span class="id">x</span> -&gt; <span class="id">y</span> &lt;= <span class="id">b</span> -&gt; <span class="id">x</span>&lt;=<span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">f</span> <span class="id">y</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="interval_decreasing">interval_decreasing</a></span> <span class="id">f</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id">a</span> &lt;= <span class="id">x</span> -&gt; <span class="id">y</span> &lt;= <span class="id">b</span> -&gt; <span class="id">x</span>&lt;=<span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">y</span> &lt;= <span class="id">f</span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bounded_increasing_dist_le">bounded_increasing_dist_le</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">x</span> <span class="id">lower</span> <span class="id">upper</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#interval_increasing">interval_increasing</a></span> <span class="id">f</span> <span class="id">lower</span> <span class="id">upper</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">lower</span> &lt;= <span class="id">x</span> &lt;= <span class="id">upper</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">f</span> <span class="id">upper</span>) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id">f</span> <span class="id">lower</span>) (<span class="id">f</span> <span class="id">upper</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1692')">Proof.</div>
<div class="proofscript" id="proof1692">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">df</span> <span class="id">xin</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#bounded_dist_le">bounded_dist_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xin</span> <span class="kwd">as</span> [<span class="id">ltx</span> <span class="id">gtx</span>].<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">df</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id">df</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.  <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bounded_decreasing_dist_le">bounded_decreasing_dist_le</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">x</span> <span class="id">lower</span> <span class="id">upper</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> <span class="id">f</span> <span class="id">lower</span> <span class="id">upper</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">lower</span> &lt;= <span class="id">x</span> &lt;= <span class="id">upper</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">f</span> <span class="id">upper</span>) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id">f</span> <span class="id">lower</span>) (<span class="id">f</span> <span class="id">upper</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1693')">Proof.</div>
<div class="proofscript" id="proof1693">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">df</span> <span class="id">xin</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#bounded_dist_le_P2">bounded_dist_le_P2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">xin</span> <span class="kwd">as</span> [<span class="id">ltx</span> <span class="id">gtx</span>].<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">df</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id">df</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subinterval_increasing">subinterval_increasing</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">b</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#interval_increasing">interval_increasing</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#interval_increasing">interval_increasing</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1694')">Proof.</div>
<div class="proofscript" id="proof1694">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">y0</span> &lt;= <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">a</span> &lt;= <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="subinterval_decreasing">subinterval_decreasing</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">y</span> &lt;= <span class="id">b</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1695')">Proof.</div>
<div class="proofscript" id="proof1695">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">y0</span> &lt;= <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">a</span> &lt;= <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="increasing_decreasing_opp">increasing_decreasing_opp</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#interval_increasing">interval_increasing</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; -<span class="id">f</span> <span class="id">x</span>) <span class="id">a</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1696')">Proof.</div>
<div class="proofscript" id="proof1696">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#interval_increasing">interval_increasing</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Int_SF_alt">Int_SF_alt</a></span> <span class="id">l</span> <span class="id">k</span><br/>
&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>,<span class="id">y</span>) =&gt; <span class="id">x</span> * <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>,<span class="id">y</span>) =&gt; <span class="id">y</span> - <span class="id">x</span>) (<span class="id"><a href="FormalML.utils.ListAdd.html#adjacent_pairs">adjacent_pairs</a></span> <span class="id">k</span>)))).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Int_SF_alt_eq">Int_SF_alt_eq</a></span> <span class="id">l</span> <span class="id">k</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#Int_SF">Int_SF</a></span> <span class="id">l</span> <span class="id">k</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#Int_SF_alt">Int_SF_alt</a></span> <span class="id">l</span> <span class="id">k</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1697')">Proof.</div>
<div class="proofscript" id="proof1697">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Int_SF_alt">Int_SF_alt</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="up_IZR">up_IZR</a></span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">n</span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">n</span>)%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1698')">Proof.</div>
<div class="proofscript" id="proof1698">
&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_Ifp.html#tech_up">tech_up</a></span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#succ_IZR">succ_IZR</a></span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="up0">up0</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> 0 = 1%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1699')">Proof.</div>
<div class="proofscript" id="proof1699">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#up_IZR">up_IZR</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="up_pos">up_pos</a></span> (<span class="id">r</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">r</span>&gt;0 -&gt; ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> <span class="id">r</span>) &gt; 0)%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1700')">Proof.</div>
<div class="proofscript" id="proof1700">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#archimed">archimed</a></span> <span class="id">r</span>) <span class="kwd">as</span> [<span class="id">lb</span> <span class="id">ub</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> <span class="id">r</span>) &gt; 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="up_nonneg">up_nonneg</a></span> (<span class="id">r</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">r</span>&gt;=0 -&gt; ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> <span class="id">r</span>) &gt;= 0)%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1701')">Proof.</div>
<div class="proofscript" id="proof1701">
&nbsp;&nbsp;<span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ge">Z.ge</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#up_pos">up_pos</a></span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#up0">up0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="INR_up_pos">INR_up_pos</a></span> <span class="id">r</span> :<br/>
&nbsp;&nbsp;<span class="id">r</span> &gt;= 0 -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> <span class="id">r</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> <span class="id">r</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1702')">Proof.</div>
<div class="proofscript" id="proof1702">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#INR_IZR_INZ">INR_IZR_INZ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.id">Z2Nat.id</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#up_nonneg">up_nonneg</a></span> <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frac_max_frac_le">frac_max_frac_le</a></span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;1 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">x</span> / (<span class="id">x</span> + 1) &lt;= <span class="id">y</span> / (<span class="id">y</span> + 1).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1703')">Proof.</div>
<div class="proofscript" id="proof1703">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (1 &lt;= <span class="id">x</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">x</span> * (<span class="id">y</span> + 1) &lt;= <span class="id">y</span> * (<span class="id">x</span> + 1)).<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> (/ (<span class="id">x</span>+1))) <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r_simpl_l">Rinv_r_simpl_l</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> (/ (<span class="id">y</span>+1))) <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r_simpl_m">Rinv_r_simpl_m</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="list_sum">list_sum</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="list_sum">list_sum</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span> :: <span class="id">xs</span> =&gt; <span class="id">x</span> + <span class="id">list_sum</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_cat">list_sum_cat</a></span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id">l1</span> ++ <span class="id">l2</span>) = (<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l1</span>) + (<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1704')">Proof.</div>
<div class="proofscript" id="proof1704">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span> ; <span class="id">nra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>.  <span class="id">nra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_map_concat">list_sum_map_concat</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#concat">concat</a></span> <span class="id">l</span>) = <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1705')">Proof.</div>
<div class="proofscript" id="proof1705">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_cat">list_sum_cat</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="list_sum_Proper">list_sum_Proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1706')">Proof.</div>
<div class="proofscript" id="proof1706">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_ind_bis">Permutation_ind_bis</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">a</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x0</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">Hpll</span>' <span class="id">Hll</span>'. <span class="tactic">simpl</span> ; <span class="tactic">f_equal</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">H0</span> <span class="id">H1</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">l</span>'' <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H3</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_perm_eq">list_sum_perm_eq</a></span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l1</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1707')">Proof.</div>
<div class="proofscript" id="proof1707">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_const_mul">list_sum_const_mul</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} <span class="id">f</span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">r</span>*<span class="id">f</span> <span class="id">x</span>) <span class="id">l</span>)  =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span>* <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span>) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1708')">Proof.</div>
<div class="proofscript" id="proof1708">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_map_const">list_sum_map_const</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">a</span> : <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">a</span>) <span class="id">l</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)* (<span class="id">f</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1709')">Proof.</div>
<div class="proofscript" id="proof1709">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">enough</span> (<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) + 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) + 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) <span class="kwd">as</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">n</span>.  <span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_map_zero">list_sum_map_zero</a></span> {<span class="id">A</span>} (<span class="id">s</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0) <span class="id">s</span>) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1710')">Proof.</div>
<div class="proofscript" id="proof1710">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHs</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_le">list_sum_le</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">f</span> <span class="id">a</span> &lt;= <span class="id">g</span> <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>) &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">g</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1711')">Proof.</div>
<div class="proofscript" id="proof1711">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="id">right</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>. <span class="id">specialize</span> (<span class="id">Hfg</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_mult_const">list_sum_mult_const</a></span> (<span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">c</span>*<span class="id">z</span>) <span class="id">l</span>) = <span class="id">c</span>*<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">z</span>) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1712')">Proof.</div>
<div class="proofscript" id="proof1712">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_const_mult_le">list_sum_const_mult_le</a></span> {<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">hl</span> : <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R1">R1</a></span>) (<span class="id">hxy</span> : <span class="id">x</span> &lt;= <span class="id">y</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">x</span>*<span class="id">z</span>) <span class="id">l</span>) &lt;= <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1713')">Proof.</div>
<div class="proofscript" id="proof1713">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_mult_const">list_sum_mult_const</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#map_id">map_id</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">hl</span>. <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_fun_mult_le">list_sum_fun_mult_le</a></span> {<span class="id">x</span> <span class="id">y</span> <span class="id">D</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} {<span class="id">f</span> <span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>}(<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)(<span class="id">hf</span> : <span class="kwd">forall</span> <span class="id">z</span>, <span class="id">f</span> <span class="id">z</span> &lt;= <span class="id">D</span>) (<span class="id">hg</span> : <span class="kwd">forall</span> <span class="id">z</span> , 0 &lt;= <span class="id">g</span> <span class="id">z</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; (<span class="id">f</span> <span class="id">z</span>)*(<span class="id">g</span> <span class="id">z</span>)) <span class="id">l</span>) &lt;= <span class="id">D</span>*<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">g</span> <span class="id">z</span>) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1714')">Proof.</div>
<div class="proofscript" id="proof1714">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a</span> * <span class="id">g</span> <span class="id">a</span> &lt;= <span class="id">D</span> * <span class="id">g</span> <span class="id">a</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>. <span class="tactic">exact</span> (<span class="id">hg</span> <span class="id">a</span>). <span class="tactic">exact</span> (<span class="id">hf</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">IHl</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_map">list_sum_map</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> <span class="id">l</span>) + <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">g</span> <span class="id">l</span>) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span>) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1715')">Proof.</div>
<div class="proofscript" id="proof1715">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_cat">list_sum_cat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map2_app_interleave_perm">map2_app_interleave_perm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_map_concat">list_sum_map_concat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_fold_right">list_sum_fold_right</a></span> <span class="id">l</span> : <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1716')">Proof.</div>
<div class="proofscript" id="proof1716">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_pos_pos">list_sum_pos_pos</a></span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> &gt;= 0) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span> &gt;= 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1717')">Proof.</div>
<div class="proofscript" id="proof1717">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">HH</span>; <span class="id">invcs</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">list_sum_pos_pos</span>' <span class="id">l</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; 0 &lt;= <span class="id">x</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1718')">Proof.</div>
<div class="proofscript" id="proof1718">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">HH</span>; <span class="id">invcs</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_all_pos_zero_all_zero">list_sum_all_pos_zero_all_zero</a></span> <span class="id">l</span> : <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span> = 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> &gt;= 0) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> = 0) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1719')">Proof.</div>
<div class="proofscript" id="proof1719">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">invcs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_pos_pos">list_sum_pos_pos</a></span> <span class="id">_</span> <span class="id">H4</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> = 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rsqrt_le">Rsqrt_le</a></span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonnegreal">nonnegreal</a></span>) : <br/>
&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">y</span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1720')">Proof.</div>
<div class="proofscript" id="proof1720">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_0">Rsqr_incr_0</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_1">Rsqr_incr_1</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rsqrt_lt">Rsqrt_lt</a></span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonnegreal">nonnegreal</a></span>) : <br/>
&nbsp;&nbsp;<span class="id">x</span> &lt; <span class="id">y</span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">x</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1721')">Proof.</div>
<div class="proofscript" id="proof1721">
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_0">Rsqr_incrst_0</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">y</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.    <br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">y</span>)); <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.    <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rsqrt_sqr">Rsqrt_sqr</a></span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonnegreal">nonnegreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> {| <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonneg">nonneg</a></span> := <span class="id">x</span>; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_nonneg">cond_nonneg</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> <span class="id">x</span> |} = <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1722')">Proof.</div>
<div class="proofscript" id="proof1722">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_inj">Rsqr_inj</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_nonneg">cond_nonneg</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rsqr_lt_to_Rsqrt">Rsqr_lt_to_Rsqrt</a></span> (<span class="id">x</span> <span class="id">r</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonnegreal">nonnegreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">r</span> &lt; <span class="id">x</span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">r</span> &lt; <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1723')">Proof.</div>
<div class="proofscript" id="proof1723">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">etransitivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rsqrt_lt">Rsqrt_lt</a></span> <span class="id">r</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mknonnegreal">mknonnegreal</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rsqrt_sqr">Rsqrt_sqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rsqr_le_to_Rsqrt">Rsqr_le_to_Rsqrt</a></span> (<span class="id">r</span> <span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonnegreal">nonnegreal</a></span>):<br/>
&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">r</span> &lt;-&gt; <span class="id">x</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">r</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1724')">Proof.</div>
<div class="proofscript" id="proof1724">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">etransitivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rsqrt_le">Rsqrt_le</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mknonnegreal">mknonnegreal</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> <span class="id">x</span>)) <span class="id">r</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rsqrt_sqr">Rsqrt_sqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rsqr_continuous">Rsqr_continuous</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#continuity">continuity</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1725')">Proof.</div>
<div class="proofscript" id="proof1725">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_continuous">derivable_continuous</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_Rsqr">derivable_Rsqr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="EqDecR">EqDecR</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="sum_n">sum_n</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sum_n_pos">sum_n_pos</a></span> {<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">N</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id">n</span> &lt;= <span class="id">N</span>)%<span class="id">nat</span> -&gt; 0 &lt; <span class="id">a</span> <span class="id">n</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">sum_n</span> <span class="id">a</span> <span class="id">N</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1726')">Proof.</div>
<div class="proofscript" id="proof1726">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">N</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">sum_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_n_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_Sn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sum_n_nneg">sum_n_nneg</a></span> {<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">N</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span>, (<span class="id">n</span> &lt;= <span class="id">N</span>)%<span class="id">nat</span> -&gt; 0 &lt;= <span class="id">a</span> <span class="id">n</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">sum_n</span> <span class="id">a</span> <span class="id">N</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1727')">Proof.</div>
<div class="proofscript" id="proof1727">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">N</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">sum_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">sum_n_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">sum_Sn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sum_n_zero">sum_n_zero</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>): <span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0) <span class="id">n</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1728')">Proof.</div>
<div class="proofscript" id="proof1728">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">sum_n</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">sum_n_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">sum_n</span>. <span class="tactic">rewrite</span> <span class="id">sum_n_Sm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span> <span class="kwd">in</span> <span class="id">IHn</span>. <span class="tactic">rewrite</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">plus</span>. <span class="tactic">simpl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Series_nonneg">Series_nonneg</a></span> {<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} : <span class="id">ex_series</span> <span class="id">a</span> -&gt; (<span class="kwd">forall</span> <span class="id">n</span>, 0 &lt;= <span class="id">a</span> <span class="id">n</span>) -&gt; 0 &lt;= <span class="id">Series</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1729')">Proof.</div>
<div class="proofscript" id="proof1729">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span> <span class="id">Hpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">Series_le</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; 0) <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, 0 &lt;= 0 &lt;= <span class="id">a</span> <span class="id">n</span>) <span class="tactic">by</span> (<span class="tactic">intro</span> <span class="id">n</span>; <span class="tactic">split</span> ; <span class="tactic">try</span> (<span class="id">lra</span> ; <span class="tactic">trivial</span>) ; <span class="tactic">try</span> (<span class="tactic">trivial</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H0</span> <span class="id">Ha</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Series</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0) = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Series</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0) = (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">FunctionalExtensionality.functional_extensionality</a></span> ; <span class="tactic">intros</span> ; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#sum_n_zero">sum_n_zero</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Lim_seq_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Series_pos">Series_pos</a></span> {<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} : <span class="id">ex_series</span> <span class="id">a</span> -&gt; (<span class="kwd">forall</span> <span class="id">n</span>, 0 &lt; <span class="id">a</span> <span class="id">n</span>) -&gt; 0 &lt; <span class="id">Series</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1730')">Proof.</div>
<div class="proofscript" id="proof1730">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span> <span class="id">Hpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Series_incr_1</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_le_0_compat">Rplus_lt_le_0_compat</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Series_nonneg">Series_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">ex_series_incr_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">n</span>. <span class="id">left</span>. <span class="tactic">apply</span> (<span class="id">Hpos</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#sum_n">sum_n</a></span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="expprops">expprops</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="ex_series_exp_even">ex_series_exp_even</a></span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>): <span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">k</span> :<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; /<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">k</span>))*(<span class="id">x</span>^2)^<span class="id">k</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1731')">Proof.</div>
<div class="proofscript" id="proof1731">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">ex_series_le</span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; /<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">k</span>))*(<span class="id">x</span>^2)^<span class="id">k</span>) (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">x</span>^2)^<span class="id">k</span> /<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> <span class="id">k</span>)));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id">norm</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span>. <span class="tactic">replace</span> (<span class="id">n</span>+(<span class="id">n</span>+0))%<span class="id">nat</span> <span class="kwd">with</span> (2*<span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>*1) <span class="kwd">with</span> <span class="id">x</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">x</span>*<span class="id">x</span>)^<span class="id">n</span>) <span class="kwd">with</span> (<span class="id">x</span>^(2*<span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span>^(2*<span class="id">n</span>))) <span class="kwd">with</span> (<span class="id">x</span>^(2*<span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_le">pow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">Ratan.pow2_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rprod.html#INR_fact_lt_0">Rprod.INR_fact_lt_0</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_le_contravar">Rinv_le_contravar</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#le_INR">le_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact_le">fact_le</a></span> ; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.  <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_le">pow_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">Ratan.pow2_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>. <span class="tactic">f_equal</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> (<span class="id">x</span>^2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">x</span>^2) <span class="kwd">as</span> <span class="id">y</span>. <span class="tactic">intro</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_exp_Reals</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="ex_series_exp_odd">ex_series_exp_odd</a></span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>): <span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">k</span> :<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; /<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">k</span> + 1)) * (<span class="id">x</span>^2)^<span class="id">k</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1732')">Proof.</div>
<div class="proofscript" id="proof1732">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">ex_series_le</span> (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">k</span> + 1))*(<span class="id">x</span>^2)^<span class="id">k</span>)) (<span class="kwd">fun</span> <span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; (<span class="id">x</span>^2)^<span class="id">k</span> /<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> <span class="id">k</span>)));<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span> ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">norm</span> ; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">n</span>+(<span class="id">n</span>+0))%<span class="id">nat</span> <span class="kwd">with</span> (2*<span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>*1) <span class="kwd">with</span> <span class="id">x</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">x</span>*<span class="id">x</span>)^<span class="id">n</span>) <span class="kwd">with</span> (<span class="id">x</span>^(2*<span class="id">n</span>)) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span> ; <span class="tactic">f_equal</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span>^(2*<span class="id">n</span>))) <span class="kwd">with</span> (<span class="id">x</span>^(2*<span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_le">pow_le</a></span> ;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">Ratan.pow2_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rprod.html#INR_fact_lt_0">Rprod.INR_fact_lt_0</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_le_contravar">Rinv_le_contravar</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#le_INR">le_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact_le">fact_le</a></span> ; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_le">pow_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">Ratan.pow2_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> (<span class="id">x</span>^2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">x</span>^2) <span class="kwd">as</span> <span class="id">y</span>. <span class="tactic">intro</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_exp_Reals</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_even_odd">exp_even_odd</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span> = (<span class="id">Series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">x</span>^(2*<span class="id">n</span>)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span>)) + <span class="id">x</span>^(2*<span class="id">n</span> + 1)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span> + 1))))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1733')">Proof.</div>
<div class="proofscript" id="proof1733">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">exp_Reals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PSeries_odd_even</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">ex_pseries_R</span> ; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_exp_even">ex_series_exp_even</a></span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">ex_pseries_R</span> ; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_exp_odd">ex_series_exp_odd</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">PSeries</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Series_scal_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Series_plus</span> ; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_exp_even">ex_series_exp_even</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id">Series_ext</span> ; <span class="tactic">intros</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>^(2*<span class="id">n</span>)*<span class="id">x</span>) <span class="kwd">with</span> (<span class="id">x</span>^(2*<span class="id">n</span> +1)) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_add">pow_add</a></span> ; <span class="tactic">f_equal</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;--  <span class="tactic">generalize</span> (<span class="id">ex_series_scal</span> <span class="id">x</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2 * <span class="id">n</span> + 1)) * (<span class="id">x</span> ^ 2) ^ <span class="id">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_exp_odd">ex_series_exp_odd</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="ex_series_even_odd">ex_series_even_odd</a></span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">x</span> ^ (2 * <span class="id">n</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2 * <span class="id">n</span>)) + <span class="id">x</span> ^ (2 * <span class="id">n</span> + 1) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2 * <span class="id">n</span> + 1))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1734')">Proof.</div>
<div class="proofscript" id="proof1734">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_exp_odd">ex_series_exp_odd</a></span> ; <span class="tactic">intros</span> <span class="id">Hodd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_exp_even">ex_series_exp_even</a></span> ; <span class="tactic">intros</span> <span class="id">Heven</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hodd</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Heven</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Heven</span>' : <span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">x</span>^(2*<span class="id">n</span>)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">ex_series_ext</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>))*(<span class="id">x</span>^2)^<span class="id">n</span> = <span class="id">x</span>^(2*<span class="id">n</span>)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Heven</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hodd</span>' : <span class="id">ex_series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">x</span>^(2*<span class="id">n</span> + 1)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span> + 1)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">ex_series_ext</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">x</span>*(/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span> + 1))*(<span class="id">x</span>^2)^<span class="id">n</span>) = <span class="id">x</span>^(2*<span class="id">n</span> + 1)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span> + 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_add">pow_add</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_1">pow_1</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">ex_series_scal</span> <span class="id">x</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2 * <span class="id">n</span> + 1)) * (<span class="id">x</span> ^ 2) ^ <span class="id">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">Hodd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">ex_series_plus</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heven</span>' <span class="id">Hodd</span>') ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_even_odd_incr_1">exp_even_odd_incr_1</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span> = (1 + <span class="id">x</span>) + (<span class="id">Series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span>^(2*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">x</span>^(2*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + 1)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) + 1)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1735')">Proof.</div>
<div class="proofscript" id="proof1735">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#exp_even_odd">exp_even_odd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Series_incr_1</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_even_odd">ex_series_even_odd</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_ineq2">exp_ineq2</a></span> : <span class="kwd">forall</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id">x</span> &lt;= -1 -&gt; (1 + <span class="id">x</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1736')">Proof.</div>
<div class="proofscript" id="proof1736">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Exp_prop.html#exp_pos">exp_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_ineq3_aux">exp_ineq3_aux</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(-1 &lt; <span class="id">x</span> &lt; 0) -&gt; 0 &lt; (<span class="id">x</span>^(2*<span class="id">n</span>)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span>)) + <span class="id">x</span>^(2*<span class="id">n</span> + 1)/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span> + 1))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1737')">Proof.</div>
<div class="proofscript" id="proof1737">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>^(2*<span class="id">n</span> + 1)) <span class="kwd">with</span> (<span class="id">x</span>^(2*<span class="id">n</span>) * <span class="id">x</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_add">pow_add</a></span> ; <span class="tactic">ring</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_0_compat">Rmult_gt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_mult">pow_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_lt">Rgt_lt</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rcomplements.pow2_gt_0</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">replace</span> (/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span>))) <span class="kwd">with</span> (1 / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span> (2*<span class="id">n</span>))) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>*/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>+1))) <span class="kwd">with</span> (<span class="id">x</span>/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span> + 1))) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Rcomplements.Rdiv_plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2,3 : (<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#not_0_INR">not_0_INR</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact_neq_0">fact_neq_0</a></span> <span class="id">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_INR">mult_INR</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_0_compat">Rmult_gt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span> ; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_INR">mult_INR</a></span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_0_compat">Rmult_gt_0_compat</a></span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rprod.html#INR_fact_lt_0">Rprod.INR_fact_lt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>)) + <span class="id">x</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>)) + <span class="id">x</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (1*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>)) + <span class="id">x</span>* <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*<span class="id">n</span>))) <span class="tactic">by</span> (<span class="tactic">f_equal</span> ; <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span> ; <span class="tactic">try</span> <span class="id">lra</span> ; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rprod.html#INR_fact_lt_0">Rprod.INR_fact_lt_0</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#le_INR">le_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact_le">fact_le</a></span> ; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_ineq3">exp_ineq3</a></span> {<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} : -1 &lt; <span class="id">x</span> &lt; 0 -&gt; 1+<span class="id">x</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1738')">Proof.</div>
<div class="proofscript" id="proof1738">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#exp_even_odd">exp_even_odd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Series_incr_1</span>. 2 : <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_even_odd">ex_series_even_odd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1+<span class="id">x</span>) <span class="kwd">with</span> (1+<span class="id">x</span>+ 0) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2*0) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*0)) <span class="kwd">with</span> 1%<span class="id">nat</span> <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Factorial.html#fact">fact</a></span>(2*0 + 1)) <span class="kwd">with</span> 1%<span class="id">nat</span> <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>^(2*0)) <span class="kwd">with</span> 1 <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>^(2*0 + 1)) <span class="kwd">with</span> <span class="id">x</span> <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="tactic">trivial</span>;<span class="tactic">ring</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> 1) <span class="kwd">with</span> 1 <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1/1 + <span class="id">x</span>/1) <span class="kwd">with</span> (1+<span class="id">x</span>) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Series_pos">Series_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#ex_series_even_odd">ex_series_even_odd</a></span> <span class="id">x</span>) ;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">ex_series_incr_1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intro</span> <span class="id">n</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#exp_ineq3_aux">exp_ineq3_aux</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_ineq">exp_ineq</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : 1+<span class="id">x</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1739')">Proof.</div>
<div class="proofscript" id="proof1739">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> (-1) <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#exp_ineq3">exp_ineq3</a></span>. <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">left</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#exp_ineq1">exp_ineq1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">right</span>. <span class="tactic">subst</span> ; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp_0">exp_0</a></span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#exp_ineq2">exp_ineq2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#expprops">expprops</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="convex">convex</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="convex">convex</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;=<span class="id">a</span>&lt;=1 -&gt; <span class="id">f</span> (<span class="id">a</span> * <span class="id">x</span> + (1-<span class="id">a</span>) * <span class="id">y</span>) &lt;= <span class="id">a</span> * <span class="id">f</span> <span class="id">x</span> + (1-<span class="id">a</span>)*<span class="id">f</span> <span class="id">y</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="compose_convex">compose_convex</a></span> (<span class="id">f</span> <span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id">g</span> <span class="id">a</span> <span class="id">x</span> <span class="id">y</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#increasing">increasing</a></span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id">f</span> (<span class="id">g</span> <span class="id">z</span>)) <span class="id">a</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1740')">Proof.</div>
<div class="proofscript" id="proof1740">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#increasing">increasing</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">r2</span> := <span class="id">f</span> (<span class="id">a</span> * <span class="id">g</span> <span class="id">x</span> + (1 - <span class="id">a</span>) * <span class="id">g</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="abs_convex">abs_convex</a></span> : <span class="kwd">forall</span> (<span class="id">a</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">a</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1741')">Proof.</div>
<div class="proofscript" id="proof1741">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> (<span class="id">a</span>*<span class="id">x</span>) ((1-<span class="id">a</span>)*<span class="id">y</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">a</span>) <span class="kwd">with</span> <span class="id">a</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (1-<span class="id">a</span>)) <span class="kwd">with</span> (1-<span class="id">a</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="convex_deriv">convex_deriv</a></span> (<span class="id">f</span> <span class="id">f</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> <span class="id">f</span> <span class="id">c</span> (<span class="id">f</span>' <span class="id">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id">f</span> <span class="id">y</span> &gt;= <span class="id">f</span> <span class="id">x</span> + <span class="id">f</span>' <span class="id">x</span> * (<span class="id">y</span> - <span class="id">x</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id">f</span> <span class="id">c</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1742')">Proof.</div>
<div class="proofscript" id="proof1742">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>) <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>) <span class="id">y</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">c</span>) <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := 1-<span class="id">c</span>) <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pos_convex_deriv">pos_convex_deriv</a></span> (<span class="id">f</span> <span class="id">f</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,  0 &lt;= <span class="id">c</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> <span class="id">f</span> <span class="id">c</span> (<span class="id">f</span>' <span class="id">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, 0 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span>  -&gt; <span class="id">f</span> <span class="id">y</span> &gt;= <span class="id">f</span> <span class="id">x</span> + <span class="id">f</span>' <span class="id">x</span> * (<span class="id">y</span> - <span class="id">x</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, 0 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id">f</span> <span class="id">c</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1743')">Proof.</div>
<div class="proofscript" id="proof1743">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">c</span>) <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := 1-<span class="id">c</span>) <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="id">lra</span>.     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>) <span class="id">x</span> <span class="id">H4</span> <span class="id">H1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>) <span class="id">y</span> <span class="id">H4</span> <span class="id">H2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">c</span>) <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := 1-<span class="id">c</span>) <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="ppos_convex_deriv">ppos_convex_deriv</a></span> (<span class="id">f</span> <span class="id">f</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,  0 &lt; <span class="id">c</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> <span class="id">f</span> <span class="id">c</span> (<span class="id">f</span>' <span class="id">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, 0 &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">y</span>  -&gt; <span class="id">f</span> <span class="id">y</span> &gt;= <span class="id">f</span> <span class="id">x</span> + <span class="id">f</span>' <span class="id">x</span> * (<span class="id">y</span> - <span class="id">x</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, 0 &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id">f</span> <span class="id">c</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1744')">Proof.</div>
<div class="proofscript" id="proof1744">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ineq</span>:0 &lt; <span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">c</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_le_0_compat">Rplus_lt_le_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>) <span class="id">x</span> <span class="id">ineq</span> <span class="id">H1</span>); <span class="tactic">intros</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id">c</span> * <span class="id">x</span> + (1-<span class="id">c</span>)*<span class="id">y</span>) <span class="id">y</span> <span class="id">ineq</span> <span class="id">H2</span>); <span class="tactic">intros</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">c</span>) <span class="kwd">in</span> <span class="id">HH1</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := 1-<span class="id">c</span>) <span class="kwd">in</span> <span class="id">HH2</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="deriv_incr_convex">deriv_incr_convex</a></span> (<span class="id">f</span> <span class="id">f</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,   <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> <span class="id">f</span> <span class="id">c</span> (<span class="id">f</span>' <span class="id">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">f</span>' <span class="id">x</span> &lt;= <span class="id">f</span>' <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">f</span> <span class="id">y</span> &gt;= <span class="id">f</span> <span class="id">x</span> + <span class="id">f</span>' <span class="id">x</span> * (<span class="id">y</span>-<span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1745')">Proof.</div>
<div class="proofscript" id="proof1745">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.MVT.html#MVT_cor3">MVT_cor3</a></span> <span class="id">f</span> <span class="id">f</span>'); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">H1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">x0</span> [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span>' <span class="id">x</span> &lt;= <span class="id">f</span>' <span class="id">x0</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (<span class="id">y</span>-<span class="id">x</span>)) <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H2</span>; [<span class="tactic">subst</span>; <span class="id">lra</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">y</span> <span class="id">x</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">x0</span> [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span>' <span class="id">x0</span> &lt;= <span class="id">f</span>' <span class="id">x</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (<span class="id">x</span>-<span class="id">y</span>)) <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pos_deriv_incr_convex">pos_deriv_incr_convex</a></span> (<span class="id">f</span> <span class="id">f</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,  0 &lt;= <span class="id">c</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> <span class="id">f</span> <span class="id">c</span> (<span class="id">f</span>' <span class="id">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0&lt;=<span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">f</span>' <span class="id">x</span> &lt;= <span class="id">f</span>' <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">y</span> &gt;= <span class="id">f</span> <span class="id">x</span> + <span class="id">f</span>' <span class="id">x</span> * (<span class="id">y</span>-<span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1746')">Proof.</div>
<div class="proofscript" id="proof1746">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.MVT.html#MVT_cor3">MVT_cor3</a></span> <span class="id">f</span> <span class="id">f</span>'); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">x0</span> [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span>' <span class="id">x</span> &lt;= <span class="id">f</span>' <span class="id">x0</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (<span class="id">y</span>-<span class="id">x</span>)) <span class="kwd">in</span> <span class="id">H7</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H4</span>; [<span class="tactic">subst</span>; <span class="id">lra</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">y</span> <span class="id">x</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">x0</span> [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span>' <span class="id">x0</span> &lt;= <span class="id">f</span>' <span class="id">x</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (<span class="id">x</span>-<span class="id">y</span>)) <span class="kwd">in</span> <span class="id">H7</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="ppos_deriv_incr_convex">ppos_deriv_incr_convex</a></span> (<span class="id">f</span> <span class="id">f</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,  0 &lt; <span class="id">c</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> <span class="id">f</span> <span class="id">c</span> (<span class="id">f</span>' <span class="id">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0&lt;<span class="id">x</span> -&gt; 0 &lt; <span class="id">y</span> -&gt; <span class="id">x</span> &lt;= <span class="id">y</span> -&gt; <span class="id">f</span>' <span class="id">x</span> &lt;= <span class="id">f</span>' <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0 &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">y</span> -&gt; <span class="id">f</span> <span class="id">y</span> &gt;= <span class="id">f</span> <span class="id">x</span> + <span class="id">f</span>' <span class="id">x</span> * (<span class="id">y</span>-<span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1747')">Proof.</div>
<div class="proofscript" id="proof1747">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.MVT.html#MVT_cor3">MVT_cor3</a></span> <span class="id">f</span> <span class="id">f</span>'); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">x0</span> [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span>' <span class="id">x</span> &lt;= <span class="id">f</span>' <span class="id">x0</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (<span class="id">y</span>-<span class="id">x</span>)) <span class="kwd">in</span> <span class="id">H7</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H4</span>; [<span class="tactic">subst</span>; <span class="id">lra</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">y</span> <span class="id">x</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">x0</span> [? [? ?]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span>' <span class="id">x0</span> &lt;= <span class="id">f</span>' <span class="id">x</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (<span class="id">x</span>-<span class="id">y</span>)) <span class="kwd">in</span> <span class="id">H7</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pow_convex">pow_convex</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">a</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0&lt;=<span class="id">x</span> -&gt; 0&lt;=<span class="id">y</span> -&gt;  <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">z</span> <span class="id">n</span>) <span class="id">a</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1748')">Proof.</div>
<div class="proofscript" id="proof1748">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pos_convex_deriv">pos_convex_deriv</a></span> <span class="kwd">with</span> (<span class="id">f</span>' := <span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">z</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id">n</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim_pow">derivable_pt_lim_pow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#pos_deriv_incr_convex">pos_deriv_incr_convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">z</span> <span class="id">n</span>) (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">z</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id">n</span>))); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim_pow">derivable_pt_lim_pow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos_INR">pos_INR</a></span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_maj_Rabs">pow_maj_Rabs</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exp_convex">exp_convex</a></span> (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> <span class="id">r</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1749')">Proof.</div>
<div class="proofscript" id="proof1749">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex_deriv">convex_deriv</a></span> <span class="kwd">with</span>  (<span class="id">f</span>' := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span>) ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Exp_prop.html#derivable_pt_lim_exp">derivable_pt_lim_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#deriv_incr_convex">deriv_incr_convex</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Exp_prop.html#derivable_pt_lim_exp">derivable_pt_lim_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#exp_increasing">exp_increasing</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Rpower">Rpower</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_pos">Rpower_pos</a></span> <span class="id">b</span> <span class="id">e</span> : 0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1750')">Proof.</div>
<div class="proofscript" id="proof1750">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Exp_prop.html#exp_pos">exp_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_nzero">Rpower_nzero</a></span> <span class="id">b</span> <span class="id">e</span> : ~ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">e</span> = 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1751')">Proof.</div>
<div class="proofscript" id="proof1751">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span> <span class="id">b</span> <span class="id">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_inv_cancel">Rpower_inv_cancel</a></span> <span class="id">x</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">x</span> <span class="id">n</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rinv">Rinv</a></span> <span class="id">n</span>) = <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1752')">Proof.</div>
<div class="proofscript" id="proof1752">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_mult">Rpower_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r_sym">Rinv_r_sym</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_1">Rpower_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pow0_Sbase">pow0_Sbase</a></span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1753')">Proof.</div>
<div class="proofscript" id="proof1753">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pow_integral">pow_integral</a></span> <span class="id">n</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> = 0 -&gt; <span class="id">y</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1754')">Proof.</div>
<div class="proofscript" id="proof1754">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral">Rmult_integral</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rabs_pow_eq_inv">Rabs_pow_eq_inv</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1755')">Proof.</div>
<div class="proofscript" id="proof1755">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">x</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pow0_Sbase">pow0_Sbase</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pow_integral">pow_integral</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rcomplements.Rabs_eq_0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">y</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pow0_Sbase">pow0_Sbase</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pow_integral">pow_integral</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rcomplements.Rabs_eq_0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span>) <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_inv_cancel">Rpower_inv_cancel</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))); <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#not_0_INR">not_0_INR</a></span>; <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_inv_cancel">Rpower_inv_cancel</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))); <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#not_0_INR">not_0_INR</a></span>; <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_pow">Rpower_pow</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower">Rpower</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="power">power</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="power">power</a></span> (<span class="id">b</span> <span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">b</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">e</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_Rpower">power_Rpower</a></span> (<span class="id">b</span> <span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">e</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1756')">Proof.</div>
<div class="proofscript" id="proof1756">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_nonneg">power_nonneg</a></span> (<span class="id">b</span> <span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">e</span> .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1757')">Proof.</div>
<div class="proofscript" id="proof1757">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_pos">power_pos</a></span> (<span class="id">b</span> <span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">e</span> .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1758')">Proof.</div>
<div class="proofscript" id="proof1758">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_Ropp">power_Ropp</a></span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (- <span class="id">y</span>) = / <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1759')">Proof.</div>
<div class="proofscript" id="proof1759">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_Rpower">power_Rpower</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_Ropp">Rpower_Ropp</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_integral">power_integral</a></span> <span class="id">b</span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">e</span> = 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1760')">Proof.</div>
<div class="proofscript" id="proof1760">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">eelim</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_nzero">Rpower_nzero</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_mult">power_mult</a></span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="id">z</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id">y</span> * <span class="id">z</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1761')">Proof.</div>
<div class="proofscript" id="proof1761">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">eelim</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_nzero">Rpower_nzero</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_mult">Rpower_mult</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_plus">power_plus</a></span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">z</span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">z</span> <span class="id">x</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">z</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1762')">Proof.</div>
<div class="proofscript" id="proof1762">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_plus">Rpower_plus</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_1">power_1</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> 1 = <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1763')">Proof.</div>
<div class="proofscript" id="proof1763">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_1">Rpower_1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_O">power_O</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> 0 = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1764')">Proof.</div>
<div class="proofscript" id="proof1764">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_O">Rpower_O</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="powerRZ_power">powerRZ_power</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">z</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#powerRZ">powerRZ</a></span> <span class="id">x</span> <span class="id">z</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">z</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1765')">Proof.</div>
<div class="proofscript" id="proof1765">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#powerRZ_Rpower">powerRZ_Rpower</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rle_power">Rle_power</a></span> (<span class="id">e</span> <span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span> &lt;= <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">e</span> <span class="id">n</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">e</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1766')">Proof.</div>
<div class="proofscript" id="proof1766">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rle_Rpower">Rle_Rpower</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_lt">power_lt</a></span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt; <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y</span> &lt; <span class="id">z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">y</span> &lt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1767')">Proof.</div>
<div class="proofscript" id="proof1767">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_lt">Rpower_lt</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power0_Sbase">power0_Sbase</a></span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 0 <span class="id">e</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1768')">Proof.</div>
<div class="proofscript" id="proof1768">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_inv_cancel">power_inv_cancel</a></span> <span class="id">b</span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> (/ <span class="id">e</span>)) <span class="id">e</span> = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1769')">Proof.</div>
<div class="proofscript" id="proof1769">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult">power_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="inv_power_cancel">inv_power_cancel</a></span> <span class="id">b</span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">e</span>) (/ <span class="id">e</span>) = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1770')">Proof.</div>
<div class="proofscript" id="proof1770">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult">power_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_eq_inv">power_eq_inv</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;&gt; <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">n</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">y</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1771')">Proof.</div>
<div class="proofscript" id="proof1771">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (/<span class="id">n</span>))) <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#inv_power_cancel">inv_power_cancel</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_pow">power_pow</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>) = <span class="id">x</span> ^ <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1772')">Proof.</div>
<div class="proofscript" id="proof1772">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_pow">Rpower_pow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_Spow">power_Spow</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) = <span class="id">x</span> ^ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1773')">Proof.</div>
<div class="proofscript" id="proof1773">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pow0_Sbase">pow0_Sbase</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_pow">Rpower_pow</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power2_sqr">power2_sqr</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> 2 = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1774')">Proof.</div>
<div class="proofscript" id="proof1774">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> 2%<span class="id">nat</span>) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_Spow">power_Spow</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#Rsqr_pow2">Rsqr_pow2</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_abs2_sqr">power_abs2_sqr</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) 2 = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1775')">Proof.</div>
<div class="proofscript" id="proof1775">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power2_sqr">power2_sqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_abs">Rsqr_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_2_sqrt">power_2_sqrt</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#nonnegreal">nonnegreal</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (/2) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1776')">Proof.</div>
<div class="proofscript" id="proof1776">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_eq_abs_0">Rsqr_eq_abs_0</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (/ 2)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt">Rsqrt</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_positivity">Rsqrt_positivity</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rsqrt_def.html#Rsqrt_Rsqrt">Rsqrt_Rsqrt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power2_sqr">power2_sqr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_inv_cancel">power_inv_cancel</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_nonneg">cond_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rlt_power_l">Rlt_power_l</a></span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">a</span> &lt; <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">c</span> &lt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">c</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1777')">Proof.</div>
<div class="proofscript" id="proof1777">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; [<span class="tactic">try</span> <span class="id">lra</span> |]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rlt_Rpower_l">Rlt_Rpower_l</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rle_power_l">Rle_power_l</a></span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">a</span> &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">c</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">c</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1778')">Proof.</div>
<div class="proofscript" id="proof1778">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; [<span class="tactic">try</span> <span class="id">lra</span> |]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rle_Rpower_l">Rle_Rpower_l</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_sqrt">power_sqrt</a></span> (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (/ 2) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1779')">Proof.</div>
<div class="proofscript" id="proof1779">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_sqrt">Rpower_sqrt</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_mult_distr">power_mult_distr</a></span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">z</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">y</span> <span class="id">z</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id">x</span> * <span class="id">y</span>) <span class="id">z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1780')">Proof.</div>
<div class="proofscript" id="proof1780">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_destr</span>; <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral">Rmult_integral</a></span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">intuition</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_mult_distr">Rpower_mult_distr</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_incr_inv">power_incr_inv</a></span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">n</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">y</span> <span class="id">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> &lt;= <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1781')">Proof.</div>
<div class="proofscript" id="proof1781">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rle_power_l">Rle_power_l</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">y</span> <span class="id">n</span>) (/<span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#inv_power_cancel">inv_power_cancel</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">derivable_pt_lim_power</span>' (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> (<span class="kwd">fun</span> <span class="id">x0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x0</span> <span class="id">y</span>) <span class="id">x</span> (<span class="id">y</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id">y</span> - 1)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1782')">Proof.</div>
<div class="proofscript" id="proof1782">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#derivable_pt_lim_power">derivable_pt_lim_power</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim_locally_ext">derivable_pt_lim_locally_ext</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">a</span> := <span class="id">x</span>/2) (<span class="id">b</span> := <span class="id">x</span> + <span class="id">x</span>/2); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Dpower</span>' (<span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rderiv.html#D_in">D_in</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">z</span>) (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">z</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id">z</span> - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; 0 &lt; <span class="id">x</span>) <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1783')">Proof.</div>
<div class="proofscript" id="proof1783">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim_D_in">derivable_pt_lim_D_in</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">z</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id">z</span> - 1)) <span class="id">y</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#D_in_imp">D_in_imp</a></span> <span class="kwd">with</span> (<span class="id">D</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#no_cond">no_cond</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#no_cond">no_cond</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">derivable_pt_lim_power</span>'.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ineqs">ineqs</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_ln">Rpower_ln</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">x</span> <span class="id">y</span>) = <span class="id">y</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1784')">Proof.</div>
<div class="proofscript" id="proof1784">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln_exp">ln_exp</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_base_1">Rpower_base_1</a></span> : <span class="kwd">forall</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> 1 <span class="id">x</span> = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1785')">Proof.</div>
<div class="proofscript" id="proof1785">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln_1">ln_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>*0) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp_0">exp_0</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_base_1">power_base_1</a></span> <span class="id">e</span> : <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 1 <span class="id">e</span> = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1786')">Proof.</div>
<div class="proofscript" id="proof1786">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_base_1">Rpower_base_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sum_one_le">sum_one_le</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, 0 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span> -&gt; <span class="id">x</span> + <span class="id">y</span> = 1 -&gt; <span class="id">x</span> &lt;= 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1787')">Proof.</div>
<div class="proofscript" id="proof1787">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>) <span class="kwd">with</span> (<span class="id">x</span>+0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span>+0+<span class="id">y</span>) <span class="kwd">with</span> (<span class="id">x</span>+<span class="id">y</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rmult_four_assoc">Rmult_four_assoc</a></span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="id">a</span> * <span class="id">b</span> * (<span class="id">c</span> * <span class="id">d</span>) = <span class="id">a</span> * (<span class="id">b</span>*<span class="id">c</span>) * <span class="id">d</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1788')">Proof.</div>
<div class="proofscript" id="proof1788">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="Rpower_youngs_ineq">Rpower_youngs_ineq</a></span> {<span class="id">p</span> <span class="id">q</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>} {<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">Hpq</span> : 1/<span class="id">p</span> + 1/<span class="id">q</span> = 1) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">a</span> -&gt; 0 &lt; <span class="id">b</span> -&gt; <span class="id">a</span>*<span class="id">b</span> &lt;= (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">a</span> <span class="id">p</span>)/<span class="id">p</span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">q</span>)/<span class="id">q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1789')">Proof.</div>
<div class="proofscript" id="proof1789">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">apos</span> <span class="id">bpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span>*<span class="id">b</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp">exp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id">a</span>*<span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#exp_ln">exp_ln</a></span> ; <span class="tactic">trivial</span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln_mult">ln_mult</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span> <span class="kwd">as</span> [<span class="id">p</span> <span class="id">ppos</span>] ; <span class="tactic">destruct</span> <span class="id">q</span> <span class="kwd">as</span> [<span class="id">q</span> <span class="id">qpos</span>] ; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hp</span> : <span class="id">p</span> &lt;&gt; 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hq</span> : <span class="id">q</span> &lt;&gt; 0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">a</span>) <span class="kwd">with</span> (/<span class="id">p</span>*<span class="id">p</span>*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">a</span>)) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">b</span>) <span class="kwd">with</span> (/<span class="id">q</span>*<span class="id">q</span>*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">b</span>)) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">p</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">a</span> <span class="id">p</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_ln">Rpower_ln</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">q</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> <span class="id">b</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">q</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_ln">Rpower_ln</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#exp_convex">exp_convex</a></span> (/<span class="id">p</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">a</span> <span class="id">p</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">q</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (/<span class="id">q</span>) <span class="kwd">with</span> (1 - /<span class="id">p</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span> ; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#sum_one_le">sum_one_le</a></span> <span class="kwd">with</span> (<span class="id">y</span> := /<span class="id">q</span>) ; <span class="tactic">try</span> (<span class="id">left</span> ; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span> ; <span class="tactic">trivial</span>) ; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#exp_ln">exp_ln</a></span>; <span class="tactic">try</span> (<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Exp_prop.html#exp_pos">exp_pos</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="youngs_ineq">youngs_ineq</a></span> {<span class="id">p</span> <span class="id">q</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>} {<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">Hpq</span> : 1/<span class="id">p</span> + 1/<span class="id">q</span> = 1) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">a</span> -&gt; 0 &lt;= <span class="id">b</span> -&gt; <span class="id">a</span>*<span class="id">b</span> &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">p</span>)/<span class="id">p</span> + (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">q</span>)/<span class="id">q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1790')">Proof.</div>
<div class="proofscript" id="proof1790">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>; <span class="tactic">intros</span> <span class="id">apos</span> <span class="id">bpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_destr</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">destruct</span> <span class="id">q</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; [| <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span> <span class="id">b</span> <span class="id">pos0</span>); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">destruct</span> <span class="id">q</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; [| <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span> <span class="id">a</span> <span class="id">pos</span>); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_youngs_ineq">Rpower_youngs_ineq</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="youngs_ineq_2">youngs_ineq_2</a></span> {<span class="id">p</span> <span class="id">q</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>} (<span class="id">Hpq</span> : 1/<span class="id">p</span> + 1/<span class="id">q</span> = 1):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">t</span> <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0 &lt;= <span class="id">a</span> -&gt; 0 &lt;= <span class="id">b</span> -&gt; 0 &lt; <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> (1/<span class="id">p</span>))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> (1/<span class="id">q</span>)) &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">t</span> (-1/<span class="id">q</span>))*<span class="id">a</span>/<span class="id">p</span> + (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">t</span> (1/<span class="id">p</span>))*<span class="id">b</span>/<span class="id">q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1791')">Proof.</div>
<div class="proofscript" id="proof1791">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">a</span> <span class="id">b</span> <span class="id">apos</span> <span class="id">bpos</span> <span class="id">tpos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hq</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">q</span> &lt;&gt; 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">q</span>) ; <span class="tactic">intros</span> <span class="id">H</span> <span class="id">notq</span> ; <span class="tactic">rewrite</span> <span class="id">notq</span> <span class="kwd">in</span> <span class="id">H</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">p</span> &lt;&gt; 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">p</span>) ; <span class="tactic">intros</span> <span class="id">H</span> <span class="id">notp</span> ; <span class="tactic">rewrite</span> <span class="id">notp</span> <span class="kwd">in</span> <span class="id">H</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hap</span> : 0 &lt;= ((<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> (1/<span class="id">p</span>))*<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">t</span> (-1/(<span class="id">q</span>*<span class="id">p</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hbq</span> : 0 &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">t</span> (1/(<span class="id">q</span>*<span class="id">p</span>))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> (1/<span class="id">q</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#youngs_ineq">youngs_ineq</a></span> <span class="id">Hpq</span> <span class="id">Hap</span> <span class="id">Hbq</span>) ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmult_four_assoc">Rmult_four_assoc</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">t</span> (-1/(<span class="id">q</span>*<span class="id">p</span>)) * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">t</span> (1/(<span class="id">q</span>*<span class="id">p</span>))) <span class="kwd">with</span> 1 <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span> ; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult">power_mult</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 */<span class="id">p</span> *<span class="id">p</span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> (<span class="id">field</span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 */<span class="id">q</span> *<span class="id">q</span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> (<span class="id">field</span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++  <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.  <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (-1 * /(<span class="id">q</span>*<span class="id">p</span>) * <span class="id">p</span>) <span class="kwd">with</span> (-1 * /<span class="id">q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>. <span class="id">field</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++  <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 * /(<span class="id">q</span>*<span class="id">p</span>) * <span class="id">q</span>) <span class="kwd">with</span> (1 * /<span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>. <span class="id">field</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.utils.RealAdd.html#power_plus">power_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.utils.RealAdd.html#power_O">power_O</a></span> <span class="kwd">with</span> (<span class="id">x</span> := <span class="id">t</span>) ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_O">power_O</a></span>;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="Rpower_youngs_ineq_2">Rpower_youngs_ineq_2</a></span> {<span class="id">p</span> <span class="id">q</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>} (<span class="id">Hpq</span> : 1/<span class="id">p</span> + 1/<span class="id">q</span> = 1):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">t</span> <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0 &lt; <span class="id">a</span> -&gt; 0 &lt; <span class="id">b</span> -&gt; 0 &lt; <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">a</span> (1/<span class="id">p</span>))*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> (1/<span class="id">q</span>)) &lt;= (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">t</span> (-1/<span class="id">q</span>))*<span class="id">a</span>/<span class="id">p</span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">t</span> (1/<span class="id">p</span>))*<span class="id">b</span>/<span class="id">q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1792')">Proof.</div>
<div class="proofscript" id="proof1792">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#youngs_ineq_2">youngs_ineq_2</a></span> <span class="id">Hpq</span> <span class="id">t</span> <span class="id">a</span> <span class="id">b</span>) ; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_Rpower">power_Rpower</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="ag_ineq">ag_ineq</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">a</span> -&gt; 0 &lt;= <span class="id">b</span> -&gt;  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id">a</span>*<span class="id">b</span>) &lt;= (<span class="id">a</span>+<span class="id">b</span>)/2.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1793')">Proof.</div>
<div class="proofscript" id="proof1793">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span> <span class="id">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Ha</span> <span class="kwd">as</span> [<span class="id">Hapos</span> | <span class="id">Haz</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hb</span> <span class="kwd">as</span> [<span class="id">Hbpos</span> | <span class="id">Hbz</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_sqrt">Rpower_sqrt</a></span> ; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_mult_distr">Rpower_mult_distr</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdiv_plus_distr">Rdiv_plus_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hpq</span> : 1/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>) + 1/<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> 2 <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>) = 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="id">field</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_youngs_ineq_2">Rpower_youngs_ineq_2</a></span> <span class="id">Hpq</span> 1 <span class="id">a</span> <span class="id">b</span> <span class="id">Hapos</span> <span class="id">Hbpos</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>) ; <span class="tactic">simpl</span> ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (/2) <span class="kwd">with</span> (1/2) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_base_1">Rpower_base_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span> ; <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">subst</span>. <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pow_minkowski_helper_aux">pow_minkowski_helper_aux</a></span> (<span class="id">p</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">a</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : 0 &lt; <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span>*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>(<span class="id">a</span>/<span class="id">t</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>))*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (/<span class="id">t</span>) <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1794')">Proof.</div>
<div class="proofscript" id="proof1794">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#Rpow_mult_distr">Rpow_mult_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pow_minkowski_helper">pow_minkowski_helper</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">a</span> <span class="id">b</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt;= <span class="id">a</span>) -&gt; (0 &lt;= <span class="id">b</span>) -&gt; 0&lt;<span class="id">t</span>&lt;1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (<span class="id">a</span>+<span class="id">b</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)) &lt;= (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (/<span class="id">t</span>) <span class="id">p</span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)) + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (/(1-<span class="id">t</span>)) <span class="id">p</span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">b</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1795')">Proof.</div>
<div class="proofscript" id="proof1795">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span> <span class="id">Hb</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht1</span> : <span class="id">t</span> &lt;&gt; 0) <span class="tactic">by</span> (<span class="tactic">intro</span> <span class="id">not</span>; <span class="tactic">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> [<span class="id">h1</span> <span class="id">h2</span>] ; <span class="tactic">subst</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht2</span> : 1-<span class="id">t</span> &lt;&gt; 0) <span class="tactic">by</span> (<span class="tactic">intro</span> <span class="id">not</span>; <span class="tactic">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> [<span class="id">h1</span> <span class="id">h2</span>] ; <span class="tactic">subst</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hat</span> : 0 &lt;= <span class="id">a</span>/<span class="id">t</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">Rcomplements.Rdiv_le_0_compat</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hbt</span> : 0 &lt;= <span class="id">b</span>/(1-<span class="id">t</span>)) <span class="tactic">by</span>  (<span class="tactic">apply</span> <span class="id">Rcomplements.Rdiv_le_0_compat</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span>' : 0 &lt;= <span class="id">t</span> &lt;= 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span>+<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">t</span>*(<span class="id">a</span>/<span class="id">t</span>) + (1-<span class="id">t</span>)*(<span class="id">b</span>/(1-<span class="id">t</span>))) <span class="tactic">by</span> (<span class="id">field</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#pow_convex">pow_convex</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>) <span class="id">t</span> (<span class="id">a</span>/<span class="id">t</span>) (<span class="id">b</span>/(1-<span class="id">t</span>)) <span class="id">Hat</span> <span class="id">Hbt</span> <span class="id">Ht</span>'); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#pow_minkowski_helper_aux">pow_minkowski_helper_aux</a></span> ; <span class="tactic">try</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pow_minkowski_subst">pow_minkowski_subst</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">a</span>) -&gt; (0 &lt; <span class="id">b</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (/(<span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>))) <span class="id">p</span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (/(1-(<span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>)))) <span class="id">p</span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> <span class="id">b</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span> (<span class="id">a</span> + <span class="id">b</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">p</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1796')">Proof.</div>
<div class="proofscript" id="proof1796">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> &lt;&gt; 0) <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> + <span class="id">b</span> &lt;&gt; 0) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (/ (<span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>))) <span class="kwd">with</span> ((<span class="id">a</span>+<span class="id">b</span>)* (/<span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#Rpow_mult_distr">Rpow_mult_distr</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((/ <span class="id">a</span>) ^ <span class="id">p</span> * (<span class="id">a</span> * <span class="id">a</span> ^ <span class="id">p</span>)) <span class="kwd">with</span> (<span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (/ (1 - <span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>))) <span class="kwd">with</span> ((<span class="id">a</span>+<span class="id">b</span>)/<span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#Rpow_mult_distr">Rpow_mult_distr</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((/ <span class="id">b</span>) ^ <span class="id">p</span> * (<span class="id">b</span> * <span class="id">b</span> ^ <span class="id">p</span>)) <span class="kwd">with</span> (<span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#Rpow_mult_distr">Rpow_mult_distr</a></span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow1">pow1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">field</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span> + <span class="id">b</span> - <span class="id">a</span>) <span class="kwd">with</span> <span class="id">b</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#Rpow_mult_distr">Rpow_mult_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow1">pow1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">field</span>; <span class="id">now</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="minkowski_range">minkowski_range</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">a</span>) -&gt; (0 &lt; <span class="id">b</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>) &lt; 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdiv_lt_0_compat">Rdiv_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id">a</span>+<span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span>) <span class="kwd">with</span> (<span class="id">a</span> + 0) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ineqs">ineqs</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_neg1">Rpower_neg1</a></span> <span class="id">b</span> <span class="id">e</span> : <span class="id">b</span> &lt; 0 -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">b</span> <span class="id">e</span> = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1797')">Proof.</div>
<div class="proofscript" id="proof1797">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span>.<br/>
&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp_0">exp_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_pt_lim_abs_power2</span>' (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;0 &lt;= <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;1 &lt; <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim">derivable_pt_lim</a></span> (<span class="kwd">fun</span> <span class="id">x0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x0</span>) <span class="id">y</span>) <span class="id">x</span> (<span class="id">y</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> (<span class="id">y</span> - 1)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1798')">Proof.</div>
<div class="proofscript" id="proof1798">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span>.<br/>
&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">dpos</span>:0 &lt;  (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">eps</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rinv">Rinv</a></span> (<span class="id">y</span>-1)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_pos">power_pos</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">dpos</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id">Rcomplements.Rabs_eq_0</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_0_r">Rminus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rlt_power_l">Rlt_power_l</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">h</span>) (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">eps</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rinv">Rinv</a></span> (<span class="id">y</span> - 1))) (<span class="id">y</span>-1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult">power_mult</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">HH</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_plus">Rpower_plus</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_Ropp">Rpower_Ropp</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower_1">Rpower_1</a></span> <span class="kwd">in</span> <span class="id">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Rinv">Rabs_Rinv</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">h</span>) <span class="id">y</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rpower_pos">Rpower_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span> <span class="kwd">in</span> <span class="id">n</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#derivable_pt_lim_comp">derivable_pt_lim_comp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">x0</span> 0 <span class="kwd">then</span> 0 <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">x0</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">x</span> (<span class="id">y</span> - 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">intros</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span> <span class="kwd">in</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis4.html#Rabs_derive_1">Rabs_derive_1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">derivable_pt_lim_power</span>' <span class="id">x</span> <span class="id">y</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH</span>; [| <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">HH</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_convex_pos">Rpower_convex_pos</a></span> (<span class="id">e</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;1 &lt;= <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0&lt;<span class="id">x</span> -&gt; 0&lt;<span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">z</span> <span class="id">e</span>) <span class="id">a</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1799')">Proof.</div>
<div class="proofscript" id="proof1799">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ppos_convex_deriv">ppos_convex_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#derivable_pt_lim_power">derivable_pt_lim_power</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#ppos_deriv_incr_convex">ppos_deriv_incr_convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> <span class="id">z</span> <span class="id">e</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#derivable_pt_lim_power">derivable_pt_lim_power</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rle_Rpower_l">Rle_Rpower_l</a></span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rpower_base_0">Rpower_base_0</a></span> <span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span> 0 <span class="id">e</span> = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1800')">Proof.</div>
<div class="proofscript" id="proof1800">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#Rpower">Rpower</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html#ln">ln</a></span>.<br/>
&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#exp_0">exp_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="power_convex_pos">power_convex_pos</a></span> (<span class="id">e</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;1 &lt;= <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0&lt;<span class="id">x</span> -&gt; 0&lt;<span class="id">y</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#convex">convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">z</span> <span class="id">e</span>) <span class="id">a</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1801')">Proof.</div>
<div class="proofscript" id="proof1801">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#ppos_convex_deriv">ppos_convex_deriv</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">derivable_pt_lim_power</span>'.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#ppos_deriv_incr_convex">ppos_deriv_incr_convex</a></span> (<span class="kwd">fun</span> <span class="id">z</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">z</span> <span class="id">e</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id">derivable_pt_lim_power</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rle_power_l">Rle_power_l</a></span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="power_minkowski">power_minkowski</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_minkowski_helper_aux">power_minkowski_helper_aux</a></span> (<span class="id">p</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span>*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id">a</span>/<span class="id">t</span>) <span class="id">p</span>) = (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">p</span>)*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/<span class="id">t</span>) (<span class="id">p</span>-1)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1802')">Proof.</div>
<div class="proofscript" id="proof1802">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_plus">power_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_Ropp">power_Ropp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_involutive">Rinv_involutive</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_neq_0_compat">Rinv_neq_0_compat</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_minkowski_helper_lt">power_minkowski_helper_lt</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">a</span> <span class="id">b</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;<span class="id">t</span>&lt;1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id">a</span>+<span class="id">b</span>) <span class="id">p</span>) &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/<span class="id">t</span>) (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">p</span>) + (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/(1-<span class="id">t</span>)) (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1803')">Proof.</div>
<div class="proofscript" id="proof1803">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span> <span class="id">Hb</span> <span class="id">Ht</span> <span class="id">pbig</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht1</span> : <span class="id">t</span> &lt;&gt; 0) <span class="tactic">by</span> (<span class="tactic">intro</span> <span class="id">not</span>; <span class="tactic">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> [<span class="id">h1</span> <span class="id">h2</span>] ; <span class="tactic">subst</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht2</span> : 1-<span class="id">t</span> &lt;&gt; 0) <span class="tactic">by</span> (<span class="tactic">intro</span> <span class="id">not</span>; <span class="tactic">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> [<span class="id">h1</span> <span class="id">h2</span>] ; <span class="tactic">subst</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hat</span> : 0 &lt; <span class="id">a</span>/<span class="id">t</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">Rcomplements.Rdiv_lt_0_compat</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hbt</span> : 0 &lt; <span class="id">b</span>/(1-<span class="id">t</span>)) <span class="tactic">by</span>  (<span class="tactic">apply</span> <span class="id">Rcomplements.Rdiv_lt_0_compat</span> ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span>' : 0 &lt;= <span class="id">t</span> &lt;= 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span>+<span class="id">b</span>) <span class="kwd">with</span> (<span class="id">t</span>*(<span class="id">a</span>/<span class="id">t</span>) + (1-<span class="id">t</span>)*(<span class="id">b</span>/(1-<span class="id">t</span>))) <span class="tactic">by</span> (<span class="id">field</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power_convex_pos">power_convex_pos</a></span> <span class="id">p</span> <span class="id">pbig</span> (<span class="id">a</span>/<span class="id">t</span>) (<span class="id">b</span>/(1-<span class="id">t</span>)) <span class="id">t</span> <span class="id">Hat</span> <span class="id">Hbt</span> <span class="id">Ht</span>'); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_minkowski_helper_aux">power_minkowski_helper_aux</a></span> ; <span class="tactic">try</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Rmult_bigpos_le_l">Rmult_bigpos_le_l</a></span> <span class="id">a</span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span> &lt;= <span class="id">b</span> * <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1804')">Proof.</div>
<div class="proofscript" id="proof1804">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="id">a</span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_big_big">power_big_big</a></span> <span class="id">a</span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1805')">Proof.</div>
<div class="proofscript" id="proof1805">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">nne</span> <span class="id">pbig</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rle_power">Rle_power</a></span> <span class="id">a</span> 0 <span class="id">e</span> <span class="id">pbig</span> <span class="id">nne</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_O">power_O</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_minkowski_helper">power_minkowski_helper</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">a</span> <span class="id">b</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt;= <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt;= <span class="id">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0&lt;<span class="id">t</span>&lt;1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id">a</span>+<span class="id">b</span>) <span class="id">p</span>) &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/<span class="id">t</span>) (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">p</span>) + (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/(1-<span class="id">t</span>)) (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1806')">Proof.</div>
<div class="proofscript" id="proof1806">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Ha</span> <span class="id">Hb</span> <span class="id">Ht</span> <span class="id">pbig</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">a</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power0_Sbase">power0_Sbase</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmult_bigpos_le_l">Rmult_bigpos_le_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (1 &lt;= / (1 - <span class="id">t</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_1">Rinv_1</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_le_contravar">Rinv_le_contravar</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_big_big">power_big_big</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">b</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power0_Sbase">power0_Sbase</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmult_bigpos_le_l">Rmult_bigpos_le_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (1 &lt;= / <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_1">Rinv_1</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_le_contravar">Rinv_le_contravar</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_big_big">power_big_big</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_minkowski_helper_lt">power_minkowski_helper_lt</a></span>; <span class="tactic">trivial</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_minus1">power_minus1</a></span> <span class="id">b</span> <span class="id">e</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">e</span> = <span class="id">b</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> (<span class="id">e</span>-1).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1807')">Proof.</div>
<div class="proofscript" id="proof1807">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">e</span> <span class="kwd">with</span> ((<span class="id">e</span>-1)+1) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_plus">power_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_minkowski_subst">power_minkowski_subst</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/(<span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>))) (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">p</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/(1-(<span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>)))) (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">p</span>) = (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id">a</span> + <span class="id">b</span>) <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1808')">Proof.</div>
<div class="proofscript" id="proof1808">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> &lt;&gt; 0) <span class="tactic">by</span> <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> + <span class="id">b</span> &lt;&gt; 0) <span class="tactic">by</span> <span class="id">lra</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (/ (<span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>))) <span class="kwd">with</span> ((<span class="id">a</span>+<span class="id">b</span>)* (/<span class="id">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">field</span>; <span class="id">now</span> <span class="tactic">split</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="tactic">by</span> (<span class="tactic">try</span> <span class="id">lra</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/ <span class="id">a</span>) (<span class="id">p</span>-1) * (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">a</span> <span class="id">p</span>)) <span class="kwd">with</span> (<span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">replace</span> (/ (1 - <span class="id">a</span> / (<span class="id">a</span> + <span class="id">b</span>))) <span class="kwd">with</span> ((<span class="id">a</span>+<span class="id">b</span>)/<span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="tactic">by</span> (<span class="tactic">try</span> <span class="id">lra</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/ <span class="id">b</span>) (<span class="id">p</span>-1) * ( <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">b</span> <span class="id">p</span>)) <span class="kwd">with</span> (<span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_minus1">power_minus1</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power_minus1">power_minus1</a></span> <span class="id">b</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-  <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span> <span class="tactic">by</span> (<span class="tactic">try</span> <span class="id">lra</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_base_1">power_base_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span> (<span class="id">a</span>+<span class="id">b</span>)) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span> (<span class="id">a</span>+<span class="id">b</span>) (<span class="id">a</span>+<span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdiv_minus_distr">Rdiv_minus_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; <span class="tactic">try</span> <span class="id">lra</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power_minus1">power_minus1</a></span> <span class="id">a</span> <span class="id">p</span>) <span class="tactic">by</span> <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span> <span class="tactic">by</span> <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="FormalML.utils.RealAdd.html#power_base_1">power_base_1</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_ineq_convex">power_ineq_convex</a></span> <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), 0 &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">y</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id">x</span> + <span class="id">y</span>) <span class="id">p</span> &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 (<span class="id">p</span>-1))*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">x</span> <span class="id">p</span> + <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> <span class="id">y</span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1809')">Proof.</div>
<div class="proofscript" id="proof1809">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">pbig</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= (/2) &lt;= 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power_convex_pos">power_convex_pos</a></span> <span class="id">p</span> <span class="id">pbig</span> <span class="id">x</span> <span class="id">y</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (1 - /2) <span class="kwd">with</span> (/2) <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span> <span class="kwd">in</span> <span class="id">HH</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span> <span class="kwd">with</span> (<span class="id">r</span> := <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 <span class="id">p</span>) <span class="kwd">in</span> <span class="id">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; [| <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 <span class="id">p</span> * <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (/2) <span class="id">p</span>) <span class="kwd">with</span> (1) <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">replace</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 <span class="id">p</span> * (/2)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 (<span class="id">p</span> - 1)) <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="kwd">in</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">replace</span> (/2) <span class="kwd">with</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Ropp">Ropp</a></span> 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_plus">power_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_Ropp">power_Ropp</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_1">power_1</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * /2) <span class="kwd">with</span> (1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_base_1">power_base_1</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="power_abs_ineq">power_abs_ineq</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span> + <span class="id">y</span>)) <span class="id">p</span> &lt;= (<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> 2 <span class="id">p</span>)*(<span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) <span class="id">p</span> + <span class="id"><a href="FormalML.utils.RealAdd.html#power">power</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span>) <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1810')">Proof.</div>
<div class="proofscript" id="proof1810">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">pnneg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">m</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eqq</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span> + <span class="id">y</span>) &lt;= 2*<span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">Rcomplements.Rplus_le_Rmax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rle_power_l">Rle_power_l</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span> + <span class="id">y</span>)) (2 * <span class="id">m</span>) <span class="id">p</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="FormalML.utils.RealAdd.html#power_mult_distr">power_mult_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">m</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) <span class="id">p</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#power_nonneg">power_nonneg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">y</span>) <span class="id">p</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id">m</span>; <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; [| <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_l">Rmax_l</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#power_minkowski">power_minkowski</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rbar_pos_finite">Rbar_pos_finite</a></span> (<span class="id">r</span> : <span class="id">Rbar</span>):<br/>
&nbsp;&nbsp;0 &lt; <span class="id">r</span> -&gt; <span class="id">is_finite</span> <span class="id">r</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1811')">Proof.</div>
<div class="proofscript" id="proof1811">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">is_finite</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="prod_f_R0_proper">prod_f_R0_proper</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#pointwise_relation">pointwise_relation</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rprod.html#prod_f_R0">prod_f_R0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1812')">Proof.</div>
<div class="proofscript" id="proof1812">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">feqq</span> <span class="id">N</span> <span class="id">N</span>' <span class="id">xeqq</span>; <span class="tactic">subst</span> <span class="id">N</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">N</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bounded_is_finite">bounded_is_finite</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">x</span> : <span class="id">Rbar</span>) :<br/>
&nbsp;&nbsp;<span class="id">Rbar_le</span> <span class="id">a</span> <span class="id">x</span> -&gt; <span class="id">Rbar_le</span> <span class="id">x</span> <span class="id">b</span> -&gt; <span class="id">is_finite</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1813')">Proof.</div>
<div class="proofscript" id="proof1813">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">is_finite</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
Qed.</div>
<span class="kwd">Section</span> <span class="id"><a name="Rmax_list">Rmax_list</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">R_scope</span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Rmax_list">Rmax_list</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0<br/>
&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">l1</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">a</span> (<span class="id">Rmax_list</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_spec_map">Rmax_spec_map</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="kwd">forall</span> <span class="id">a</span>:<span class="id">A</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">a</span> <span class="id">l</span> -&gt; <span class="id">f</span> <span class="id">a</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1814')">Proof.</div>
<div class="proofscript" id="proof1814">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">l</span>. <span class="tactic">simpl</span>. <span class="id">right</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_l">Rmax_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">l</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_r">Rmax_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_spec">Rmax_spec</a></span> {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} : <span class="kwd">forall</span> <span class="id">a</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">a</span> <span class="id">l</span> -&gt; <span class="id">a</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1815')">Proof.</div>
<div class="proofscript" id="proof1815">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">l</span>. <span class="tactic">simpl</span>. <span class="id">right</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_l">Rmax_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">l</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_r">Rmax_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_map_const_mul">Rmax_list_map_const_mul</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">hr</span> : 0 &lt;= <span class="id">r</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">r</span>*<span class="id">f</span>(<span class="id">a</span>)) <span class="id">l</span>) = <span class="id">r</span>*(<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1816')">Proof.</div>
<div class="proofscript" id="proof1816">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#RmaxRmult">RmaxRmult</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">f_equal</span> ; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_const_add">Rmax_list_const_add</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">d</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">x</span> + <span class="id">d</span>) <span class="id">l</span>) =<br/>
&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">l</span> &lt;&gt; []) <span class="kwd">then</span> ((<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span>) + <span class="id">d</span>) <span class="kwd">else</span> 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1817')">Proof.</div>
<div class="proofscript" id="proof1817">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> * ; <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Rcomplements.Rplus_max_distr_r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_zero">Rmax_list_zero</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; 0) <span class="id">l</span>) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1818')">Proof.</div>
<div class="proofscript" id="proof1818">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> 0 0) <span class="kwd">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span> ; [<span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span> | <span class="tactic">simpl</span> ; <span class="tactic">reflexivity</span>] .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span> ; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_ge">Rmax_list_ge</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">r</span> &lt;= <span class="id">x</span> -&gt; <span class="id">r</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1819')">Proof.</div>
<div class="proofscript" id="proof1819">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span> <span class="id">Hrx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_le">Rmax_list_le</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span> &lt;= <span class="id">r</span> -&gt; <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">x</span> &lt;= <span class="id">r</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1820')">Proof.</div>
<div class="proofscript" id="proof1820">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span> <span class="id">x</span> <span class="id">Hx</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_In">Rmax_list_In</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;([] &lt;&gt; <span class="id">l</span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1821')">Proof.</div>
<div class="proofscript" id="proof1821">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">assert</span> ([] &lt;&gt; <span class="id">r</span> :: <span class="id">l</span>)  <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil_cons">nil_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H0</span>) ; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">r</span> :: <span class="id">l</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span>. <span class="id">now</span> <span class="id">right</span> ; <span class="tactic">assumption</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span>. <span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.ROrderedType.html#ROrder.not_ge_lt">ROrder.not_ge_lt</a></span> ; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_lub">Rmax_list_lub</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;([] &lt;&gt; <span class="id">l</span>) -&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">x</span> &lt;= <span class="id">r</span>) -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span> &lt;= <span class="id">r</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1822')">Proof.</div>
<div class="proofscript" id="proof1822">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hl</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_In">Rmax_list_In</a></span> ; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_le_iff">Rmax_list_le_iff</a></span> {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">hl</span> : [] &lt;&gt; <span class="id">l</span>) (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span> &lt;= <span class="id">r</span> &lt;-&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">x</span> &lt;= <span class="id">r</span>)  .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1823')">Proof.</div>
<div class="proofscript" id="proof1823">
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le">Rmax_list_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_lub">Rmax_list_lub</a></span> ; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_lt_iff">Rmax_list_lt_iff</a></span> {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>} (<span class="id">hl</span> : [] &lt;&gt; <span class="id">l</span>) (<span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l</span> &lt; <span class="id">r</span> &lt;-&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">x</span> &lt; <span class="id">r</span>)  .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1824')">Proof.</div>
<div class="proofscript" id="proof1824">
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">intros</span> <span class="id">Hr</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span> ; <span class="tactic">eauto</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">intro</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H</span> ; <span class="tactic">auto</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_In">Rmax_list_In</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Rmax_list_incl">Rmax_list_incl</a></span> <span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> &lt;&gt; <span class="id">l1</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l1</span> &lt;= <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1825')">Proof.</div>
<div class="proofscript" id="proof1825">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span><br/>
&nbsp;&nbsp;; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Rmax_list_equivlist">Rmax_list_equivlist</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#equivlist">equivlist</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1826')">Proof.</div>
<div class="proofscript" id="proof1826">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">equivs</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">equivs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#equivlist_nil">equivlist_nil</a></span> <span class="kwd">in</span> <span class="id">equivs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#equivlist_nil">equivlist_nil</a></span> <span class="kwd">in</span> <span class="id">equivs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#equivlist_incls">equivlist_incls</a></span> <span class="kwd">in</span> <span class="id">equivs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">equivs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_incl">Rmax_list_incl</a></span> (<span class="id">r</span>::<span class="id">x</span>) (<span class="id">r0</span>::<span class="id">y</span>)); <span class="tactic">intros</span> <span class="id">HH1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_incl">Rmax_list_incl</a></span> (<span class="id">r0</span>::<span class="id">y</span>) (<span class="id">r</span>::<span class="id">x</span>)); <span class="tactic">intros</span> <span class="id">HH2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH1</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cut_to</span> <span class="id">HH2</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_sum">Rmax_list_sum</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} (<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">Hla</span> : [] &lt;&gt; <span class="id">la</span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id">f</span> <span class="id">a</span>) <span class="id">lb</span>)) <span class="id">la</span>) &lt;=<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) <span class="id">la</span>)) <span class="id">lb</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1827')">Proof.</div>
<div class="proofscript" id="proof1827">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;* <span class="tactic">intro</span> <span class="id">x</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">x0</span> [<span class="id">Hlsx</span> <span class="id">Hin</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hlsx</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_le">list_sum_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">b</span>. <span class="tactic">apply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec_map">Rmax_spec_map</a></span> <span class="id">la</span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) <span class="id">x0</span> <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_cons_cons">Rmax_list_cons_cons</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">a</span> :: <span class="id">b</span> :: <span class="id">l</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">a</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">b</span> :: <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1828')">Proof.</div>
<div class="proofscript" id="proof1828">
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_Rmax_swap">Rmax_list_Rmax_swap</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">a</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">b</span> :: <span class="id">l</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> <span class="id">b</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">a</span> :: <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1829')">Proof.</div>
<div class="proofscript" id="proof1829">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_comm">Rmax_comm</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_cons_cons">Rmax_list_cons_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_assoc">Rmax_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_comm">Rmax_comm</a></span> <span class="id">_</span> <span class="id">b</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_cons">Rmax_list_cons</a></span> (<span class="id">x0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)  (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">l1</span> <span class="id">l2</span> -&gt; (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l1</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l2</span>) -&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">x0</span> :: <span class="id">l1</span>) = <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span>(<span class="id">x0</span> :: <span class="id">l2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1830')">Proof.</div>
<div class="proofscript" id="proof1830">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hpl</span> <span class="id">Hrl</span>.<br/>
&nbsp;&nbsp;<span class="id">case_eq</span> <span class="id">l1</span>.<br/>
&nbsp;&nbsp;* <span class="tactic">intro</span> <span class="id">Hl</span>. <span class="tactic">rewrite</span> <span class="id">Hl</span> <span class="kwd">in</span> <span class="id">Hpl</span>. <span class="tactic">set</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_nil">Permutation_nil</a></span> <span class="id">Hpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;* <span class="id">case_eq</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intro</span> <span class="id">Hl2</span>. <span class="tactic">rewrite</span> <span class="id">Hl2</span> <span class="kwd">in</span> <span class="id">Hpl</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Hpl</span>. <span class="tactic">set</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_nil">Permutation_nil</a></span> <span class="id">Hpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span> <span class="id">r</span> <span class="id">l</span> <span class="id">H</span> <span class="id">r0</span> <span class="id">l0</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">H0</span>, &lt;-<span class="id">H</span>. <span class="tactic">simpl</span> ; <span class="tactic">rewrite</span> <span class="id">Hrl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H0</span>, <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_cons_swap">Rmax_list_cons_swap</a></span> (<span class="id">x0</span> <span class="id">y0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)  (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id">l1</span> <span class="id">l2</span> -&gt; (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l1</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">l2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id">x0</span> :: <span class="id">y0</span> :: <span class="id">l1</span>) = <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span>(<span class="id">y0</span> :: <span class="id">x0</span> :: <span class="id">l2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1831')">Proof.</div>
<div class="proofscript" id="proof1831">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hpl</span> <span class="id">Hrl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_cons_cons">Rmax_list_cons_cons</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_Rmax_swap">Rmax_list_Rmax_swap</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_cons_cons">Rmax_list_cons_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">case_eq</span> <span class="id">l1</span>.<br/>
&nbsp;&nbsp;* <span class="tactic">intro</span> <span class="id">Hl</span>. <span class="tactic">rewrite</span> <span class="id">Hl</span> <span class="kwd">in</span> <span class="id">Hpl</span>. <span class="tactic">set</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_nil">Permutation_nil</a></span> <span class="id">Hpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;* <span class="id">case_eq</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intro</span> <span class="id">Hl2</span>. <span class="tactic">rewrite</span> <span class="id">Hl2</span> <span class="kwd">in</span> <span class="id">Hpl</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Hpl</span>. <span class="tactic">set</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_nil">Permutation_nil</a></span> <span class="id">Hpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">intros</span> <span class="id">r</span> <span class="id">l</span> <span class="id">H</span> <span class="id">r0</span> <span class="id">l0</span> <span class="id">H0</span>.  <span class="tactic">rewrite</span> &lt;-<span class="id">H0</span>, &lt;-<span class="id">H</span>. <span class="tactic">simpl</span> ; <span class="tactic">rewrite</span> <span class="id">Hrl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H0</span>, <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Rmax_list_Proper">Rmax_list_Proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> ++&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1832')">Proof.</div>
<div class="proofscript" id="proof1832">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_ind_bis">Permutation_ind_bis</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">a</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> <span class="id">b</span>)).<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span> ; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x0</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_cons">Rmax_list_cons</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">H0</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_cons_swap">Rmax_list_cons_swap</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">l</span>'' <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H3</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Rmax_list_map">Rmax_list_map</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) := <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>).<br/>
<br/>
<span class="id">Declare</span> <span class="kwd">Scope</span> <span class="id">rmax_scope</span>.<br/>
<span class="kwd">Notation</span> "<span class="id">Max_</span>{ <span class="id">l</span> } ( <span class="id">f</span> )" := (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>)) (<span class="tactic">at</span> <span class="id">level</span> 50) : <span class="id">rmax_scope</span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">rmax_scope</span>.<br/>
<span class="kwd">Delimit</span> <span class="kwd">Scope</span> <span class="id">rmax_scope</span> <span class="kwd">with</span> <span class="id">rmax</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_map_exist">Rmax_list_map_exist</a></span> {<span class="id">A</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;[] &lt;&gt; <span class="id">l</span> -&gt; <span class="id">exists</span> <span class="id">a</span>:<span class="id">A</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">a</span> <span class="id">l</span> /\ <span class="id">f</span> <span class="id">a</span> = <span class="id">Max_</span>{<span class="id">l</span>}(<span class="id">f</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1833')">Proof.</div>
<div class="proofscript" id="proof1833">
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hne</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hmap</span> := <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_In">Rmax_list_In</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-(<span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span> <span class="id">l</span> <span class="id">f</span>) <span class="kwd">in</span> <span class="id">Hne</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hmap</span> <span class="id">Hne</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hmap</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmap</span> <span class="kwd">as</span>  [<span class="id">a</span> [<span class="id">Hfa</span> <span class="id">Hin</span>]].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> <span class="id">a</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exists_in_strengthen_dec">exists_in_strengthen_dec</a></span> {<span class="id">A</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) <span class="id">l</span> (<span class="id">dec</span>:<span class="kwd">forall</span> <span class="id">x</span>, {<span class="id">P</span> <span class="id">x</span>} + {~ <span class="id">P</span> <span class="id">x</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ex</span>:<span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> /\ <span class="id">P</span> <span class="id">x</span>) : {<span class="id">x</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l</span> /\ <span class="id">P</span> <span class="id">x</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1834')">Proof.</div>
<div class="proofscript" id="proof1834">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ex</span> ; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">IHl</span> <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">inx</span> <span class="id">px</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> <span class="id">ex</span> <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">inx</span> <span class="id">px</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">inx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_map_exist_sig">Rmax_list_map_exist_sig</a></span> {<span class="id">A</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} :<br/>
&nbsp;&nbsp;[] &lt;&gt; <span class="id">l</span> -&gt; { <span class="id">a</span>:<span class="id">A</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">a</span> <span class="id">l</span> /\ <span class="id">f</span> <span class="id">a</span> = <span class="id">Max_</span>{<span class="id">l</span>}(<span class="id">f</span>)}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1835')">Proof.</div>
<div class="proofscript" id="proof1835">
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hne</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#exists_in_strengthen_dec">exists_in_strengthen_dec</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">x</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="argmax">argmax</a></span> {<span class="id">A</span>} {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} (<span class="id">hl</span> : [] &lt;&gt; <span class="id">l</span>)(<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : <span class="id">A</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist_sig">Rmax_list_map_exist_sig</a></span> <span class="id">f</span> <span class="id">hl</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="argmax_is_max">argmax_is_max</a></span> {<span class="id">A</span>} {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} (<span class="id">hl</span> : [] &lt;&gt; <span class="id">l</span>) (<span class="id">f</span> : <span class="id">A</span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">f</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#argmax">argmax</a></span> <span class="id">hl</span> <span class="id">f</span>) = <span class="id">Max_</span>{<span class="id">l</span>}(<span class="id">f</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1836')">Proof.</div>
<div class="proofscript" id="proof1836">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#argmax">argmax</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist_sig">Rmax_list_map_exist_sig</a></span> <span class="id">f</span> <span class="id">hl</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">a</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="argmax_in_list">argmax_in_list</a></span> {<span class="id">A</span>} {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} (<span class="id">hl</span> : [] &lt;&gt; <span class="id">l</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FormalML.utils.RealAdd.html#argmax">argmax</a></span> <span class="id">hl</span> <span class="id">f</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1837')">Proof.</div>
<div class="proofscript" id="proof1837">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#argmax">argmax</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist_sig">Rmax_list_map_exist_sig</a></span> <span class="id">f</span> <span class="id">hl</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">a</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Rmax_eq_Proper">Rmax_eq_Proper</a></span> {<span class="id">A</span>} {<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} (<span class="id">hl</span> : [] &lt;&gt; <span class="id">l</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#pointwise_relation">pointwise_relation</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ++&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) (@<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map">Rmax_list_map</a></span> <span class="id">A</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1838')">Proof.</div>
<div class="proofscript" id="proof1838">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#pointwise_relation">pointwise_relation</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map">Rmax_list_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHl</span>. <span class="tactic">rewrite</span> <span class="id">IHl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil_cons">nil_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_prod_le">Rmax_list_prod_le</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hla</span> : [] &lt;&gt; <span class="id">la</span>) (<span class="id">Hlb</span> : [] &lt;&gt; <span class="id">lb</span>) :<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">Max_</span>{<span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>)) =<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list_prod">list_prod</a></span> <span class="id">la</span> <span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1839')">Proof.</div>
<div class="proofscript" id="proof1839">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>.<br/>
&nbsp;&nbsp;++  <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>. <span class="tactic">eapply</span> (@<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Hx</span>' <span class="id">HInx</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hmax</span> := <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) <span class="id">lb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hmax</span> <span class="id">Hlb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmax</span> <span class="kwd">as</span> [<span class="id">b</span> <span class="id">Hb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">a</span>,<span class="id">b</span>). <span class="tactic">simpl</span>. <span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hx</span>' |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_prod">in_prod</a></span> ; <span class="tactic">trivial</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">now</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>.<br/>
&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [<span class="id">ab</span> [<span class="id">Hab</span> <span class="id">HInab</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (@<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">b</span> : <span class="id">B</span> =&gt; <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>) <span class="id">b</span>) <span class="id">lb</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>). <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> <span class="kwd">in</span> <span class="id">HInab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_prod_iff">in_prod_iff</a></span> <span class="kwd">in</span> <span class="id">HInab</span>. <span class="tactic">destruct</span> <span class="id">HInab</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">eapply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+++ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>). <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> <span class="kwd">in</span> <span class="id">HInab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_prod_iff">in_prod_iff</a></span> <span class="kwd">in</span> <span class="id">HInab</span>. <span class="tactic">destruct</span> <span class="id">HInab</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+++ <span class="tactic">rewrite</span> &lt;-<span class="id">Hab</span>. <span class="id">right</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#list_prod_not_nil">list_prod_not_nil</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Rmax_list_prod_le</span>' {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hla</span> : [] &lt;&gt; <span class="id">la</span>) (<span class="id">Hlb</span> : [] &lt;&gt; <span class="id">lb</span>) :<br/>
&nbsp;&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">lb</span>}(<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>))  =<br/>
&nbsp;&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list_prod">list_prod</a></span> <span class="id">la</span> <span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1840')">Proof.</div>
<div class="proofscript" id="proof1840">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>.<br/>
&nbsp;&nbsp;++  <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>. <span class="tactic">eapply</span> (@<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [<span class="id">b</span> [<span class="id">Hx</span>' <span class="id">HInx</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">Hmax</span> := <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) <span class="id">la</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hmax</span> <span class="id">Hla</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmax</span> <span class="kwd">as</span> [<span class="id">a</span> <span class="id">Ha</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">a</span>,<span class="id">b</span>). <span class="tactic">simpl</span>. <span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">rewrite</span> &lt;-<span class="id">Hx</span>' |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_prod">in_prod</a></span> ; <span class="tactic">trivial</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">now</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>.<br/>
&nbsp;&nbsp;++ <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [<span class="id">ab</span> [<span class="id">Hab</span> <span class="id">HInab</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (@<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> : <span class="id">A</span>  =&gt; <span class="id">f</span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>)) <span class="id">la</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>). <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> <span class="kwd">in</span> <span class="id">HInab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_prod_iff">in_prod_iff</a></span> <span class="kwd">in</span> <span class="id">HInab</span>. <span class="tactic">destruct</span> <span class="id">HInab</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">eapply</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+++ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>). <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#surjective_pairing">surjective_pairing</a></span> <span class="kwd">in</span> <span class="id">HInab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_prod_iff">in_prod_iff</a></span> <span class="kwd">in</span> <span class="id">HInab</span>. <span class="tactic">destruct</span> <span class="id">HInab</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+++ <span class="tactic">rewrite</span> &lt;-<span class="id">Hab</span>. <span class="id">right</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#list_prod_not_nil">list_prod_not_nil</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_map_comm">Rmax_list_map_comm</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hla</span> : [] &lt;&gt; <span class="id">la</span>) (<span class="id">Hlb</span> : [] &lt;&gt; <span class="id">lb</span>) :<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">Max_</span>{<span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>)) = <span class="id">Max_</span>{<span class="id">lb</span>}(<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>)) .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1841')">Proof.</div>
<div class="proofscript" id="proof1841">
&nbsp;&nbsp;<span class="id">etransitivity</span>; [|<span class="tactic">symmetry</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_prod_le">Rmax_list_prod_le</a></span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Rmax_list_prod_le</span>'; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_prod_combine">Rmax_list_prod_combine</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hla</span> : [] &lt;&gt; <span class="id">la</span>) (<span class="id">Hlb</span> : [] &lt;&gt; <span class="id">lb</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#equivlist">equivlist</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list_prod">list_prod</a></span> <span class="id">la</span> <span class="id">lb</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">la</span> <span class="id">lb</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">Max_</span>{<span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>))  =<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id">la</span> <span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">ab</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">ab</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1842')">Proof.</div>
<div class="proofscript" id="proof1842">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_prod_le">Rmax_list_prod_le</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_minus_le">Rmax_list_minus_le</a></span> {<span class="id">A</span>} {<span class="id">B</span> : <span class="id">A</span> -&gt; <span class="kwd">Type</span>} (<span class="id">f</span> <span class="id">g</span> : <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">B</span> <span class="id">a</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">la</span> : <span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">B</span> <span class="id">a</span>)):<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">a</span>:<span class="id">A</span>, (<span class="id">Max_</span>{<span class="id">la</span> <span class="id">a</span>}(<span class="id">f</span> <span class="id">a</span>) - <span class="id">Max_</span>{<span class="id">la</span> <span class="id">a</span>}(<span class="id">g</span> <span class="id">a</span>)) &lt;= <span class="id">Max_</span>{<span class="id">la</span> <span class="id">a</span>}(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">a</span> <span class="id">x</span> - <span class="id">g</span> <span class="id">a</span> <span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1843')">Proof.</div>
<div class="proofscript" id="proof1843">
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#is_nil_dec">is_nil_dec</a></span> (<span class="id">la</span> <span class="id">a0</span>)).<br/>
&nbsp;&nbsp;- <span class="tactic">setoid_rewrite</span> <span class="id">e</span>. <span class="tactic">simpl</span>. <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Rcomplements.Rle_minus_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>. <span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]]. <span class="tactic">rewrite</span> &lt;-<span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">a0</span> <span class="id">a</span>) <span class="kwd">with</span> ((<span class="id">f</span> <span class="id">a0</span> <span class="id">a</span> - <span class="id">g</span> <span class="id">a0</span> <span class="id">a</span>) + <span class="id">g</span> <span class="id">a0</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_minus_le_abs">Rmax_list_minus_le_abs</a></span> {<span class="id">A</span>} (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">Max_</span>{<span class="id">la</span>}(<span class="id">f</span>) - <span class="id">Max_</span>{<span class="id">la</span>}(<span class="id">g</span>)) &lt;= <span class="id">Max_</span>{<span class="id">la</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>(<span class="id">f</span> <span class="id">a</span> - <span class="id">g</span> <span class="id">a</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1844')">Proof.</div>
<div class="proofscript" id="proof1844">
&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#is_nil_dec">is_nil_dec</a></span> <span class="id">la</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>; <span class="tactic">simpl</span>. <span class="tactic">replace</span> (0-0) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">ring</span>. <span class="id">right</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Rcomplements.Rabs_le_between</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">Rcomplements.Rle_minus_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span> ; [| <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span> ; <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]]. <span class="tactic">rewrite</span> &lt;-<span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">g</span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">f</span> <span class="id">a</span> + (<span class="id">g</span> <span class="id">a</span> - <span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="id">first</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span> ; [| <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span> ; <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]]. <span class="tactic">rewrite</span> &lt;-<span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">g</span> <span class="id">a</span> + (<span class="id">f</span> <span class="id">a</span> - <span class="id">g</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="id">first</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Rmax_list_minus_le_abs</span>' {<span class="id">A</span>} {<span class="id">B</span> : <span class="id">A</span> -&gt; <span class="kwd">Type</span>} (<span class="id">f</span> <span class="id">g</span> : <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">B</span> <span class="id">a</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">la</span> : <span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">B</span> <span class="id">a</span>)):<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">a</span>:<span class="id">A</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">Max_</span>{<span class="id">la</span> <span class="id">a</span>}(<span class="id">f</span> <span class="id">a</span>) - <span class="id">Max_</span>{<span class="id">la</span> <span class="id">a</span>}(<span class="id">g</span> <span class="id">a</span>)) &lt;= <span class="id">Max_</span>{<span class="id">la</span> <span class="id">a</span>}(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>(<span class="id">f</span> <span class="id">a</span> <span class="id">x</span> - <span class="id">g</span> <span class="id">a</span> <span class="id">x</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1845')">Proof.</div>
<div class="proofscript" id="proof1845">
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#is_nil_dec">is_nil_dec</a></span> (<span class="id">la</span> <span class="id">a0</span>)).<br/>
&nbsp;&nbsp;- <span class="tactic">setoid_rewrite</span> <span class="id">e</span>. <span class="tactic">simpl</span>. <span class="tactic">replace</span> (0-0) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">ring</span>. <span class="id">right</span>. <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Rcomplements.Rabs_le_between</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id">Rcomplements.Rle_minus_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span> ; [| <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span> ; <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]]. <span class="tactic">rewrite</span> &lt;-<span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">g</span> <span class="id">a0</span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">f</span> <span class="id">a0</span> <span class="id">a</span> + (<span class="id">g</span> <span class="id">a0</span> <span class="id">a</span> - <span class="id">f</span> <span class="id">a0</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="id">first</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span> ; [| <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span> ; <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]]. <span class="tactic">rewrite</span> &lt;-<span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">a0</span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">g</span> <span class="id">a0</span> <span class="id">a</span> + (<span class="id">f</span> <span class="id">a0</span> <span class="id">a</span> - <span class="id">g</span> <span class="id">a0</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> ; <span class="id">first</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_fun_swap">Rmax_list_fun_swap</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">lf</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span>(<span class="id">A</span> -&gt; <span class="id">B</span>)}{<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">g</span> :<span class="id">B</span> -&gt; (<span class="id">A</span> -&gt; <span class="id">B</span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hl</span> : [] &lt;&gt; <span class="id">lf</span>) (<span class="id">hla</span> : [] &lt;&gt; <span class="id">la</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id">Max_</span>{<span class="id">lf</span>} (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id">g</span> (<span class="id">f</span> <span class="id">s</span>) <span class="id">f</span>))  =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">lf</span>} (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id">Max_</span>{<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> <span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">g</span> <span class="id">b</span> <span class="id">f</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1846')">Proof.</div>
<div class="proofscript" id="proof1846">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_comm">Rmax_list_map_comm</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_le_range">Rmax_list_le_range</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) (<span class="id">g</span> : <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hla</span> : [] &lt;&gt; <span class="id">la</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hf</span> : <span class="kwd">forall</span> {<span class="id">a</span>}, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">a</span> <span class="id">la</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">f</span> <span class="id">a</span>) <span class="id">lb</span>) :<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">g</span>(<span class="id">f</span> <span class="id">a</span>)) &lt;= <span class="id">Max_</span>{<span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">g</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1847')">Proof.</div>
<div class="proofscript" id="proof1847">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;-- <span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_ge">Rmax_list_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="id">exists</span> (<span class="id">f</span> <span class="id">a</span>). <span class="tactic">split</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;-- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Rmax_list_le_range</span>' {<span class="id">A</span> <span class="id">B</span>} (<span class="id">g</span> : <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">lf</span> {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hlf</span> : [] &lt;&gt; <span class="id">lf</span>){<span class="id">a</span> : <span class="id">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hfa</span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id">f</span> <span class="id">a</span>) <span class="id">lb</span>)  :<br/>
&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">lf</span>} (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id">g</span>(<span class="id">f</span> <span class="id">a</span>)) &lt;= <span class="id">Max_</span>{<span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">g</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1848')">Proof.</div>
<div class="proofscript" id="proof1848">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">f</span> =&gt; <span class="id">g</span> (<span class="id">f</span> <span class="id">a</span>)) <span class="id">lf</span> <span class="id">hlf</span>) <span class="kwd">as</span> [<span class="id">f</span> [<span class="id">Hf</span> <span class="id">Hinf</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hinf</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec_map">Rmax_spec_map</a></span>. <span class="tactic">apply</span> <span class="id">hfa</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_fun_le">Rmax_list_fun_le</a></span> {<span class="id">A</span>} {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">f</span> <span class="id">a</span> &lt;= <span class="id">g</span> <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span>) &lt;= <span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">g</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1849')">Proof.</div>
<div class="proofscript" id="proof1849">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hfg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.lib_utils.LibUtilsListAdd.html#is_nil_dec">is_nil_dec</a></span> <span class="id">la</span>) ; [<span class="tactic">subst</span> ; <span class="tactic">simpl</span> ; <span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n</span>' : [] &lt;&gt; <span class="id">la</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">g</span> <span class="id">a</span>) <span class="id">la</span> <span class="id">n</span>') <span class="kwd">as</span> [<span class="id">a1</span> [<span class="id">Ha1</span> <span class="id">Hina1</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span>) <span class="id">la</span> <span class="id">n</span>') <span class="kwd">as</span> [<span class="id">a2</span> [<span class="id">Ha2</span> <span class="id">Hina2</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hina1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [<span class="id">a0</span> [<span class="id">ha0</span> <span class="id">hina0</span>]]. <span class="tactic">rewrite</span> &lt;-<span class="id">ha0</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">f</span> <span class="id">a0</span> &lt;= <span class="id">f</span> <span class="id">a2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a2</span> &lt;= <span class="id">g</span> <span class="id">a2</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">Hfg</span>).<br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">g</span> <span class="id">a2</span> &lt;= <span class="id">g</span> <span class="id">a1</span>).<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hina1</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="id">exists</span> <span class="id">a2</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hina2</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="id">exists</span> <span class="id">a0</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Rmax_list_fun_le</span>' {<span class="id">A</span> <span class="id">B</span>} {<span class="id">la</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>} {<span class="id">lb</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">g</span> : <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">hla</span> : [] &lt;&gt; <span class="id">la</span>) (<span class="id">hlb</span> : [] &lt;&gt; <span class="id">lb</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">f</span> <span class="id">a</span> &lt;= <span class="id">g</span> <span class="id">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Max_</span>{<span class="id">la</span>} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span>) &lt;= <span class="id">Max_</span>{<span class="id">lb</span>} (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">g</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1850')">Proof.</div>
<div class="proofscript" id="proof1850">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hfg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id">g</span> <span class="id">b</span>) <span class="id">lb</span> <span class="id">hlb</span>) <span class="kwd">as</span> [<span class="id">b</span> [<span class="id">Hb</span> <span class="id">Hinb</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">f</span> <span class="id">a</span>) <span class="id">la</span> <span class="id">hla</span>) <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha</span> <span class="id">Hina</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Hinb</span>, &lt;-<span class="id">Hina</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hfg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_map_transf">Rmax_list_map_transf</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">f</span>' : <span class="id">B</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) :<br/>
&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">List.Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span>'(<span class="id">g</span> <span class="id">x</span>)) <span class="id">l</span>) -&gt; <span class="id">Max_</span>{<span class="id">l</span>}(<span class="id">f</span>) = <span class="id">Max_</span>{<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">g</span> <span class="id">l</span>}(<span class="id">f</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1851')">Proof.</div>
<div class="proofscript" id="proof1851">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext_in">List.map_ext_in</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fin_fun_bounded">fin_fun_bounded</a></span> {<span class="id">A</span>} (<span class="id">finA</span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : {<span class="id">D</span> | <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">f</span> <span class="id">a</span> &lt;= <span class="id">D</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1852')">Proof.</div>
<div class="proofscript" id="proof1852">
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">Max_</span>{@<span class="id"><a href="FormalML.utils.Finite.html#elms">elms</a></span> <span class="id">_</span> <span class="id">finA</span>}(<span class="id">f</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span> ; <span class="tactic">split</span> ; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">finA</span> ; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fin_fun_bounded_Rabs">fin_fun_bounded_Rabs</a></span> {<span class="id">A</span>} (<span class="id">finA</span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : { <span class="id">D</span> | <span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>(<span class="id">f</span> <span class="id">a</span>) &lt;= <span class="id">D</span> }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1853')">Proof.</div>
<div class="proofscript" id="proof1853">
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">Max_</span>{@<span class="id"><a href="FormalML.utils.Finite.html#elms">elms</a></span> <span class="id">_</span> <span class="id">finA</span>}(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Finite.html#finite">finite</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list">Rmax_list</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="seq_iota_seq">seq_iota_seq</a></span> <span class="id">m</span> <span class="id">n</span> : <span class="id">seq.iota</span> <span class="id">m</span> <span class="id">n</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> <span class="id">m</span> <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1854')">Proof.</div>
<div class="proofscript" id="proof1854">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sum_n_m_fold_right_seq">sum_n_m_fold_right_seq</a></span> (<span class="id">f</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">n</span> <span class="id">m</span>:<br/>
&nbsp;&nbsp;<span class="id">sum_n_m</span> (<span class="kwd">fun</span> <span class="id">n0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">f</span> <span class="id">n0</span>) <span class="id">m</span> <span class="id">n</span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id">m</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1855')">Proof.</div>
<div class="proofscript" id="proof1855">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n_m</span>, <span class="id">Iter.iter_nat</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#seq_iota_seq">seq_iota_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> - <span class="id">m</span>)%<span class="id">nat</span>; <span class="tactic">intros</span> <span class="id">nn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">nn</span>; <span class="tactic">unfold</span> <span class="id">plus</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">IHnn</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sum_n_fold_right_seq">sum_n_fold_right_seq</a></span> (<span class="id">f</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">n</span> :<br/>
&nbsp;&nbsp;<span class="id">sum_n</span> (<span class="kwd">fun</span> <span class="id">n0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">f</span> <span class="id">n0</span>) <span class="id">n</span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1856')">Proof.</div>
<div class="proofscript" id="proof1856">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sum_n</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#sum_n_m_fold_right_seq">sum_n_m_fold_right_seq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_sum_sum_n">list_sum_sum_n</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> <span class="id">l</span> =<br/>
&nbsp;&nbsp;@<span class="id">Hierarchy.sum_n</span> <span class="id">Hierarchy.R_AbelianGroup</span> (<span class="kwd">fun</span> <span class="id">i</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">l</span> <span class="id">i</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span> =&gt; <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 0%<span class="id">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1857')">Proof.</div>
<div class="proofscript" id="proof1857">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#sum_n_fold_right_seq">sum_n_fold_right_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span>  <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_fold_right">list_sum_fold_right</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_shift">seq_shift</a></span> <span class="id">_</span> 2).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#fold_right_ext">fold_right_ext</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
