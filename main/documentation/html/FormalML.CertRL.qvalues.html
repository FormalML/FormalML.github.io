
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.CertRL.qvalues</title>
<meta name="description" content="Documentation of Coq module FormalML.CertRL.qvalues" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.CertRL.qvalues</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.CertRL.mdp.html">mdp</a></span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html">fixed_point</a></span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html">pmf_monad</a></span> <span class="id"><a href="FormalML.utils.Finite.html">Finite</a></span> <span class="id"><a href="FormalML.utils.ListAdd.html">ListAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">Coq.Lists.List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">micromega.Lra</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.RealAdd.html">RealAdd</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<span class="kwd">Set</span> <span class="id">Bullet</span> <span class="id">Behavior</span> "<span class="kwd">Strict</span> <span class="id">Subproofs</span>".<br/>
<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bellmanQbar">bellmanQbar</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">R_scope</span>.<br/>
<span class="kwd">Context</span> {<span class="id">M</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#MDP">MDP</a></span>} (γ : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>).<br/>
<span class="kwd">Context</span> (σ : <span class="id"><a href="FormalML.CertRL.mdp.html#dec_rule">dec_rule</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>) (<span class="id">init</span> : <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>)) (<span class="id">h</span>γ : (0 &lt;= γ &lt; 1)%<span class="id">R</span>).<br/>
<span class="id">Arguments</span> <span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> {<span class="id">_</span>}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#outcomes">outcomes</a></span> {<span class="id">_</span>}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> {<span class="id">_</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="act_expt_reward">act_expt_reward</a></span> : <span class="kwd">forall</span> <span class="id">s</span> : <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>), <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>) <span class="id">s</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span> <span class="id">a</span> =&gt; <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>) (<span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> <span class="id">s</span> <span class="id">a</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Qvalue">Qvalue</a></span> : <span class="kwd">forall</span> <span class="id">s</span>: <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>), (<span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>) <span class="id">s</span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> <span class="id">a</span> =&gt; <span class="id"><a href="FormalML.CertRL.qvalues.html#act_expt_reward">act_expt_reward</a></span> <span class="id">s</span> <span class="id">a</span> + γ*<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>) (<span class="id"><a href="FormalML.CertRL.mdp.html#ltv">ltv</a></span> γ σ).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Qvalue_expt_value">Qvalue_expt_value</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.qvalues.html#Qvalue">Qvalue</a></span> <span class="id">s</span> <span class="id">a</span> = <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>) (<span class="kwd">fun</span> <span class="id">s</span>' =&gt; <span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> <span class="id">s</span> <span class="id">a</span> <span class="id">s</span>' + γ*(<span class="id"><a href="FormalML.CertRL.mdp.html#ltv">ltv</a></span> γ σ <span class="id">s</span>')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4261')">Proof.</div>
<div class="proofscript" id="proof4261">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#Qvalue">Qvalue</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#act_expt_reward">act_expt_reward</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_const_mul">expt_value_const_mul</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_add">expt_value_add</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltv_Qvalue">ltv_Qvalue</a></span> : <span class="id"><a href="FormalML.CertRL.mdp.html#ltv">ltv</a></span> γ σ <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.init">init</a></span> = <span class="id"><a href="FormalML.CertRL.qvalues.html#Qvalue">Qvalue</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.init">init</a></span> (σ <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.init">init</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4262')">Proof.</div>
<div class="proofscript" id="proof4262">
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.CertRL.mdp.html#ltv_corec">ltv_corec</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bellmanQbar">bellmanQbar</a></span> : <span class="id"><a href="FormalML.CertRL.mdp.html#Rfct">Rfct</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sigT">sigT</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>)) -&gt; <span class="id"><a href="FormalML.CertRL.mdp.html#Rfct">Rfct</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sigT">sigT</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>))<br/>
&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">W</span> =&gt; <span class="kwd">fun</span> <span class="id">sa</span> =&gt; <span class="kwd">let</span> (<span class="id">s</span>,<span class="id">a</span>) := <span class="id">sa</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.qvalues.html#act_expt_reward">act_expt_reward</a></span> <span class="id">s</span> <span class="id">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;γ*<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>)(<span class="kwd">fun</span> <span class="id">s</span>' =&gt; <span class="id">Max_</span>{<span class="id"><a href="FormalML.CertRL.mdp.html#act_list">act_list</a></span> <span class="id">s</span>'}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">W</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s</span>' <span class="id">a</span>) ) ).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bellmanQbar_expt_value">bellmanQbar_expt_value</a></span> : <span class="kwd">forall</span> <span class="id">s</span> <span class="id">a</span> <span class="id">W</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar">bellmanQbar</a></span> <span class="id">W</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s</span> <span class="id">a</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>) (<span class="kwd">fun</span> <span class="id">s</span>' =&gt; <span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> <span class="id">s</span> <span class="id">a</span> <span class="id">s</span>' + γ*(<span class="id">Max_</span>{<span class="id"><a href="FormalML.CertRL.mdp.html#act_list">act_list</a></span> <span class="id">s</span>'}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">W</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s</span>' <span class="id">a</span>)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4263')">Proof.</div>
<div class="proofscript" id="proof4263">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar">bellmanQbar</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#act_expt_reward">act_expt_reward</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_const_mul">expt_value_const_mul</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_add">expt_value_add</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rabs_helper">Rabs_helper</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> ( (<span class="id">a</span> + <span class="id">b</span>) + -(<span class="id">a</span> + <span class="id">c</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">b</span> - <span class="id">c</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4264')">Proof.</div>
<div class="proofscript" id="proof4264">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="is_contraction_bellmanQbar">is_contraction_bellmanQbar</a></span> :<br/>
&nbsp;&nbsp;@<span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#is_contraction">is_contraction</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#Rfct_UniformSpace">Rfct_UniformSpace</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sigT">sigT</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>))) (<span class="id"><a href="FormalML.CertRL.mdp.html#Rfct_UniformSpace">Rfct_UniformSpace</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sigT">sigT</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar">bellmanQbar</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4265')">Proof.</div>
<div class="proofscript" id="proof4265">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#is_contraction">is_contraction</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> γ 0).<br/>
&nbsp;&nbsp;++ <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar">bellmanQbar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (1/2). <span class="tactic">split</span>; [<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span>. <span class="tactic">split</span>;<span class="tactic">trivial</span>;[<span class="id">lra</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>) <span class="kwd">as</span> [<span class="id">ls</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">r</span> <span class="id">Hr</span> <span class="id">Hfgr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span>. <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#ball_x">ball_x</a></span>,<span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#ball_y">ball_y</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.mdp.html#Rmax_ball">Rmax_ball</a></span>,<span class="id"><a href="FormalML.CertRL.mdp.html#Rmax_norm">Rmax_norm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FormalML.CertRL.mdp.html#act_finite">act_finite</a></span> <span class="kwd">as</span> [<span class="id">acts</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_lt_iff">Rmax_list_lt_iff</a></span>; <span class="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#not_nil_exists">not_nil_exists</a></span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#ne">ne</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>) ((<span class="id"><a href="FormalML.CertRL.mdp.html#na">na</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>) (<span class="id"><a href="FormalML.CertRL.mdp.html#ne">ne</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>))); <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>,<span class="id">plus</span>,<span class="id">opp</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x0</span> <span class="kwd">as</span> [<span class="id">s</span> <span class="id">a</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H1</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_def1">Rabs_def1</a></span> ; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0) <span class="kwd">with</span> ((1/2)*0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; <span class="tactic">trivial</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_l_reverse">Ropp_mult_distr_l_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_gt_0_contravar">Ropp_lt_gt_0_contravar</a></span> <span class="kwd">with</span> (<span class="id">r</span> := (1/2)*<span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0) <span class="kwd">with</span> ((1/2)*0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; <span class="tactic">trivial</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;++ <span class="id">exists</span> γ ; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">h</span>γ.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#ball_x">ball_x</a></span>,<span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#ball_y">ball_y</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>) <span class="kwd">as</span> [<span class="id">ls</span> <span class="id">Hls</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">now</span> <span class="tactic">destruct</span> <span class="id">h</span>γ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">intros</span> <span class="id">f</span> <span class="id">g</span> <span class="id">r</span> <span class="id">Hr</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">Hx</span> |-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.mdp.html#Rmax_ball">Rmax_ball</a></span>, <span class="id"><a href="FormalML.CertRL.mdp.html#Rmax_norm">Rmax_norm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#act_finite">act_finite</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>) <span class="kwd">as</span> [<span class="id">la</span> <span class="id">Hla</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_lt_iff">Rmax_list_lt_iff</a></span>; <span class="tactic">intros</span>; <span class="tactic">try</span>(<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#not_nil_exists">not_nil_exists</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">sa</span> [<span class="id">Q</span> <span class="id">HQ</span>]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>, <span class="id">plus</span>, <span class="id">opp</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar">bellmanQbar</a></span>; <span class="tactic">destruct</span> <span class="id">sa</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#Rabs_helper">Rabs_helper</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hr</span>γ : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> γ = γ) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>; <span class="id">lra</span>). <span class="tactic">rewrite</span> <span class="id">Hr</span>γ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; <span class="tactic">try</span> (<span class="tactic">destruct</span> <span class="id">h</span>γ; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_sub">expt_value_sub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.mdp.html#Rmax_norm">Rmax_norm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_Rabs_Rle">expt_value_Rabs_Rle</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_bdd">expt_value_bdd</a></span>; <span class="tactic">intro</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.mdp.html#act_list">act_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span> <span class="id">s0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_minus_le_abs">Rmax_list_minus_le_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_le_iff">Rmax_list_le_iff</a></span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#map_not_nil">map_not_nil</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">a0</span> [<span class="id">Ha0</span> <span class="id">Helms</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s0</span> <span class="id">a0</span>); <span class="id">now</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.ListAdd.html#not_nil_exists">not_nil_exists</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#na">na</a></span> <span class="id">_</span> <span class="id">s0</span>); <span class="tactic">intros</span> <span class="id">a0</span>; <span class="id">now</span> <span class="id">exists</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#ne">ne</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>); <span class="tactic">intros</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#na">na</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar.M">M</a></span>); <span class="tactic">intros</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a0</span> <span class="id">s0</span>). <span class="id">now</span> <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s0</span> <span class="id">a0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQbar">bellmanQbar</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="bellmanQ">bellmanQ</a></span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">R_scope</span>.<br/>
<span class="kwd">Context</span> {<span class="id">M</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#MDP">MDP</a></span>} (γ : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>).<br/>
<span class="kwd">Context</span> (σ : <span class="id"><a href="FormalML.CertRL.mdp.html#dec_rule">dec_rule</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>) (<span class="id">init</span> : <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>)) (<span class="id">h</span>γ : (0 &lt;= γ &lt; 1)%<span class="id">R</span>).<br/>
<span class="id">Arguments</span> <span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> {<span class="id">_</span>}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#outcomes">outcomes</a></span> {<span class="id">_</span>}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> {<span class="id">_</span>}.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fun_inner_prod">fun_inner_prod</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">ls</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; (<span class="id">f</span> <span class="id">a</span>)*(<span class="id">g</span> <span class="id">a</span>)) <span class="id">ls</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fun_inner_prod_self">fun_inner_prod_self</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.qvalues.html#fun_inner_prod">fun_inner_prod</a></span> <span class="id">f</span> <span class="id">f</span> <span class="id">l</span> = <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4266')">Proof.</div>
<div class="proofscript" id="proof4266">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#fun_inner_prod">fun_inner_prod</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_map_ext">list_sum_map_ext</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Rfct_inner">Rfct_inner</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">finA</span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> <span class="id">A</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#Rfct">Rfct</a></span> <span class="id">A</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">ls</span>, <span class="id">_</span>) := <span class="id">finA</span> <span class="kwd">in</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#fun_inner_prod">fun_inner_prod</a></span> <span class="id">f</span> <span class="id">g</span> <span class="id">ls</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rfct_expt_inner">Rfct_expt_inner</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">finA</span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> : <span class="id">B</span> -&gt; <span class="id"><a href="FormalML.CertRL.mdp.html#Rfct">Rfct</a></span> <span class="id">A</span>) (<span class="id">p</span> : <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf">Pmf</a></span> <span class="id">B</span>):<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">la</span>, <span class="id">_</span>) := <span class="id">finA</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> <span class="id">p</span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="id"><a href="FormalML.CertRL.qvalues.html#Rfct_inner">Rfct_inner</a></span> <span class="id">_</span> (<span class="id">f</span> <span class="id">b</span>) (<span class="id">f</span> <span class="id">b</span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum">list_sum</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> <span class="id">p</span> (<span class="kwd">fun</span> <span class="id">b</span> =&gt; (<span class="id">f</span> <span class="id">b</span> <span class="id">a</span>)*(<span class="id">f</span> <span class="id">b</span> <span class="id">a</span>))) <span class="id">la</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4267')">Proof.</div>
<div class="proofscript" id="proof4267">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#Rfct_inner">Rfct_inner</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">finA</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span> <span class="kwd">as</span> [<span class="id">lp</span> <span class="id">Hlp</span>]. <span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">clear</span> <span class="id">Hlp</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">lp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">lp</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">simpl</span>. <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_map_zero">list_sum_map_zero</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHlp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_map_add">list_sum_map_add</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#fun_inner_prod">fun_inner_prod</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="FormalML.utils.RealAdd.html#list_sum_const_mul">list_sum_const_mul</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">List.map_ext</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bellmanQ">bellmanQ</a></span> : <span class="id"><a href="FormalML.CertRL.mdp.html#Rfct">Rfct</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sigT">sigT</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>)) -&gt; <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>) -&gt; <span class="id"><a href="FormalML.CertRL.mdp.html#Rfct">Rfct</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sigT">sigT</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>))<br/>
&nbsp;&nbsp;:= <span class="kwd">fun</span> <span class="id">W</span> =&gt; <span class="kwd">fun</span> <span class="id">s</span>' <span class="id">sa</span> =&gt; <span class="kwd">let</span> (<span class="id">s</span>,<span class="id">a</span>) := <span class="id">sa</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> <span class="id">s</span> <span class="id">a</span> <span class="id">s</span>' + γ*<span class="id">Max_</span>{<span class="id"><a href="FormalML.CertRL.mdp.html#act_list">act_list</a></span> <span class="id">s</span>'}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">W</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s</span>' <span class="id">a</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expt_value_le_max">expt_value_le_max</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">finA</span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> <span class="id">A</span>) (<span class="id">p</span> : <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf">Pmf</a></span> <span class="id">A</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>):<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">la</span>,<span class="id">_</span>) := <span class="id">finA</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> <span class="id">p</span> <span class="id">f</span> &lt;= <span class="id">Max_</span>{<span class="id">la</span>}(<span class="id">f</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4268')">Proof.</div>
<div class="proofscript" id="proof4268">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">finA</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value_bdd">expt_value_bdd</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">List.in_map_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_Rsqr_Rabs_1">Rmax_list_Rsqr_Rabs_1</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>):<br/>
[] &lt;&gt; <span class="id">l</span> -&gt; <span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">f</span> <span class="id">a</span>)) &lt;= <span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4269')">Proof.</div>
<div class="proofscript" id="proof4269">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="id">l</span> <span class="id">Hn</span>) <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha1</span> <span class="id">Ha2</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>.  <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_abs">Rsqr_abs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_Rsqr_Rabs_2">Rmax_list_Rsqr_Rabs_2</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>):<br/>
&nbsp;&nbsp;[] &lt;&gt; <span class="id">l</span> -&gt; <span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>))) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>(<span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>(<span class="id">f</span> <span class="id">a</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4270')">Proof.</div>
<div class="proofscript" id="proof4270">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_exist">Rmax_list_map_exist</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>))) <span class="id">l</span> <span class="id">Hn</span>) <span class="kwd">as</span> [<span class="id">a</span> [<span class="id">Ha1</span> <span class="id">Ha2</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Ha2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#neg_pos_Rsqr_le">neg_pos_Rsqr_le</a></span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span> ; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> ; <span class="id">exists</span> <span class="id">a</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="kwd">with</span> (- (- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>)))) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>)) ; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_spec">Rmax_spec</a></span> ; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> ; <span class="id">exists</span> <span class="id">a</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Rminus_le_0</span>.<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">try</span> (<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rmax_list_Rsqr_Rabs_3">Rmax_list_Rsqr_Rabs_3</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">f</span> <span class="id">g</span> : <span class="id">A</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>):<br/>
&nbsp;&nbsp;[] &lt;&gt; <span class="id">l</span> -&gt; (<span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span> + <span class="id">g</span> <span class="id">a</span>)))² &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>(<span class="id">f</span> <span class="id">a</span>)) + <span class="id">Max_</span>{<span class="id">l</span>}(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">g</span> <span class="id">a</span>)))².<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4271')">Proof.</div>
<div class="proofscript" id="proof4271">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_1">Rsqr_incr_1</a></span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_nonneg">Rmax_list_map_nonneg</a></span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_triangle">Rmax_list_map_triangle</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">replace</span> 0 <span class="kwd">with</span> (0+0) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.RealAdd.html#Rmax_list_map_nonneg">Rmax_list_map_nonneg</a></span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="summand_bound">summand_bound</a></span> <span class="id">W</span> := <span class="kwd">fun</span> (<span class="id">s</span> : <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>)) <span class="id">a</span> =&gt; <span class="kwd">let</span> (<span class="id">ls</span>,<span class="id">_</span>) := <span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Max_</span>{ <span class="id">ls</span>}(<span class="kwd">fun</span> <span class="id">a0</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> ((<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.qvalues.html#act_expt_reward">act_expt_reward</a></span> <span class="id">s</span> <span class="id">a</span>) <span class="id">a0</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Max_</span>{ <span class="id">ls</span>} (<span class="kwd">fun</span> <span class="id">a0</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> ((<span class="kwd">fun</span> <span class="id">a1</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> =&gt; γ * (<span class="id">Max_</span>{ <span class="id"><a href="FormalML.CertRL.mdp.html#act_list">act_list</a></span> <span class="id">a1</span>}(<span class="kwd">fun</span> <span class="id">a2</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> <span class="id">a1</span> =&gt; <span class="id">W</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>) <span class="id">a1</span> <span class="id">a2</span>)))) <span class="id">a0</span>))))².<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="summand_bounded">summand_bounded</a></span> <span class="id">W</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span>)) (<span class="id">a</span>: <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>.(<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span>) <span class="id">s</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">ls</span>,<span class="id">_</span>) := <span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.pmf_monad.html#variance">variance</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>) (<span class="kwd">fun</span> <span class="id">s</span>' =&gt; <span class="id"><a href="FormalML.CertRL.qvalues.html#act_expt_reward">act_expt_reward</a></span> <span class="id">s</span> <span class="id">a</span> + γ*<span class="id">Max_</span>{<span class="id"><a href="FormalML.CertRL.mdp.html#act_list">act_list</a></span> <span class="id">s</span>'} (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">W</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">_</span> <span class="id">s</span>' <span class="id">a</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id"><a href="FormalML.CertRL.qvalues.html#summand_bound">summand_bound</a></span> <span class="id">W</span> <span class="id">s</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4272')">Proof.</div>
<div class="proofscript" id="proof4272">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#summand_bound">summand_bound</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FormalML.CertRL.qvalues.html#expt_value_le_max">expt_value_le_max</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>) (<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> <span class="id">s</span> <span class="id">a</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>) <span class="kwd">as</span> [<span class="id">ls</span> ?].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hls</span>: [] &lt;&gt; <span class="id">ls</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.ListAdd.html#not_nil_exists">not_nil_exists</a></span>; <span class="id">exists</span> (<span class="id"><a href="FormalML.CertRL.mdp.html#ne">ne</a></span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ.M">M</a></span>); <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html#variance_le_expt_value_sqr">variance_le_expt_value_sqr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> (<span class="id"><a href="FormalML.CertRL.qvalues.html#Rmax_list_Rsqr_Rabs_1">Rmax_list_Rsqr_Rabs_1</a></span>) ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> (<span class="id"><a href="FormalML.CertRL.qvalues.html#Rmax_list_Rsqr_Rabs_2">Rmax_list_Rsqr_Rabs_2</a></span>) ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> (<span class="id"><a href="FormalML.CertRL.qvalues.html#Rmax_list_Rsqr_Rabs_3">Rmax_list_Rsqr_Rabs_3</a></span>) ; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.qvalues.html#bellmanQ">bellmanQ</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
