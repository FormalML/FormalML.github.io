
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.CertRL.mdp_turtle</title>
<meta name="description" content="Documentation of Coq module FormalML.CertRL.mdp_turtle" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.CertRL.mdp_turtle</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">Coq.Lists.List</a></span> <span class="id">Coquelicot.Series</span> <span class="id">Coquelicot.Hierarchy</span> <span class="id">Coquelicot.SF_seq</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.CertRL.pmf_monad.html">pmf_monad</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span> <span class="id"><a href="FormalML.CertRL.LM.fixed_point.html">fixed_point</a></span> <span class="id"><a href="FormalML.utils.Finite.html">Finite</a></span> <span class="id"><a href="FormalML.lib_utils.LibUtils.html">LibUtils</a></span>. <br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.Sums.html">Sums</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.ROrderedType.html">Coq.Reals.ROrderedType</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">micromega.Lra</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html">Coq.Logic.FunctionalExtensionality</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html">Equivalence</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html">RelationClasses</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Streams</a></span> <span class="id"><a href="FormalML.utils.RealAdd.html">RealAdd</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.CertRL.mdp.html">mdp</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.Vector.html">Vector</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FormalML.utils.ListAdd.html">ListAdd</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>. <br/>
<span class="kwd">Set</span> <span class="id">Bullet</span> <span class="id">Behavior</span> "<span class="kwd">Strict</span> <span class="id">Subproofs</span>".<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="turtle">turtle</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="turtle_color">turtle_color</a></span> : <span class="kwd">Set</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="turtle_green">turtle_green</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="turtle_white">turtle_white</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="turtle_star">turtle_star</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="turtle_red">turtle_red</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_color_dec">turtle_color_dec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4758')">Proof.</div>
<div class="proofscript" id="proof4758">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span>), {<span class="id">x</span> = <span class="id">y</span>} + {<span class="id">x</span> &lt;&gt; <span class="id">y</span>}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span> := <span class="id"><a href="FormalML.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span> <span class="id">max_x</span> <span class="id">max_y</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span> :=  <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#prod">prod</a></span> ({<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">x</span> &lt; <span class="id">max_x</span>}%<span class="id">nat</span>) ({<span class="id">y</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">y</span> &lt; <span class="id">max_y</span>}%<span class="id">nat</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="make_turtle_state">make_turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span> <span class="id">x</span> <span class="id">y</span> : <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">max_x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">y</span> <span class="id">max_y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4759')">Proof.</div>
<div class="proofscript" id="proof4759">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">x</span> <span class="id">max_x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> <span class="id">y</span> <span class="id">max_y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">x</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">y</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_state_finite">turtle_state_finite</a></span> <span class="id">max_x</span> <span class="id">max_y</span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4760')">Proof.</div>
<div class="proofscript" id="proof4760">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Finite.html#finite_prod">finite_prod</a></span>; <span class="tactic">apply</span> <span class="id"><a href="FormalML.utils.Finite.html#bounded_nat_finite">bounded_nat_finite</a></span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="turtle_start_state">turtle_start_state</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} : <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= ((0, 0))%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4761')">Next Obligation.</div>
<div class="proofscript" id="proof4761">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4762')">Next Obligation.</div>
<div class="proofscript" id="proof4762">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="turtle_state_nonempty">turtle_state_nonempty</a></span> <span class="id">max_x</span> <span class="id">max_y</span> : <span class="id"><a href="FormalML.CertRL.mdp.html#NonEmpty">NonEmpty</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_start_state">turtle_start_state</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_state_dec">turtle_state_dec</a></span> <span class="id">max_x</span> <span class="id">max_y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4763')">Proof.</div>
<div class="proofscript" id="proof4763">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [[<span class="id">x1</span> <span class="id">pfx1</span>] [<span class="id">y1</span> <span class="id">pfy1</span>]] [[<span class="id">x2</span> <span class="id">pfx2</span>] [<span class="id">y2</span> <span class="id">pfy2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x1</span> == <span class="id">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">y1</span> == <span class="id">y2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">destruct</span> <span class="id">e0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">pfx1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id"><a href="FormalML.utils.Vector.html#index_pf_irrel">index_pf_irrel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">pfy1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="turtle_action">turtle_action</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a name="Up">Up</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Down">Down</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Left">Left</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Right">Right</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_action_dec">turtle_action_dec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4764')">Proof.</div>
<div class="proofscript" id="proof4764">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>), {<span class="id">x</span> = <span class="id">y</span>} + {<span class="id">x</span> &lt;&gt; <span class="id">y</span>}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_action_finite">turtle_action_finite</a></span> : <span class="id"><a href="FormalML.utils.Finite.html#Finite">Finite</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4765')">Proof.</div>
<div class="proofscript" id="proof4765">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Up">Up</a></span>::<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Down">Down</a></span>::<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Left">Left</a></span>::<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Right">Right</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_action_nonempty">turtle_action_nonempty</a></span> : <span class="id"><a href="FormalML.CertRL.mdp.html#NonEmpty">NonEmpty</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Up">Up</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_action_opp">turtle_action_opp</a></span> (<span class="id">a</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>) : <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Up">Up</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Down">Down</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Down">Down</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Up">Up</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Left">Left</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Right">Right</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Right">Right</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Left">Left</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="color_reward">color_reward</a></span> (<span class="id">c</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_green">turtle_green</a></span> =&gt; 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_star">turtle_star</a></span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span> =&gt; -10<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_reward">turtle_reward</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} (<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span>) (<span class="id">state</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> '(<span class="id">x</span>,<span class="id">y</span>) := <span class="id">state</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">color</span> := <span class="id">grid</span> <span class="id">x</span> <span class="id">y</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#color_reward">color_reward</a></span> <span class="id">color</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="turtle_move">turtle_move</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} (<span class="id">s</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>) (<span class="id">a</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">let</span> '(<span class="id">x</span>,<span class="id">y</span>) := <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Up">Up</a></span> =&gt; <span class="kwd">if</span> <span class="id">y</span> == 0 <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x</span>, <span class="id">y</span>-1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Down">Down</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> (<span class="id">y</span>+1) <span class="id">max_y</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x</span>, <span class="id">y</span>+1) <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Left">Left</a></span> =&gt; <span class="kwd">if</span> <span class="id">x</span> == 0 <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x</span>-1, <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#Right">Right</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> (<span class="id">x</span>+1) <span class="id">max_x</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">x</span>+1, <span class="id">y</span>) <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4766')">Next Obligation.</div>
<div class="proofscript" id="proof4766">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4767')">Next Obligation.</div>
<div class="proofscript" id="proof4767">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="turtle_confused_outcomes">turtle_confused_outcomes</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} (<span class="id">correct_s</span> <span class="id">oops_s</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>) : <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf">Pmf</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.pmf_monad.html#outcomes">outcomes</a></span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mknonnegreal">mknonnegreal</a></span> 0.75 <span class="id">_</span>, <span class="id">correct_s</span>)::(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mknonnegreal">mknonnegreal</a></span> 0.25 <span class="id">_</span>, <span class="id">oops_s</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4768')">Next Obligation.</div>
<div class="proofscript" id="proof4768">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4769')">Next Obligation.</div>
<div class="proofscript" id="proof4769">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4770')">Next Obligation.</div>
<div class="proofscript" id="proof4770">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_prob_t">turtle_prob_t</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} (<span class="id">s</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>) (<span class="id">a</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>) : <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf">Pmf</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> '(<span class="id">x</span>,<span class="id">y</span>) := <span class="id">s</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_move">turtle_move</a></span> <span class="id">s</span> <span class="id">a</span>, <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_move">turtle_move</a></span> <span class="id">s</span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action_opp">turtle_action_opp</a></span> <span class="id">a</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">correct_s</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">oops_s</span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_confused_outcomes">turtle_confused_outcomes</a></span> <span class="id">correct_s</span> <span class="id">oops_s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">next_s</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf_pure">Pmf_pure</a></span> <span class="id">next_s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">next_s</span> =&gt; <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf_pure">Pmf_pure</a></span> <span class="id">next_s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="FormalML.CertRL.pmf_monad.html#Pmf_pure">Pmf_pure</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_mdp">turtle_mdp</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} (<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>)) : <span class="id"><a href="FormalML.CertRL.mdp.html#MDP">MDP</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#act">act</a></span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#st_eqdec">st_eqdec</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state_dec">turtle_state_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state_finite">turtle_state_finite</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#fa">fa</a></span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action_finite">turtle_action_finite</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#ne">ne</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state_nonempty">turtle_state_nonempty</a></span> <span class="id">max_x</span> <span class="id">max_y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#na">na</a></span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action_nonempty">turtle_action_nonempty</a></span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#t">t</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_prob_t">turtle_prob_t</a></span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span>' := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_reward">turtle_reward</a></span> <span class="id">grid</span> <span class="id">s</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Section</span> <span class="id"><a name="turtle.optimal_path">optimal_path</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> (γ : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">max_x</span> <span class="id">max_y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> (<span class="id">grid</span> : <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.max_x">max_x</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.max_y">max_y</a></span>)).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_Rfct">turtle_Rfct</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="FormalML.CertRL.mdp.html#Rfct_CompleteNormedModule">Rfct_CompleteNormedModule</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#state">state</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_mdp">turtle_mdp</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.grid">grid</a></span>)) (<span class="id"><a href="FormalML.CertRL.mdp.html#fs">fs</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_mdp">turtle_mdp</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.grid">grid</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_init">turtle_init</a></span> : <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_Rfct">turtle_Rfct</a></span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; 0.  <br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_bellman_iter">turtle_bellman_iter</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="FormalML.CertRL.LM.fixed_point.html#iter">fixed_point.iter</a></span> (<span class="id">CompleteNormedModule.UniformSpace</span> <span class="id">R_AbsRing</span> <span class="id">_</span>)<br/>
&nbsp;(@<span class="id"><a href="FormalML.CertRL.mdp.html#bellman_max_op">bellman_max_op</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_mdp">turtle_mdp</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.grid">grid</a></span>) γ) <span class="id">n</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_init">turtle_init</a></span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_approx_dec_rule">turtle_approx_dec_rule</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="FormalML.CertRL.mdp.html#dec_rule">dec_rule</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_mdp">turtle_mdp</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.grid">grid</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id"><a href="FormalML.utils.RealAdd.html#argmax">argmax</a></span> (<span class="id"><a href="FormalML.CertRL.mdp.html#act_list_not_nil">act_list_not_nil</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="FormalML.CertRL.pmf_monad.html#expt_value">expt_value</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_prob_t">turtle_prob_t</a></span> <span class="id">s</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span>' =&gt; <span class="id"><a href="FormalML.CertRL.mdp.html#reward">reward</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_mdp">turtle_mdp</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path.grid">grid</a></span>) <span class="id">s</span> <span class="id">a</span> <span class="id">s</span>' + γ*(<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_bellman_iter">turtle_bellman_iter</a></span> <span class="id">n</span> <span class="id">s</span>'))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.optimal_path">optimal_path</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="tactic">move</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sum_self_to_bool">sum_self_to_bool</a></span> {<span class="id">A</span>} (<span class="id">a</span>:<span class="id">A</span>+<span class="id">A</span>) : <span class="id">A</span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">a</span>' =&gt; (<span class="id">a</span>',<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">a</span>' =&gt; (<span class="id">a</span>',<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_path">turtle_path</a></span> <span class="id">max_x</span> <span class="id">max_y</span> : <span class="kwd">Set</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)*<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>)%<span class="id">type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_path_from_actions">turtle_path_from_actions</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">actions</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path">turtle_path</a></span> <span class="id">max_x</span> <span class="id">max_y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#sum_self_to_bool">sum_self_to_bool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.ListAdd.html#fold_left_partial_with_history">fold_left_partial_with_history</a></span> (@<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_move">turtle_move</a></span> <span class="id">max_x</span> <span class="id">max_y</span>) <span class="id">actions</span> <span class="id">start</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_path_from_dec_rules">turtle_path_from_dec_rules</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">max_x</span> <span class="id">max_y</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">dec_rules</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>-&gt;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path">turtle_path</a></span> <span class="id">max_x</span> <span class="id">max_y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#sum_self_to_bool">sum_self_to_bool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.ListAdd.html#fold_left_partial_with_history">fold_left_partial_with_history</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span> <span class="id">rule</span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_move">turtle_move</a></span> <span class="id">s</span> (<span class="id">rule</span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dec_rules</span> <span class="id">start</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_path_from_stationary_dec_rule">turtle_path_from_stationary_dec_rule</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">max_x</span> <span class="id">max_y</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">dec_rule</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>-&gt;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">steps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path">turtle_path</a></span> <span class="id">max_x</span> <span class="id">max_y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_from_dec_rules">turtle_path_from_dec_rules</a></span> <span class="id">grid</span> <span class="id">start</span> (<span class="tactic">repeat</span> <span class="id">dec_rule</span> <span class="id">steps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_path_optimal">turtle_path_optimal</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">max_x</span> <span class="id">max_y</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(γ : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">approx_iters</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">steps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path">turtle_path</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">opt_dec_rule</span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_approx_dec_rule">turtle_approx_dec_rule</a></span> γ <span class="id">grid</span> <span class="id">approx_iters</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_from_stationary_dec_rule">turtle_path_from_stationary_dec_rule</a></span> <span class="id">grid</span> <span class="id">start</span> <span class="id">opt_dec_rule</span> <span class="id">steps</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="tactic">move</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="turtle.to_string">to_string</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="turtle.to_string.utils">utils</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="newline">newline</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#String">String</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii_of_N">Ascii.ascii_of_N</a></span> 10) <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#EmptyString">EmptyString</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="string_bracket">string_bracket</a></span> (<span class="id">sstart</span> <span class="id">send</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">smiddle</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id">sstart</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id">smiddle</span> <span class="id">send</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_join">vector_join</a></span> {<span class="id">A</span>} (<span class="id">delim</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span> <span class="id">delim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vector_enum_join">vector_enum_join</a></span> {<span class="id">A</span>} (<span class="id">delim</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">f</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>*<span class="id">A</span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id">A</span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span> <span class="id">delim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">List.combine</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id">n</span>) (<span class="id"><a href="FormalML.utils.Vector.html#vector_to_list">vector_to_list</a></span> <span class="id">v</span>))).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.to_string.utils">utils</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id"><a name="turtle_color_tostring">turtle_color_tostring</a></span> : <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#ToString">ToString</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> <span class="id">c</span> := <span class="kwd">match</span> <span class="id">c</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_green">turtle_green</a></span> =&gt; "+"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span> =&gt; " "%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_star">turtle_star</a></span> =&gt; "*"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>  =&gt; "<span class="id">X</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_gridline_tostring">turtle_gridline_tostring</a></span> {<span class="id">n</span>} (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> "| "%<span class="id">string</span> " |"%<span class="id">string</span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#vector_join">vector_join</a></span> " | "%<span class="id">string</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> <span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_grid_vline">turtle_grid_vline</a></span> <span class="id">max_x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> "--"%<span class="id">string</span> "--"%<span class="id">string</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span> "---"%<span class="id">string</span> (<span class="tactic">repeat</span> "-"%<span class="id">string</span> <span class="id">max_x</span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="turtle_grid_tostring">turtle_grid_tostring</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} : <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#ToString">ToString</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> <span class="id">m</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid_vline">turtle_grid_vline</a></span> <span class="id">max_x</span>) <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid_vline">turtle_grid_vline</a></span> <span class="id">max_x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#vector_join">vector_join</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid_vline">turtle_grid_vline</a></span> <span class="id">max_x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">line</span> =&gt; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_gridline_tostring">turtle_gridline_tostring</a></span> <span class="id">line</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="stately_turtle_grid_vline">stately_turtle_grid_vline</a></span> <span class="id">max_x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> "--"%<span class="id">string</span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid_vline">turtle_grid_vline</a></span> <span class="id">max_x</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="stately_turtle_gridline_tostring">stately_turtle_gridline_tostring</a></span> {<span class="id">n</span>} (<span class="id">has_turtle</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">x</span>: {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) (<span class="id">v</span>:<span class="id"><a href="FormalML.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_color">turtle_color</a></span> <span class="id">n</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> "| "%<span class="id">string</span> " |"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#vector_enum_join">vector_enum_join</a></span> " | "%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> '(<span class="id">cur_x</span>,<span class="id">c</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">cur_x</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">has_turtle</span> <span class="kwd">then</span> "<span class="id">T</span>"%<span class="id">string</span> <span class="kwd">else</span> " "%<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">has_turtle</span> <span class="kwd">then</span> "<span class="id">T</span>"%<span class="id">string</span> <span class="kwd">else</span> " "%<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="stately_turtle_grid_turtleline">stately_turtle_grid_turtleline</a></span> {<span class="id">n</span>} (<span class="id">x</span>: {<span class="id">n</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <span class="id">n</span>' &lt; <span class="id">n</span>}%<span class="id">nat</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> "| "%<span class="id">string</span> " |"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span> " | "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cur_x</span> =&gt; <span class="kwd">if</span> <span class="id">cur_x</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> "<span class="id">TTT</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> " "%<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">List.seq</a></span> 0 <span class="id">n</span>))).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="turtle_grid_state_tostring">turtle_grid_state_tostring</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>} : <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#ToString">ToString</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span> * <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_state">turtle_state</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> '(<span class="id">m</span>, (<span class="id">x</span>,<span class="id">y</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_grid_vline">stately_turtle_grid_vline</a></span> <span class="id">max_x</span>) <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_grid_vline">stately_turtle_grid_vline</a></span> <span class="id">max_x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#vector_enum_join">vector_enum_join</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#string_bracket">string_bracket</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_grid_vline">stately_turtle_grid_vline</a></span> <span class="id">max_x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> '(<span class="id">cur_y</span>,<span class="id">line</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">cur_y</span> == <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_grid_turtleline">stately_turtle_grid_turtleline</a></span> <span class="id">x</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_gridline_tostring">stately_turtle_gridline_tostring</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">x</span> <span class="id">line</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_grid_turtleline">stately_turtle_grid_turtleline</a></span> <span class="id">x</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#stately_turtle_gridline_tostring">stately_turtle_gridline_tostring</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">x</span> <span class="id">line</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="turtle_path_to_string">turtle_path_to_string</a></span> {<span class="id">max_x</span> <span class="id">max_y</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">grid</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">path</span>:<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path">turtle_path</a></span> <span class="id">max_x</span> <span class="id">max_y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="kwd">let</span> '(<span class="id">states</span>, <span class="id">success</span>) := <span class="id">path</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">boards</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> "====&gt;" <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="kwd">fun</span> <span class="id">s</span> =&gt; <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> (<span class="id">grid</span>,<span class="id">s</span>)) <span class="id">states</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">end_message</span> := <span class="kwd">if</span> <span class="id">success</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> "<span class="id">and</span> <span class="kwd">then</span> <span class="id">he</span> <span class="id">took</span> <span class="id">a</span> <span class="id">nap</span>."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> "<span class="id">and</span> <span class="kwd">then</span> <span class="id">he</span> <span class="id">crashed</span>...  <span class="id">Hey</span>, <span class="id">watch</span> <span class="kwd">where</span> <span class="id">you</span> <span class="id">are</span> <span class="id">going</span>!" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id">boards</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#append">String.append</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> <span class="id">end_message</span>)))%<span class="id">string</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle.to_string">to_string</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle">turtle</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="certl">certl</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CeRtL_grid">CeRtL_grid</a></span> : <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_grid">turtle_grid</a></span> 5%<span class="id">nat</span> 5%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.utils.Vector.html#transpose">transpose</a></span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> [<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> [<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_star">turtle_star</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> [<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_star">turtle_star</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> [<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_green">turtle_green</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.utils.Vector.html#list_to_vector">list_to_vector</a></span> [<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_red">turtle_red</a></span>; <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_white">turtle_white</a></span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="CeRtl_grid_correct">CeRtl_grid_correct</a></span> : <span class="id"><a href="FormalML.lib_utils.LibUtilsCoqLibAdd.html#toString">toString</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#concat">String.concat</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#newline">newline</a></span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"---------------------";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"|   |   |   |   |   |";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"---------------------";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"| <span class="id">X</span> | <span class="id">X</span> | <span class="id">X</span> | * |   |";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"---------------------";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"|   |   | * | <span class="id">X</span> |   |";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"---------------------";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"| + | <span class="id">X</span> |   |   |   |";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"---------------------";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"|   |   |   | <span class="id">X</span> |   |";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"---------------------"]%<span class="id">string</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4771')">Proof.</div>
<div class="proofscript" id="proof4771">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CeRtL_mdp">CeRtL_mdp</a></span> : <span class="id"><a href="FormalML.CertRL.mdp.html#MDP">MDP</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_mdp">turtle_mdp</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="make_CeRtL_state">make_CeRtL_state</a></span> := <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#make_turtle_state">make_turtle_state</a></span> 5 5.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CeRtL_run_actions">CeRtL_run_actions</a></span> (<span class="id">actions</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_action">turtle_action</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_to_string">turtle_path_to_string</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_from_actions">turtle_path_from_actions</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_start_state">turtle_start_state</a></span> <span class="id">actions</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CeRtL_run_dec_rules">CeRtL_run_dec_rules</a></span> <span class="id">dec_rules</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_to_string">turtle_path_to_string</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_from_dec_rules">turtle_path_from_dec_rules</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_start_state">turtle_start_state</a></span> <span class="id">dec_rules</span>).<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CeRtL_run_optimal">CeRtL_run_optimal</a></span> (γ : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">approx_iters</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">steps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_to_string">turtle_path_to_string</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> (<span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_path_optimal">turtle_path_optimal</a></span> γ <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#CeRtL_grid">CeRtL_grid</a></span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#turtle_start_state">turtle_start_state</a></span> <span class="id">approx_iters</span> <span class="id">steps</span>).<br/>
&nbsp;&nbsp;<br/>
<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.mdp_turtle.html#certl">certl</a></span>.<br/>
<br/>
&nbsp;<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
