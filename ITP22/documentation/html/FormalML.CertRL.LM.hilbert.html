
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FormalML.CertRL.LM.hilbert</title>
<meta name="description" content="Documentation of Coq module FormalML.CertRL.LM.hilbert" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FormalML.CertRL.LM.hilbert</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="FormalML.CertRL.LM.linear_map.html">linear_map</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="FormalML.CertRL.LM.R_compl.html">R_compl</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">mathcomp.ssreflect.ssreflect</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html">Decidable</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="FormalML.CertRL.LM.logic_tricks.html">logic_tricks</a></span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id"><a name="prop_extensionality">prop_extensionality</a></span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span>:<span class="kwd">Prop</span>, (<span class="id">A</span> &lt;-&gt; <span class="id">B</span>) -&gt; <span class="id">A</span> = <span class="id">B</span>.<br/>
<br/>
<div class="doc">Complete subsets </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="CompleteSubset">CompleteSubset</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.Exports.NormedModule">NormedModule</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="complete_subset">complete_subset</a></span> (<span class="id">phi</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#CompleteSubset.E">E</a></span>-&gt;<span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">lime</span> : ((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#CompleteSubset.E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#CompleteSubset.E">E</a></span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">F</span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ProperFilter">ProperFilter</a></span> <span class="id">F</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#cauchy">cauchy</a></span> <span class="id">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">P</span>, <span class="id">F</span> <span class="id">P</span> -&gt; ~~(<span class="kwd">exists</span> <span class="id">x</span>, <span class="id">P</span> <span class="id">x</span> /\ <span class="id">phi</span> <span class="id">x</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">phi</span> (<span class="id">lime</span> <span class="id">F</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">F</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ball">ball</a></span> (<span class="id">lime</span> <span class="id">F</span>) <span class="id">eps</span>)).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#CompleteSubset">CompleteSubset</a></span>.<br/>
<br/>
<h1> PreHilbert spaces </h1>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="PreHilbert">PreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="PreHilbert.mixin_of">mixin_of</a></span> (<span class="id">E</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.Exports.ModuleSpace">ModuleSpace</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_Ring">R_Ring</a></span>) := <span class="id"><a name="PreHilbert.Mixin">Mixin</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.inner">inner</a></span> : <span class="id">E</span> -&gt; <span class="id">E</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax1">ax1</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">E</span>), <span class="id">inner</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">inner</span> <span class="id">y</span> <span class="id">x</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax2">ax2</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id">E</span>), 0 &lt;= <span class="id">inner</span> <span class="id">x</span> <span class="id">x</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax3">ax3</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id">E</span>), <span class="id">inner</span> <span class="id">x</span> <span class="id">x</span> = 0 -&gt; <span class="id">x</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax4">ax4</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id">E</span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">inner</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">x</span>) <span class="id">y</span> = <span class="id">l</span> * <span class="id">inner</span> <span class="id">x</span> <span class="id">y</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax5">ax5</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id">E</span>), <span class="id">inner</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="id">z</span> = <span class="id">inner</span> <span class="id">x</span> <span class="id">z</span> + <span class="id">inner</span> <span class="id">y</span> <span class="id">z</span><br/>
}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PreHilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="PreHilbert.class_of">class_of</a></span> (<span class="id">T</span> : <span class="kwd">Type</span>) := <span class="kwd">Class</span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.base">base</a></span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.class_of">ModuleSpace.class_of</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_Ring">R_Ring</a></span> <span class="id">T</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.mixin">mixin</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.mixin_of">mixin_of</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.Pack">ModuleSpace.Pack</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_Ring">R_Ring</a></span> <span class="id">T</span> <span class="id">base</span> <span class="id">T</span>)<br/>
}.<br/>
<span class="id">Local</span> <span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">ModuleSpace.class_of</span>.<br/>
<br/>
<span class="kwd">Structure</span> <span class="id"><a name="PreHilbert.type">type</a></span> := <span class="id"><a name="PreHilbert.Pack">Pack</a></span> { <span class="id"><a name="PreHilbert.sort">sort</a></span>; <span class="id">_</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.class_of">class_of</a></span> <span class="id">sort</span> ; <span class="id">_</span> : <span class="kwd">Type</span> }.<br/>
<span class="id">Local</span> <span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PreHilbert.ClassDef.cT">cT</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert.class">class</a></span> := <span class="kwd">let</span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.Pack">Pack</a></span> <span class="id">_</span> <span class="id">c</span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="kwd">return</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.class_of">class_of</a></span> <span class="id">cT</span> <span class="kwd">in</span> <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PreHilbert.ClassDef.xT">xT</a></span> := <span class="kwd">let</span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.Pack">Pack</a></span> <span class="id">T</span> <span class="id">_</span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="kwd">in</span> <span class="id">T</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="PreHilbert.xclass">xclass</a></span> := (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.class">class</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.class_of">class_of</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.xT">xT</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert.AbelianGroup">AbelianGroup</a></span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#AbelianGroup.Pack">AbelianGroup.Pack</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.xclass">xclass</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert.ModuleSpace">ModuleSpace</a></span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.Pack">ModuleSpace.Pack</a></span> <span class="id">_</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.xclass">xclass</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef.xT">xT</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="PreHilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">ModuleSpace.class_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">mixin</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">mixin_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">AbelianGroup</span> : <span class="id">type</span> &gt;-&gt; <span class="id">AbelianGroup.type</span>.<br/>
<span class="kwd">Canonical</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.AbelianGroup">AbelianGroup</a></span>.<br/>
<span class="kwd">Coercion</span> <span class="id">ModuleSpace</span> : <span class="id">type</span> &gt;-&gt; <span class="id">ModuleSpace.type</span>.<br/>
<span class="kwd">Canonical</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.ModuleSpace">ModuleSpace</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id"><a name="PreHilbert.Exports.PreHilbert">PreHilbert</a></span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert">PreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Export</span> <span class="id">PreHilbert.Exports</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="AboutPreHilbert">AboutPreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="inner">inner</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">PreHilbert.inner</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#class">PreHilbert.class</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hnorm">Hnorm</a></span> <span class="id">x</span> := <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_is_bilinear_form">inner_is_bilinear_form</a></span>: <span class="id"><a href="FormalML.CertRL.LM.linear_map.html#is_bilinear_mapping">is_bilinear_mapping</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax4">PreHilbert.ax4</a></span>.<br/>
<span class="id">split</span>.<br/>
&nbsp;+ <span class="id">intros</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">l0</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x0</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l0</span> <span class="id">y0</span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l0</span> <span class="id">y0</span>) <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x0</span> <span class="id">y0</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y0</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax4">PreHilbert.ax4</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
+  <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax5">PreHilbert.ax5</a></span>.<br/>
+  <span class="id">intros</span> <span class="id">x2</span> <span class="id">y2</span> <span class="id">z0</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x2</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">y2</span> <span class="id">z0</span>)) <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">y2</span> <span class="id">z0</span>) <span class="id">x2</span>).<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x2</span> <span class="id">y2</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y2</span> <span class="id">x2</span>).<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x2</span> <span class="id">z0</span>) <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">z0</span> <span class="id">x2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax5">PreHilbert.ax5</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_sym">inner_sym</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,  <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span> = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_ge_0">inner_ge_0</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax2">PreHilbert.ax2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_eq_0">inner_eq_0</a></span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span> = 0 -&gt; <span class="id">x</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax3">PreHilbert.ax3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_ge_0">norm_ge_0</a></span>: <span class="kwd">forall</span> <span class="id">x</span>,  0 &lt;= <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">intros</span> <span class="id">x</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_eq_0">norm_eq_0</a></span>: <span class="kwd">forall</span> <span class="id">x</span>,  <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> = 0 -&gt; <span class="id">x</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">intros</span> <span class="id">x</span>; <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span>; <span class="id">intros</span> <span class="id">H</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span> = 0).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_eq_0">sqrt_eq_0</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax3">PreHilbert.ax3</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_scal_l">inner_scal_l</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">x</span>) <span class="id">y</span> = <span class="id">l</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax4">PreHilbert.ax4</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_scal_r">inner_scal_r</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>) (<span class="id">l</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">y</span>) = <span class="id">l</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">l</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_zero_l">inner_zero_l</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">intros</span> <span class="id">x</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#trans_eq">trans_eq</a></span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> 0 <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>) <span class="id">x</span>).<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_zero_r">scal_zero_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_zero_r">inner_zero_r</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">intros</span> <span class="id">x</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_plus_l">inner_plus_l</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="id">z</span> = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">z</span> + <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y</span> <span class="id">z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax5">PreHilbert.ax5</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_plus_r">inner_plus_r</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">y</span> <span class="id">z</span>) = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span> + <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> 2!(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id">x</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_opp_r">inner_opp_r</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">y</span>) = - <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> - (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_one">scal_opp_one</a></span> <span class="id">y</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#one">one</a></span>; <span class="id">simpl</span>; <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_opp_l">inner_opp_l</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">x</span>) <span class="id">y</span> = - <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_zero">norm_zero</a></span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span>; <span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_opp">norm_opp</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">x</span>) = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">intros</span> <span class="id">x</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">x</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#one">one</a></span>) <span class="id">x</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#one">one</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">ring</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_one">scal_opp_one</a></span> <span class="id">x</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_scal">norm_scal</a></span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">x</span>) = <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">l</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span>.<br/>
<span class="id">intros</span> <span class="id">l</span> <span class="id">x</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_Rsqr_abs">sqrt_Rsqr_abs</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_mult">sqrt_mult</a></span>.<br/>
2: <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
2: <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="squared_norm">squared_norm</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">intros</span> <span class="id">x</span>; <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_sqrt">sqrt_sqrt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="square_expansion_plus">square_expansion_plus</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>) = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span> + 2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span> + <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> 2!<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_r">inner_plus_r</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="square_expansion_minus">square_expansion_minus</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">y</span>) = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span> - 2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span> + <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> 2!<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_r">inner_plus_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_sym">inner_sym</a></span>.<br/>
<span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Equalities and inequalities </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="parallelogram_id">parallelogram_id</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>)) + (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">y</span>))<br/>
&nbsp;&nbsp;= 2*((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span>) + (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y</span> <span class="id">y</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_minus">square_expansion_minus</a></span>.<br/>
<span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Cauchy_Schwartz">Cauchy_Schwartz</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>) &lt;= <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">y</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> 4%<span class="id">R</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_le">Rminus_le</a></span>; <span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="id">replace</span> (4*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>)) <span class="kwd">with</span> ((2*<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>)*(2*<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>)).<br/>
2: <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">ring</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.R_compl.html#discr_neg">discr_neg</a></span>.<br/>
<span class="id">intros</span> <span class="id">l</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">x</span>) <span class="id">y</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">x</span>) <span class="id">y</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="id">rewrite</span> 2!<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="id">right</span>; <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Cauchy_Schwartz_with_norm">Cauchy_Schwartz_with_norm</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>) &lt;= <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_0_var">Rsqr_incr_0_var</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_abs">Rsqr_abs</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Cauchy_Schwartz">Cauchy_Schwartz</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_mult">Rsqr_mult</a></span>; <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">right</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> 2!<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_triangle">norm_triangle</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">x</span> <span class="id">y</span>) &lt;= <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> + <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_0_var">Rsqr_incr_0_var</a></span>; <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="id">rewrite</span> &lt;- 2!<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> + 2 * (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span>*<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span>) + <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
<span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#RRle_abs">RRle_abs</a></span> <span class="id">_</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Cauchy_Schwartz_with_norm">Cauchy_Schwartz_with_norm</a></span>.<br/>
<span class="id">right</span>; <span class="id">ring</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#AboutPreHilbert">AboutPreHilbert</a></span>.<br/>
<br/>
<div class="doc">PreHilbert is NormedModule </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PreHNormedModule">PreHNormedModule</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ball">ball</a></span> := <span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>) <span class="id">eps</span> <span class="id">y</span> =&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">y</span>) &lt; <span class="id">eps</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_center">ball_center</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">e</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id">x</span> <span class="id">e</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="id">intros</span> <span class="id">x</span> <span class="id">z</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_zero">norm_zero</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_sym">ball_sym</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">e</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id">x</span> <span class="id">e</span> <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id">y</span> <span class="id">e</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">e</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span>; <span class="id">intros</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">H</span>); <span class="id">right</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_opp">norm_opp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>; <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_triangle">ball_triangle</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">e1</span> <span class="id">e2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id">y</span> <span class="id">e2</span> <span class="id">z</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id">x</span> (<span class="id">e1</span> + <span class="id">e2</span>) <span class="id">z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">e1</span> <span class="id">e2</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span>; <span class="id">intros</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">z</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">x</span> <span class="id">y</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">y</span> <span class="id">z</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_triangle">norm_triangle</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat">Rplus_lt_compat</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>; <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal2">f_equal2</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_l">plus_opp_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#UniformSpace.Mixin">UniformSpace.Mixin</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball_center">ball_center</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball_sym">ball_sym</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball_triangle">ball_triangle</a></span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="PreHilbert_UniformSpace">PreHilbert_UniformSpace</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#UniformSpace.Pack">UniformSpace.Pack</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span>) <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="PreHilbert_NormedModuleAux">PreHilbert_NormedModuleAux</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModuleAux.Pack">NormedModuleAux.Pack</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModuleAux.Class">NormedModuleAux.Class</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.class">ModuleSpace.class</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ModuleSpace">PreHilbert.ModuleSpace</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span>) <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_ball1">norm_ball1</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">eps</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">y</span> <span class="id">x</span>) &lt; <span class="id">eps</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ball">Hierarchy.ball</a></span> <span class="id">x</span> <span class="id">eps</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">eps</span> <span class="id">H</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ball">Hierarchy.ball</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball_sym">ball_sym</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span>; <span class="id">now</span> <span class="id">simpl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_ball2">norm_ball2</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">eps</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ball">Hierarchy.ball</a></span> <span class="id">x</span> <span class="id">eps</span> <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">y</span> <span class="id">x</span>) &lt; 1 * <span class="id">eps</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">eps</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ball">Hierarchy.ball</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">intros</span> <span class="id">H</span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball_sym">ball_sym</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">exact</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_scal_aux">norm_scal_aux</a></span>:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">x</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">l</span> <span class="id">x</span>) &lt;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#abs">abs</a></span> <span class="id">l</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">intros</span> <span class="id">l</span> <span class="id">r</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_scal">norm_scal</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert_NormedModule_mixin">PreHilbert_NormedModule_mixin</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.Mixin">NormedModule.Mixin</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> 1%<span class="id">R</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_triangle">norm_triangle</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_scal_aux">norm_scal_aux</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ball1">norm_ball1</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ball2">norm_ball2</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_eq_0">norm_eq_0</a></span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="PreHilbert_NormedModule">PreHilbert_NormedModule</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.Pack">NormedModule.Pack</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.Class">NormedModule.Class</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_NormedModule_mixin">PreHilbert_NormedModule_mixin</a></span>) <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule.E">E</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHNormedModule">PreHNormedModule</a></span>.<br/>
<h1> Hilbert spaces </h1>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Hilbert">Hilbert</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Hilbert.mixin_of">mixin_of</a></span> (<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.Exports.PreHilbert">PreHilbert</a></span>) := <span class="id"><a name="Hilbert.Mixin">Mixin</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.lim">lim</a></span> : ((<span class="id">E</span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id">E</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.ax1">ax1</a></span> : <span class="kwd">forall</span> <span class="id">F</span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ProperFilter">ProperFilter</a></span> <span class="id">F</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#cauchy">cauchy</a></span> <span class="id">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">F</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> (<span class="id">lim</span> <span class="id">F</span>) <span class="id">eps</span>)<br/>
}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Hilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Hilbert.class_of">class_of</a></span> (<span class="id">T</span> : <span class="kwd">Type</span>) := <span class="kwd">Class</span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.base">base</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.class_of">PreHilbert.class_of</a></span> <span class="id">T</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.mixin">mixin</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.mixin_of">mixin_of</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.Pack">PreHilbert.Pack</a></span> <span class="id">T</span> <span class="id">base</span> <span class="id">T</span>)<br/>
}.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">PreHilbert.class_of</span>.<br/>
<br/>
<span class="kwd">Structure</span> <span class="id"><a name="Hilbert.type">type</a></span> := <span class="id"><a name="Hilbert.Pack">Pack</a></span> { <span class="id"><a name="Hilbert.sort">sort</a></span>; <span class="id">_</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.class_of">class_of</a></span> <span class="id">sort</span> ; <span class="id">_</span> : <span class="kwd">Type</span> }.<br/>
<span class="id">Local</span> <span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Hilbert.ClassDef.cT">cT</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.class">class</a></span> := <span class="kwd">let</span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.Pack">Pack</a></span> <span class="id">_</span> <span class="id">c</span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="kwd">return</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.class_of">class_of</a></span> <span class="id">cT</span> <span class="kwd">in</span> <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Hilbert.ClassDef.xT">xT</a></span> := <span class="kwd">let</span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.Pack">Pack</a></span> <span class="id">T</span> <span class="id">_</span> <span class="id">_</span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="kwd">in</span> <span class="id">T</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="Hilbert.xclass">xclass</a></span> := (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.class">class</a></span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.class_of">class_of</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.AbelianGroup">AbelianGroup</a></span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#AbelianGroup.Pack">AbelianGroup.Pack</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.xclass">xclass</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.ModuleSpace">ModuleSpace</a></span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.Pack">ModuleSpace.Pack</a></span> <span class="id">_</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.xclass">xclass</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.PreHilbert">PreHilbert</a></span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert.Pack">PreHilbert.Pack</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.xclass">xclass</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Hilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">PreHilbert.class_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">mixin</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">mixin_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">AbelianGroup</span> : <span class="id">type</span> &gt;-&gt; <span class="id">AbelianGroup.type</span>.<br/>
<span class="kwd">Canonical</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.AbelianGroup">AbelianGroup</a></span>.<br/>
<span class="kwd">Coercion</span> <span class="id">ModuleSpace</span> : <span class="id">type</span> &gt;-&gt; <span class="id">ModuleSpace.type</span>.<br/>
<span class="kwd">Canonical</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.ModuleSpace">ModuleSpace</a></span>.<br/>
<span class="kwd">Coercion</span> <span class="id">PreHilbert</span> : <span class="id">type</span> &gt;-&gt; <span class="id">PreHilbert.type</span>.<br/>
<span class="kwd">Canonical</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.PreHilbert">PreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id"><a name="Hilbert.Exports.Hilbert">Hilbert</a></span> := <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert">Hilbert</a></span>.<br/>
<br/>
<span class="kwd">Export</span> <span class="id">Hilbert.Exports</span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="Hilbert_UniformSpace">Hilbert_UniformSpace</a></span> (<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert">Hilbert</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#UniformSpace.Pack">UniformSpace.Pack</a></span> <span class="id">E</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span>) <span class="id">E</span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="Hilbert_NormedModule">Hilbert_NormedModule</a></span> (<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert">Hilbert</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.Pack">NormedModule.Pack</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id">E</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.Class">NormedModule.Class</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_NormedModule_mixin">PreHilbert_NormedModule_mixin</a></span>) <span class="id">E</span>.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">Hilbert_NormedModule</span>: <span class="id">Hilbert</span> &gt;-&gt; <span class="id">NormedModule</span>.<br/>
<br/>
<div class="doc">Hilbert is a CompleteScape </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Hilbert_aux">Hilbert_aux</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert">Hilbert</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lim">lim</a></span> : ((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#lim">Hilbert.lim</a></span> <span class="id">_</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#class">Hilbert.class</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Hilbert_complete">Hilbert_complete</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">F</span>:(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span>-&gt;<span class="kwd">Prop</span>)-&gt;<span class="kwd">Prop</span>), <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ProperFilter">ProperFilter</a></span> <span class="id">F</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#cauchy">cauchy</a></span> <span class="id">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">F</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#lim">lim</a></span> <span class="id">F</span>) <span class="id">eps</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">intros</span> <span class="id">F</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">eps</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax1">Hilbert.ax1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">eps</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Hilbert_close_lim">Hilbert_close_lim</a></span> : <br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F1</span> <span class="id">F2</span> : (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filter_le">filter_le</a></span> <span class="id">F1</span> <span class="id">F2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filter_le">filter_le</a></span> <span class="id">F2</span> <span class="id">F1</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#close">close</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#lim">lim</a></span> <span class="id">F1</span>) (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#lim">lim</a></span> <span class="id">F2</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">intros</span> <span class="id">F1</span> <span class="id">F2</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">replace</span> <span class="id">F1</span> <span class="kwd">with</span> <span class="id">F2</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#close_refl">close_refl</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>.<br/>
<span class="id">intros</span> <span class="id">x</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filter_le">filter_le</a></span> <span class="kwd">in</span> *.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#prop_extensionality">prop_extensionality</a></span>; <span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id">H1</span>.<br/>
<span class="id">apply</span> <span class="id">H2</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert_CompleteSpace_mixin">Hilbert_CompleteSpace_mixin</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#CompleteSpace.Mixin">CompleteSpace.Mixin</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_UniformSpace">PreHilbert_UniformSpace</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#lim">lim</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_complete">Hilbert_complete</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_close_lim">Hilbert_close_lim</a></span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="Hilbert_CompleteSpace">Hilbert_CompleteSpace</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#CompleteSpace.Pack">CompleteSpace.Pack</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#CompleteSpace.Class">CompleteSpace.Class</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_CompleteSpace_mixin">Hilbert_CompleteSpace_mixin</a></span>) <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id"><a name="Hilbert_CompleteNormedModule">Hilbert_CompleteNormedModule</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#CompleteNormedModule.Pack">CompleteNormedModule.Pack</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#CompleteNormedModule.Class">CompleteNormedModule.Class</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#NormedModule.class">NormedModule.class</a></span> <span class="id">_</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_NormedModule">PreHilbert_NormedModule</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_CompleteSpace_mixin">Hilbert_CompleteSpace_mixin</a></span>) <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux.E">E</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hilbert_aux">Hilbert_aux</a></span>.<br/>
<br/>
<div class="doc">Convexity </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Convex">Convex</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ModuleSpace.Exports.ModuleSpace">ModuleSpace</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_Ring">R_Ring</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="convex">convex</a></span> (<span class="id">phi</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Convex.E">E</a></span> -&gt;<span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">u</span> <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Convex.E">E</a></span>) (<span class="id">theta</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id">phi</span> <span class="id">u</span> -&gt; <span class="id">phi</span> <span class="id">v</span> -&gt; 0 &lt;= <span class="id">theta</span> &lt;=1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">phi</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">theta</span> <span class="id">u</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">theta</span>) <span class="id">v</span>)).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Convex">Convex</a></span>.<br/>
<br/>
<div class="doc">Orthogonal projection </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="OrthogonalP">OrthogonalP</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="OrthogonalP.phi">phi</a></span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalP.phi_nonempty">phi_nonempty</a></span>: <span class="kwd">exists</span> <span class="id">y</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">y</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalP.phi_convex">phi_convex</a></span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ortho_projection_aux">ortho_projection_aux</a></span>: <span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#is_finite">is_finite</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">intros</span> <span class="id">u</span>.<br/>
<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi_nonempty">phi_nonempty</a></span> <span class="kwd">as</span> (<span class="id">y</span>,<span class="id">Hy</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.R_compl.html#is_finite_betw">is_finite_betw</a></span> <span class="kwd">with</span> 0 (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">y</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="id">intros</span> <span class="id">x</span> (<span class="id">w</span>,(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="id">rewrite</span> <span class="id">H2</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="kwd">exists</span> <span class="id">y</span>; <span class="id">now</span> <span class="id">split</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">ortho_projection_convex</span>': <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#decidable">decidable</a></span> (<span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>) &lt; <span class="id">eps</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">intros</span> (<span class="id">lime</span>, <span class="id">Hlime</span>) <span class="id">u</span> <span class="id">Du</span>.<br/>
<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi_nonempty">phi_nonempty</a></span> <span class="kwd">as</span> (<span class="id">y</span>,<span class="id">Hy</span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">pose</span> (<span class="id">delta</span>:= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#real">real</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))).<br/>
<span class="id">assert</span> (<span class="id">Hdelta</span>:0 &lt;= <span class="id">delta</span>).<br/>
<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> 0 (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="id">intros</span> <span class="id">x</span> (<span class="id">w</span>,(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="id">rewrite</span> <span class="id">H2</span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">unfold</span> <span class="id">delta</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">rewrite</span> &lt;- (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="id">u</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">easy</span>.<br/>
<span class="id">assert</span> (<span class="id">V</span>: <span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, 0 &lt; <span class="id">delta</span> + <span class="id">eps</span>).<br/>
<span class="id">intros</span> <span class="id">eps</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> <span class="id">eps</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-<span class="id">eps</span>); <span class="id">ring_simplify</span>; <span class="id">assumption</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">assert</span> (<span class="id">Kr</span>: <span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, ~~<span class="kwd">exists</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">x</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">x</span>) &lt; <span class="id">delta</span> + <span class="id">eps</span>).<br/>
<span class="id">intros</span> <span class="id">eps</span> <span class="id">H</span>.<br/>
<span class="id">absurd</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_lt">Rbar_lt</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))) (<span class="id">delta</span> + <span class="id">eps</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le_not_lt">Rbar_le_not_lt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="id">intros</span> <span class="id">r</span> <span class="id">Hr</span>; <span class="id">simpl</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> (<span class="id">delta</span> + <span class="id">eps</span>) <span class="id">r</span>); <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">intros</span> <span class="id">Hr</span>'.<br/>
<span class="id">exfalso</span>; <span class="id">apply</span> <span class="id">H</span>.<br/>
<span class="id">destruct</span> <span class="id">Hr</span> <span class="kwd">as</span> (<span class="id">w</span>, (<span class="id">J1</span>,<span class="id">J2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">w</span>; <span class="id">split</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> &lt;- <span class="id">J2</span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="id">u</span>); <span class="id">simpl</span>; <span class="id">fold</span> <span class="id">delta</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rcomplements.html#Rplus_lt_reg_l">Rplus_lt_reg_l</a></span> <span class="kwd">with</span> (-<span class="id">delta</span>); <span class="id">ring_simplify</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Kr</span>': <span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="kwd">exists</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">x</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">x</span>) &lt; <span class="id">delta</span> + <span class="id">eps</span>).<br/>
<span class="id">intros</span> <span class="id">eps</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.logic_tricks.html#logic_dec_notnot">logic_dec_notnot</a></span>.<br/>
<span class="id">apply</span> (<span class="id">Du</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> (<span class="id">V</span> <span class="id">eps</span>))).<br/>
<span class="id">exact</span> (<span class="id">Kr</span> <span class="id">eps</span>).<br/>
<span class="id">pose</span> (<span class="id">F</span>:=<span class="kwd">fun</span> (<span class="id">f</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>-&gt;<span class="kwd">Prop</span>) =&gt; <span class="kwd">exists</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">x</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">x</span>) &lt; <span class="id">delta</span> + <span class="id">eps</span> -&gt; <span class="id">f</span> <span class="id">x</span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ProperFilter">ProperFilter</a></span> <span class="id">F</span>).<br/>
<span class="id">split</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id">F</span>; <span class="id">intros</span> <span class="id">P</span> (<span class="id">eps</span>,<span class="id">Heps</span>).<br/>
<span class="id">destruct</span> (<span class="id">Kr</span>' <span class="id">eps</span>) <span class="kwd">as</span> (<span class="id">x</span>,(<span class="id">Hx1</span>,<span class="id">Hx2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">x</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id">Heps</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">split</span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id">F</span>; <span class="id">simpl</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>); <span class="id">easy</span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;*)</span><br/>
<span class="id">intros</span> <span class="id">P</span> <span class="id">Q</span> (<span class="id">e1</span>,<span class="id">HP2</span>) (<span class="id">e2</span>,<span class="id">HQ2</span>).<br/>
<span class="id">assert</span> (<span class="id">V</span>':0 &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> <span class="id">e1</span> <span class="id">e2</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_pos">Rmin_pos</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">V</span>').<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">Hx1</span> <span class="id">Hx2</span>; <span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id">HP2</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">Hx2</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_l">Rmin_l</a></span>.<br/>
<span class="id">apply</span> <span class="id">HQ2</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">Hx2</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
<span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_r">Rmin_r</a></span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;*)</span><br/>
<span class="id">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">H</span> (<span class="id">e</span>,<span class="id">HP2</span>).<br/>
<span class="kwd">exists</span> <span class="id">e</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">Hx1</span> <span class="id">Hx2</span>.<br/>
<span class="id">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id">HP2</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#cauchy">cauchy</a></span> <span class="id">F</span>); <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#cauchy">cauchy</a></span>.<br/>
<span class="id">intros</span> <span class="id">eps</span>.<br/>
<span class="id">pose</span> (<span class="id">eta</span>:= <span class="kwd">match</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#left">left</a></span> <span class="id">_</span> =&gt; <span class="id">eps</span>/2<br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Specif.html#right">right</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> ((<span class="id">eps</span>*<span class="id">eps</span>)/(16*<span class="id">delta</span>)) (<span class="id">eps</span>/(2*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<span class="id">assert</span> (<span class="id">Keta</span>: 0 &lt; <span class="id">eta</span>).<br/>
<span class="id">unfold</span> <span class="id">eta</span>; <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="id">intros</span> <span class="id">Hd</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rcomplements.html#pos_div_2">pos_div_2</a></span> <span class="id">eps</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_pos">Rmin_pos</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="id">repeat</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">case</span> <span class="id">Hdelta</span>; <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">intros</span> <span class="id">Hd</span>'; <span class="id">contradict</span> <span class="id">Hd</span>'.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#sym_not_eq">sym_not_eq</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo_calc.html#Rlt_sqrt2_0">Rlt_sqrt2_0</a></span>.<br/>
<span class="id">destruct</span> (<span class="id">Kr</span>' (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">Keta</span>)) <span class="kwd">as</span> (<span class="id">f</span>,(<span class="id">Hf1</span>,<span class="id">Hf2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">f</span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">Keta</span>).<br/>
<span class="id">intros</span> <span class="id">g</span> <span class="id">Hg1</span> <span class="id">Hg2</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#ball">Hierarchy.ball</a></span>; <span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball">ball</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hf2</span>, <span class="id">Hg2</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">assert</span> (<span class="id">M</span>:4*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>)))) + <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">f</span> <span class="id">g</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">f</span>)) + 2*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">g</span>))).<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="kwd">at</span> 3 4; <span class="id">rewrite</span> 2!<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#parallelogram_id">parallelogram_id</a></span>.<br/>
<span class="id">f_equal</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#trans_eq">trans_eq</a></span> <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (2*<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/ 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>))))).<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">ring</span>.<br/>
<span class="id">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#abs">abs</a></span> 2) <span class="kwd">at</span> 1.<br/>
2: <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.R_compl.html#norm_scal_R">norm_scal_R</a></span>, &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">fold</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">f</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">g</span>)))).<br/>
<span class="id">f_equal</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span>; <span class="id">simpl</span>; <span class="id">f_equal</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_l">scal_distr_l</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_assoc">scal_assoc</a></span>.<br/>
<span class="id">replace</span> (@<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#mult">mult</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> 2 (/2)) <span class="kwd">with</span> 1.<br/>
2: <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#mult">mult</a></span>; <span class="id">simpl</span>; <span class="id">field</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_one">scal_one</a></span>.<br/>
<span class="id">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> 1 1).<br/>
2: <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span>; <span class="id">simpl</span>; <span class="id">ring</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_r">scal_distr_r</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_one">scal_one</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>; <span class="id">rewrite</span> &lt;- 2!<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>; <span class="id">f_equal</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span> 2!<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>; <span class="id">f_equal</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">fold</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">f</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">g</span>)))).<br/>
<span class="id">f_equal</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_opp">norm_opp</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span>; <span class="id">simpl</span>; <span class="id">f_equal</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> 2!<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span> 2!<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>; <span class="id">f_equal</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_l">plus_zero_l</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_0">Rsqr_incrst_0</a></span>.<br/>
2: <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
2: <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (-4 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/ 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>)))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">f</span>)) + 2 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">g</span>))).<br/>
<span class="id">right</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_reg_l">Rplus_eq_reg_l</a></span> <span class="kwd">with</span> (4 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/ 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>))))).<br/>
<span class="id">rewrite</span> <span class="id">M</span>; <span class="id">ring</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (-4*<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">delta</span>+2 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">f</span>)) +2 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">g</span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_neg_l">Rmult_le_compat_neg_l</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_1">Rsqr_incr_1</a></span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">assert</span> (<span class="id">H2</span>:<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w0</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w0</span><br/>
&nbsp;&nbsp;/\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w0</span>))) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/ 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>))))).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="kwd">exists</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/ 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>)); <span class="id">split</span>; <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/ 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">f</span> <span class="id">g</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (/2) <span class="id">f</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-/2) <span class="id">g</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi_convex">phi_convex</a></span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#pos_half_prf">pos_half_prf</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> 2.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-1); <span class="id">ring_simplify</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_1">Rle_0_1</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">replace</span> (1-/2) <span class="kwd">with</span> (/2) <span class="kwd">by</span> <span class="id">field</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_l">scal_distr_l</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">easy</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (-4*<span class="id">delta</span>+2*(<span class="id">delta</span>+<span class="id">eta</span>)+2*(<span class="id">delta</span>+<span class="id">eta</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat">Rplus_lt_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="id">try</span> <span class="id">assumption</span>; <span class="id">now</span> <span class="id">left</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="id">try</span> <span class="id">assumption</span>; <span class="id">now</span> <span class="id">left</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span>  (8*<span class="id">delta</span>*<span class="id">eta</span>+4*<span class="id">eta</span>*<span class="id">eta</span>).<br/>
<span class="id">right</span>; <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">ring</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> ((<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">eps</span>) / 2 + (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">eps</span>) / 2).<br/>
2: <span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="id">intros</span> <span class="id">Y</span>.<br/>
<span class="id">replace</span> <span class="id">eta</span> <span class="kwd">with</span> (<span class="id">eps</span>/2).<br/>
<span class="id">rewrite</span> <span class="id">Y</span>; <span class="id">right</span>; <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">field</span>.<br/>
<span class="id">unfold</span> <span class="id">eta</span>; <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="id">easy</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (8*<span class="id">delta</span>*(<span class="id">eps</span> * <span class="id">eps</span> / (16 * <span class="id">delta</span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">unfold</span> <span class="id">eta</span>; <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">intros</span> <span class="id">_</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_l">Rmin_l</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">right</span>; <span class="id">field</span>; <span class="id">assumption</span>.<br/>
<span class="id">assert</span> (<span class="id">eta</span> &lt;= <span class="id">eps</span> / (2 * <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2)).<br/>
<span class="id">unfold</span> <span class="id">eta</span>; <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">intros</span> <span class="id">_</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_r">Rmin_r</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (4*(<span class="id">eps</span> / (2 * <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))*(<span class="id">eps</span> / (2 * <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="id">try</span> (<span class="id">left</span>; <span class="id">exact</span> <span class="id">Keta</span>); <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">try</span> (<span class="id">left</span>; <span class="id">exact</span> <span class="id">Keta</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">eps</span>/((<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))).<br/>
<span class="id">right</span>; <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">field</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rtrigo_calc.html#Rlt_sqrt2_0">Rlt_sqrt2_0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#Rsqr_sqrt">Rsqr_sqrt</a></span>.<br/>
<span class="id">now</span> <span class="id">right</span>.<br/>
<span class="id">left</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">P</span>, <span class="id">F</span> <span class="id">P</span> -&gt; ~ ~ (<span class="kwd">exists</span> <span class="id">x</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_NormedModule">PreHilbert_NormedModule</a></span>, <span class="id">P</span> <span class="id">x</span> /\ <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">x</span>)).<br/>
<span class="id">unfold</span> <span class="id">F</span>; <span class="id">intros</span> <span class="id">P</span> (<span class="id">n</span>,<span class="id">Hn</span>) <span class="id">K</span>.<br/>
<span class="id">apply</span> <span class="id">K</span>.<br/>
<span class="id">destruct</span> (<span class="id">Kr</span>' <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">x</span>,(<span class="id">Hx1</span>,<span class="id">Hx2</span>)).<br/>
<span class="kwd">exists</span> <span class="id">x</span>; <span class="id">split</span>; <span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id">Hn</span>.<br/>
<span class="id">specialize</span> (<span class="id">Hlime</span> <span class="id">F</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
<span class="id">destruct</span> <span class="id">Hlime</span> <span class="kwd">as</span> (<span class="id">T1</span>,<span class="id">T2</span>).<br/>
<span class="kwd">exists</span> (<span class="id">lime</span> <span class="id">F</span>).<br/>
<span class="id">split</span>.<br/>
<span class="id">exact</span> <span class="id">T1</span>.<br/>
<span class="id">fold</span> <span class="id">delta</span>.<br/>
<span class="id">apply</span> @<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filterlim_locally_unique">filterlim_locally_unique</a></span> <span class="kwd">with</span> (<span class="id">F</span>:=<span class="id">F</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">x</span>)).<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#Proper_StrongProper">Proper_StrongProper</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filterlim_comp">filterlim_comp</a></span> <span class="kwd">with</span> (<span class="id">G</span>:=<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#locally">locally</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id">lime</span> <span class="id">F</span>))).<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filterlim">filterlim</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filter_le">filter_le</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filtermap">filtermap</a></span>.<br/>
<span class="id">intros</span> <span class="id">P</span> (<span class="id">e</span>,<span class="id">He</span>).<br/>
<span class="id">pose</span> (<span class="id">v</span>:=@<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_factor">norm_factor</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#R_AbsRing">R_AbsRing</a></span> (@<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert_NormedModule">PreHilbert_NormedModule</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>)).<br/>
<span class="id">assert</span> (<span class="id">J</span>: 0 &lt; <span class="id">e</span>/<span class="id">v</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_factor_gt_0">norm_factor_gt_0</a></span>.<br/>
<span class="id">destruct</span> (<span class="id">T2</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">J</span>)) <span class="kwd">as</span> (<span class="id">eps</span>, <span class="id">Heps</span>).<br/>
<span class="kwd">exists</span> <span class="id">eps</span>.<br/>
<span class="id">intros</span> <span class="id">w</span> <span class="id">Hw1</span> <span class="id">Hw2</span>.<br/>
<span class="id">apply</span> <span class="id">He</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_compat1">norm_compat1</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> <span class="kwd">at</span> 1; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> (<span class="id">lime</span> <span class="id">F</span>) <span class="id">w</span>)).<br/>
<span class="id">right</span>; <span class="id">f_equal</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>; <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>; <span class="id">f_equal</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_l">plus_zero_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>) <span class="kwd">with</span> (<span class="id">v</span>*(<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">J</span>)).<br/>
<span class="id">unfold</span> <span class="id">v</span> <span class="kwd">at</span> 1.<br/>
<span class="id">apply</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_compat2">norm_compat2</a></span> <span class="id">w</span> (<span class="id">lime</span> <span class="id">F</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">J</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ball_sym">ball_sym</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id">Heps</span>.<br/>
<span class="id">simpl</span>; <span class="id">field</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_factor_gt_0">norm_factor_gt_0</a></span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filterlim_norm">filterlim_norm</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filterlim">filterlim</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filter_le">filter_le</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#filtermap">filtermap</a></span>, <span class="id">F</span>.<br/>
<span class="id">intros</span> <span class="id">P</span> (<span class="id">e</span>,<span class="id">He</span>).<br/>
<span class="kwd">exists</span> <span class="id">e</span>; <span class="id">intros</span> <span class="id">w</span> <span class="id">Hw1</span> <span class="id">Hw2</span>.<br/>
<span class="id">apply</span> <span class="id">He</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_compat1">norm_compat1</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> <span class="kwd">at</span> 1; <span class="id">simpl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#abs">abs</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">at</span> 1; <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rcomplements.html#Rplus_lt_reg_l">Rplus_lt_reg_l</a></span> <span class="kwd">with</span> <span class="id">delta</span>; <span class="id">ring_simplify</span>.<br/>
<span class="id">exact</span> <span class="id">Hw2</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">at</span> 1; <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> <span class="id">delta</span>; <span class="id">ring_simplify</span>.<br/>
<span class="id">assert</span> (<span class="id">H2</span>:<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w0</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w0</span><br/>
&nbsp;&nbsp;/\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w0</span>))) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="kwd">exists</span> <span class="id">w</span>; <span class="id">now</span> <span class="id">split</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">easy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ortho_projection_convex_unique">ortho_projection_convex_unique</a></span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span> <span class="id">v</span>':<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span>' -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="id">v</span> = <span class="id">v</span>'.<br/>
<span class="id">intros</span> <span class="id">H</span> <span class="id">u</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="id">pose</span> (<span class="id">a</span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>').<br/>
<span class="id">pose</span> (<span class="id">b</span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>).<br/>
<span class="id">pose</span> (<span class="id">v</span>'' := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1/2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>')).<br/>
<span class="id">pose</span> (<span class="id">d</span> := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)).<br/>
<span class="id">assert</span> (<span class="id">E1</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (4*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>''))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>''))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>'))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 4*(<span class="id">d</span>*<span class="id">d</span>)).<br/>
<span class="id">assert</span> (<span class="id">E2</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 4*(<span class="id">d</span>*<span class="id">d</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">replace</span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#parallelogram_id">parallelogram_id</a></span>.<br/>
<span class="id">unfold</span> <span class="id">d</span>, <span class="id">a</span>, <span class="id">b</span>.<br/>
<span class="id">repeat</span> (<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>).<br/>
<span class="id">replace</span> ( <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>')) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
<span class="id">replace</span> ( <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (4 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>'') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>'')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>'))) <span class="kwd">in</span> <span class="id">E2</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>')).<br/>
<span class="id">unfold</span> <span class="id">a</span>, <span class="id">b</span>.<br/>
<span class="id">unfold</span> <span class="id">v</span>''.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> <span class="id">_</span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>')))).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_l">Rplus_eq_compat_l</a></span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>') (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> 2) <span class="id">u</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>')).<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">assert</span> (<span class="id">H42</span> : (4 *(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 / 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>')))) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 / 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>'))))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=((2*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 / 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>'))))))*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 / 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>')))))))).<br/>
<span class="id">ring</span>.<br/>
<span class="id">rewrite</span> <span class="id">H42</span>.<br/>
<span class="id">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> 2) <span class="kwd">at</span> 1.<br/>
<span class="id">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> 2) <span class="kwd">at</span> 3.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_scal">norm_scal</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_l">scal_distr_l</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_assoc">scal_assoc</a></span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#mult">mult</a></span> 2 (1/2)) <span class="kwd">with</span> 1.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_one">scal_one</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#mult">mult</a></span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">field</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> 2).<br/>
<span class="id">absurd</span> (2 &lt; 0).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> 2).<br/>
<span class="id">absurd</span> (2 &lt; 0).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_r">scal_distr_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_one">scal_one</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.compatible.html#plus_assoc_gen">plus_assoc_gen</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">unfold</span> <span class="id">a</span>, <span class="id">b</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">u</span>) <span class="id">v</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>') <span class="id">v</span>).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>') <span class="id">v</span>)).<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>') <span class="id">v</span>) <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">u</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">assert</span> (<span class="id">Hmin</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') &lt;= 0).<br/>
<span class="id">replace</span> 0 <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (4*(<span class="id">d</span>*<span class="id">d</span>)) (-4*(<span class="id">d</span>*<span class="id">d</span>))).<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>')) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> (4*(<span class="id">d</span>*<span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>'') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>'')))).<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
<span class="id">replace</span> (-4 * (<span class="id">d</span> * <span class="id">d</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (4*(<span class="id">d</span>*<span class="id">d</span>))).<br/>
<span class="id">assert</span> (<span class="id">Has</span>: <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (4 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>'')) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>''))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (-((4 * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>'')) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>''))))))).<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">Has</span>.<br/>
<span class="id">clear</span> <span class="id">Has</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span> (-(4*(<span class="id">d</span>*<span class="id">d</span>))) <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hd</span> : <span class="id">d</span> &lt;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>'')).<br/>
<span class="id">assert</span> (<span class="id">HdGlb</span> : <span class="id">d</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
<span class="id">unfold</span> <span class="id">d</span>.<br/>
<span class="id">rewrite</span> <span class="id">H1</span>.<br/>
<span class="id">rewrite</span> <span class="id">H3</span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> <span class="kwd">in</span> <span class="id">HdGlb</span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#ex_glb_Rbar">ex_glb_Rbar</a></span><br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">HdGlb</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_glb_Rbar">is_glb_Rbar</a></span> <span class="kwd">in</span> <span class="id">HdGlb</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_glb_Rbar">is_glb_Rbar</a></span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_lb_Rbar">is_lb_Rbar</a></span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
<span class="id">destruct</span> <span class="id">i</span> <span class="kwd">as</span> (<span class="id">Hi1</span>,<span class="id">Hi2</span>).<br/>
<span class="id">assert</span> (<span class="id">Hp</span> :<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
<span class="id">intros</span>. <span class="id">apply</span> <span class="id">Hi1</span>.<br/>
<span class="kwd">exists</span> <span class="id">w</span>.<br/>
<span class="id">split</span>; <span class="id">trivial</span>.<br/>
<span class="id">assert</span> (<span class="id">Hf</span> :<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> <span class="id">x</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>''))).<br/>
<span class="id">apply</span> <span class="id">Hp</span>.<br/>
<span class="id">unfold</span> <span class="id">v</span>''.<br/>
<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="kwd">in</span> <span class="id">phi_convex</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 / 2) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">v</span> <span class="id">v</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1/2) <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1/2) <span class="id">v</span>')).<br/>
<span class="id">replace</span> (1 / 2) <span class="kwd">with</span> (1 - (1 / 2)) <span class="kwd">at</span> 2 <span class="kwd">by</span> <span class="id">field</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi_convex">phi_convex</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">assert</span> (<span class="id">Hs</span> : 0 &lt; 1 / 2).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rcomplements.html#Rdiv_lt_0_compat">Rdiv_lt_0_compat</a></span>; <span class="id">intuition</span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> <span class="kwd">with</span> 2.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">replace</span> (1 / 2 * 2) <span class="kwd">with</span> 1 <span class="kwd">by</span> <span class="id">field</span>.<br/>
<span class="id">replace</span> 1 <span class="kwd">with</span> (1*1) <span class="kwd">at</span> 1 <span class="kwd">by</span> <span class="id">ring</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
<span class="id">intuition</span>. <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_l">scal_distr_l</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">assert</span> (<span class="id">Hrx</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#real">real</a></span> <span class="id">x</span> &lt;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>'')).<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
<span class="id">destruct</span> <span class="id">x</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">HdGlb</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>;<br/>
<span class="id">unfold</span> <span class="id">d</span>;<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">unfold</span> <span class="id">d</span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">unfold</span> <span class="id">d</span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> 4 (<span class="id">d</span>*<span class="id">d</span>))) <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">E1</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_l">plus_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_l">plus_zero_l</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">replace</span> ((-4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (4*(<span class="id">d</span>*<span class="id">d</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> 4 (<span class="id">d</span>*<span class="id">d</span>))) <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
<span class="id">reflexivity</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') = 0).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hsq</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">v</span>') = 0).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral">Rmult_integral</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<span class="id">destruct</span> <span class="id">H4</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_eq_zero">norm_eq_zero</a></span> <span class="kwd">in</span> <span class="id">Hsq</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">in</span> <span class="id">Hsq</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_reg_r">plus_reg_r</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>').<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ortho_projection_convex">ortho_projection_convex</a></span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#decidable">decidable</a></span> (<span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>) &lt; <span class="id">eps</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span>! <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">intros</span> <span class="id">H</span> <span class="id">u</span> <span class="id">Hu</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.logic_tricks.html#unique_existence1">unique_existence1</a></span>; <span class="id">split</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id">ortho_projection_convex</span>'.<br/>
<span class="id">intros</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">Hv</span> <span class="id">Hv</span>'.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="kwd">with</span> <span class="id">u</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux1sq">charac_ortho_projection_convex_aux1sq</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; 0 &lt; <span class="id">t</span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) = (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">t</span>) <span class="id">v</span>)))))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="kwd">in</span> *. <span class="id">simpl</span>.<br/>
<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_glb_Rbar">is_glb_Rbar</a></span> ((<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))).<br/>
<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar_correct">Glb_Rbar_correct</a></span>.<br/>
<span class="id">destruct</span> <span class="id">H3</span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="id">u</span>) <span class="kwd">in</span> <span class="id">H3</span>, <span class="id">H4</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H3</span>, <span class="id">H4</span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_lb_Rbar">is_lb_Rbar</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_lb_Rbar">is_lb_Rbar</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">apply</span> <span class="id">H3</span>.<br/>
<span class="kwd">exists</span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">t</span>) <span class="id">v</span>))); <span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux1">charac_ortho_projection_convex_aux1</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; 0 &lt; <span class="id">t</span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) = (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">t</span>) <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">t</span>) <span class="id">v</span>))))))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="kwd">in</span> *. <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux1sq">charac_ortho_projection_convex_aux1sq</a></span>; <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux1sq">charac_ortho_projection_convex_aux1sq</a></span>; <span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux2">charac_ortho_projection_convex_aux2</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; 0 &lt; <span class="id">t</span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">t</span>) <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">at</span> 1.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_r">scal_distr_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_one">scal_one</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span>. <span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_plus">opp_plus</a></span> <span class="id">v</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">v</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>))) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">at</span> 1.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>) <span class="id">u</span>). <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_distr_l">scal_distr_l</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">w</span>))).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span> <span class="id">t</span> <span class="id">w</span>). <span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span> <span class="id">t</span> <span class="id">w</span>).<br/>
<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux3">charac_ortho_projection_convex_aux3</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; 0 &lt; <span class="id">t</span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">t</span>) <span class="id">v</span>))))*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">t</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1-<span class="id">t</span>) <span class="id">v</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=  (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((2*<span class="id">t</span>)*(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t</span>*<span class="id">t</span>)*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux2">charac_ortho_projection_convex_aux2</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_minus">opp_minus</a></span> <span class="id">v</span> <span class="id">w</span>). <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t</span> * (<span class="id">t</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> * <span class="id">t</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>. <span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id">H2</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
(<span class="id">t</span> ^ 2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>.<br/>
<span class="id">f_equal</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>. <span class="id">symmetry</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.R_compl.html#Rplus_plus_reg_r">Rplus_plus_reg_r</a></span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id">a</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">a</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>. <span class="id">rewrite</span> <span class="id">Hminus</span>.<br/>
<span class="id">assert</span> (<span class="id">Hscal</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">a</span>*<span class="id">b</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">a</span> <span class="id">b</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>. <span class="id">rewrite</span> <span class="id">Hscal</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span>.<br/>
<span class="id">symmetry</span>. <span class="id">rewrite</span> <span class="id">Hscal</span>. <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux4">charac_ortho_projection_convex_aux4</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; 0 &lt; <span class="id">t</span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; 0 &lt;= (-(2*<span class="id">t</span>*<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+(<span class="id">t</span>*<span class="id">t</span>)*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id">a</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">a</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>. <span class="id">rewrite</span> <span class="id">Hminus</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span><br/>
((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hrew</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (2 * <span class="id">t</span> * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> * <span class="id">t</span> * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((2*<span class="id">t</span>)*(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t</span>*<span class="id">t</span>)*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
<span class="id">assert</span> (<span class="id">Hperm</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>, <span class="id">a</span> + (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">b</span> + <span class="id">c</span>) = (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">a</span> <span class="id">b</span>) + <span class="id">c</span>).<br/>
<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>. <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hperm</span>. <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hrew</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux3">charac_ortho_projection_convex_aux3</a></span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux1">charac_ortho_projection_convex_aux1</a></span>;<br/>
<span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux5">charac_ortho_projection_convex_aux5</a></span> :  <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; 0 &lt; <span class="id">t</span> &lt;= 1<br/>
&nbsp;&nbsp;-&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;-&gt; (2*(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id">t</span>*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))) .<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">intros</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> <span class="id">t</span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id">t</span>*(2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)))).<br/>
<span class="id">assert</span> (<span class="id">Hplus</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">a</span> + <span class="id">b</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">a</span> <span class="id">b</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>.<br/>
<span class="id">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id">a</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">a</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hplus</span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_l">plus_opp_l</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>. <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">t</span> 2).<br/>
<span class="id">rewrite</span> &lt;- <span class="id">Hminus</span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">t</span> <span class="id">t</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux4">charac_ortho_projection_convex_aux4</a></span>; <span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux1_r">charac_ortho_projection_convex_aux1_r</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> :<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>) &lt;= 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))).<br/>
<span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.compatible.html#plus_assoc_gen">plus_assoc_gen</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_l">plus_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_l">plus_zero_l</a></span>. <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">H2</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) +<br/>
&nbsp;&nbsp;2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))) <span class="kwd">at</span> 1.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>; <span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span><br/>
&nbsp;&nbsp;<span class="kwd">with</span> 2 (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)) 0 <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">intuition</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="id">assert</span> ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_minus">opp_minus</a></span>. <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">H3</span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hscal</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">a</span>*<span class="id">b</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id">a</span> <span class="id">b</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hscal</span>.<br/>
<span class="id">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id">a</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">a</span>).<br/>
<span class="id">intros</span>; <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hminus</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hscal</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">intuition</span>.<br/>
<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))) <span class="kwd">at</span> 1.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="th">th</a></span> (<span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>)  := <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> 1 ((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex">charac_ortho_projection_convex</a></span>: <span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>) &lt;= 0)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
<span class="id">intros</span>; <span class="id">split</span>.<br/>
+<span class="id">intros</span>.<br/>
&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)*<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)) 0).<br/>
&nbsp;- <span class="id">assert</span> (1*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)) = 0).<br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span>. <span class="id">ring_simplify</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> 2%<span class="id">R</span>. <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>. <span class="id">rewrite</span> &lt;-<span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux5">charac_ortho_projection_convex_aux5</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdichotomy">Rdichotomy</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) &lt; 0).<br/>
&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span>. <span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_dec">Rle_lt_dec</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)) 0).<br/>
&nbsp;&nbsp;&nbsp;* <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;* <span class="id">absurd</span> (0 &lt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2*(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>)*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex_aux5">charac_ortho_projection_convex_aux5</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#th">th</a></span>. <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> 1 (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intuition</span>. <span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rcomplements.html#Rdiv_lt_0_compat">Rdiv_lt_0_compat</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_l">Rmin_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> ((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>)*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 / (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rcomplements.html#Rdiv_lt_0_compat">Rdiv_lt_0_compat</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> ((<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>) * / 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>. <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_1">Rinv_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_r">Rmin_r</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> (0 = 0). <span class="id">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intuition</span>. <span class="id">intuition</span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> (0 = 0). <span class="id">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intuition</span>. <span class="id">intuition</span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (2*(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> * (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>))); <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_dec">Rlt_dec</a></span> 0 (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> ( 2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_le">Rgt_not_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_compat_r">Rmult_gt_compat_r</a></span>. <span class="id">trivial</span>. <span class="id">ring_simplify</span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial</span>. <span class="id">trivial</span>.<br/>
+<span class="id">intros</span>.<br/>
&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))).<br/>
&nbsp;<span class="id">intros</span>.<br/>
&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>, <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)).<br/>
&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">symmetry</span>. <span class="id">rewrite</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span> <span class="id">u</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v</span>)).<br/>
&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.compatible.html#plus_assoc_gen">plus_assoc_gen</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_l">plus_opp_l</a></span>.<br/>
&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_l">plus_zero_l</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; ((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)))*((<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))))).<br/>
&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> (<span class="id">H2</span> <span class="id">w0</span>).<br/>
&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w0</span>))).<br/>
&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)).<br/>
&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w0</span>)).<br/>
&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>.<br/>
&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))).<br/>
&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 (2 * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w0</span>) * <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w0</span>))).<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>.<br/>
&nbsp;<span class="id">assert</span> (2*0 = 0). <span class="id">ring_simplify</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">H4</span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>. <span class="id">intuition</span>.<br/>
&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_minus">opp_minus</a></span> <span class="id">w0</span> <span class="id">v</span>). <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_cancel">Ropp_le_cancel</a></span>. <span class="id">ring_simplify</span>. <span class="id">apply</span> <span class="id">H0</span>. <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;<span class="id">destruct</span><br/>
&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id">H2</span> <span class="id">w</span>) <span class="kwd">in</span> <span class="id">r</span>. <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">absurd</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>) * <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)).<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_le">Rlt_not_le</a></span>. <span class="id">rewrite</span> &lt;- (<span class="id">H2</span> <span class="id">w</span>) <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_0_lt_compat">Rmult_le_0_lt_compat</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;<span class="kwd">in</span> <span class="id">n</span>; <span class="id">trivial</span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id">H3</span>; <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span>.<br/>
&nbsp;<span class="id">destruct</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#ex_glb_Rbar">ex_glb_Rbar</a></span><br/>
&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))). <span class="id">simpl</span>.<br/>
&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_glb_Rbar">is_glb_Rbar</a></span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#is_lb_Rbar">is_lb_Rbar</a></span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
&nbsp;<span class="id">destruct</span> <span class="id">i</span>.<br/>
&nbsp;<span class="id">assert</span> (<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">w</span> -&gt; (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id">H2</span>.<br/>
&nbsp;<span class="kwd">exists</span> <span class="id">w</span>. <span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> <span class="id">x</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>))).<br/>
&nbsp;<span class="id">apply</span> <span class="id">H2</span>. <span class="kwd">exists</span> <span class="id">v</span>. <span class="id">split</span>; <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le">Rbar_le</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)) <span class="id">x</span>).<br/>
&nbsp;<span class="id">apply</span> <span class="id">H3</span>. <span class="id">intros</span>.<br/>
&nbsp;<span class="id">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> (<span class="id">w0</span>,(<span class="id">H61</span>,<span class="id">H62</span>)).<br/>
&nbsp;<span class="id">rewrite</span> <span class="id">H62</span>. <span class="id">apply</span> <span class="id">H1</span>. <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_finite_eq">Rbar_finite_eq</a></span>.<br/>
&nbsp;<span class="id">apply</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Rbar.html#Rbar_le_antisym">Rbar_le_antisym</a></span>.<br/>
&nbsp;<span class="id">destruct</span> <span class="id">x</span>.<br/>
&nbsp;<span class="id">trivial</span>. <span class="id">trivial</span>. <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;<span class="id">exfalso</span>. <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">exfalso</span>. <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">destruct</span> <span class="id">x</span>.<br/>
&nbsp;<span class="id">trivial</span>. <span class="id">trivial</span>. <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;<span class="id">exfalso</span>. <span class="id">trivial</span>.<br/>
&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">exfalso</span>. <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalP">OrthogonalP</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="OrthogonalQ">OrthogonalQ</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="OrthogonalQ.phi">phi</a></span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalQ.phi_mod">phi_mod</a></span>: <span class="id"><a href="FormalML.CertRL.LM.compatible.html#compatible_m">compatible_m</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalQ.phi_compl">phi_compl</a></span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ortho_projection_subspace">ortho_projection_subspace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, (<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Decidable.html#decidable">decidable</a></span> (<span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">w</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>) &lt; <span class="id">eps</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span>! <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">v</span> /\ <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">intros</span> <span class="id">u</span> <span class="id">Hu</span>.<br/>
<span class="id">assert</span> (<span class="id">phi_convex</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span>).<br/>
<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span>.<br/>
<span class="id">intros</span> <span class="id">u0</span> <span class="id">v0</span> <span class="id">t</span> <span class="id">Hu0</span> <span class="id">Hv0</span> <span class="id">Th01</span>.<br/>
<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span> <span class="kwd">as</span> ((<span class="id">g1</span>,(<span class="id">s</span>,<span class="id">g2</span>)),<span class="id">mod2</span>).<br/>
<span class="id">assert</span> (<span class="id">H0</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">t</span>) <span class="id">v0</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (1 - <span class="id">t</span>)) <span class="id">v0</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>. <span class="id">reflexivity</span>.<br/>
<span class="id">rewrite</span> <span class="id">H0</span>.<br/>
<span class="id">apply</span> <span class="id">g1</span>.<br/>
<span class="id">apply</span> <span class="id">mod2</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id">mod2</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.logic_tricks.html#unique_existence1">unique_existence1</a></span>; <span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id">ortho_projection_convex</span>'; <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="kwd">exists</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="FormalML.CertRL.LM.compatible.html#compatible_m_zero">compatible_m_zero</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>).<br/>
<span class="id">intros</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">Hv</span> <span class="id">Hv</span>'.<br/>
<span class="id">apply</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">phi_convex</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_compl">phi_compl</a></span> <span class="id">u</span>); <span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>: <span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>) &lt;= 0)).<br/>
<span class="id">split</span>.<br/>
+ <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex">charac_ortho_projection_convex</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">theta</span>) <span class="id">v0</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">theta</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v0</span>))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H3</span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_one">scal_opp_one</a></span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">trivial</span>.<br/>
+ <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_convex">charac_ortho_projection_convex</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">theta</span>) <span class="id">v0</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">theta</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">v0</span>))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_r">scal_opp_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H4</span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_one">scal_opp_one</a></span>. <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#OrthogonalQ">OrthogonalQ</a></span>.<br/>
<br/>
<div class="doc">Orthogonal complement </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ortho_compl">ortho_compl</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="ortho_compl.phi">phi</a></span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="ortho_compl.phi_compat">phi_compat</a></span>: <span class="id"><a href="FormalML.CertRL.LM.compatible.html#compatible_m">compatible_m</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="ortho_compl.phi_compl">phi_compl</a></span>: <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="orth_compl">orth_compl</a></span> := <span class="kwd">fun</span> <span class="id">x</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span> =&gt; <span class="kwd">forall</span> (<span class="id">y</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>), <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">y</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span> = 0.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="orth_compl_compat">orth_compl_compat</a></span>: <span class="id"><a href="FormalML.CertRL.LM.compatible.html#compatible_m">compatible_m</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">repeat</span> <span class="id">split</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">z</span> <span class="id">Hz</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">Hz</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">Hz</span>).<br/>
<span class="id">ring</span>.<br/>
<span class="kwd">exists</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>.<br/>
<span class="id">intros</span> <span class="id">y</span> <span class="id">Hy</span>; <span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">l</span> <span class="id">H1</span> <span class="id">y</span> <span class="id">Hy</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">Hy</span>); <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="trivial_orth_compl">trivial_orth_compl</a></span> : <span class="kwd">forall</span> <span class="id">u</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, ((<span class="kwd">forall</span> <span class="id">v</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">v</span> = 0) &lt;-&gt; <span class="id">u</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>).<br/>
<span class="id">intros</span>; <span class="id">split</span>.<br/>
<span class="id">intro</span> <span class="id">H0</span>. <span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">u</span> = 0). <span class="id">apply</span> <span class="id">H0</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax3">PreHilbert.ax3</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">trivial</span>.<br/>
<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">H</span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>; <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">trivial_orth_compl</span>' : <span class="kwd">forall</span> (<span class="id">phi</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span> -&gt; <span class="kwd">Prop</span>) (<span class="id">u</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#closed">closed</a></span> <span class="id">phi</span> -&gt; <span class="id">phi</span> <span class="id">u</span> -&gt; ((<span class="kwd">forall</span> <span class="id">v</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id">phi</span> <span class="id">v</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">v</span> = 0) &lt;-&gt; <span class="id">u</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>).<br/>
<span class="id">intros</span>; <span class="id">split</span>.<br/>
<span class="id">intro</span> <span class="id">H1</span>. <span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">u</span> = 0). <span class="id">apply</span> <span class="id">H1</span>; <span class="id">trivial</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ax3">PreHilbert.ax3</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">trivial</span>.<br/>
<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>; <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sumable_with_orth_compl">direct_sumable_with_orth_compl</a></span>: <span class="id"><a href="FormalML.CertRL.LM.compatible.html#direct_sumable">direct_sumable</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">intros</span> <span class="id">x</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">apply</span>: <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm_eq_zero">norm_eq_zero</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span>; <span class="id">simpl</span>; <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#Hnorm">Hnorm</a></span>; <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_subspace2">charac_ortho_projection_subspace2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span> = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>)).<br/>
<span class="id">split</span>; <span class="id">intros</span>.<br/>
+ <span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>) &lt;= 0).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>; <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">w</span>' := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> <span class="id">w</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span> &lt;= 0).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hm1</span> : <span class="id">w</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span>' <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">w</span>'.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span>').<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">w</span>'.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">G1</span>,(<span class="id">z</span>,<span class="id">G2</span>)),<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">G1</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_l">plus_zero_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">G1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">M</span> <span class="id">z</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>) <span class="kwd">in</span> <span class="id">G2</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_zero_l">scal_zero_l</a></span> <span class="kwd">in</span> <span class="id">G2</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hm1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">w</span>'' := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus">plus</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">w</span>) <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">w</span>) &lt;= 0).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hm1</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> <span class="id">w</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span>'' <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">w</span>''.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_assoc">plus_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span>'').<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">w</span>''.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">G1</span>,(<span class="id">z</span>,<span class="id">G2</span>)),<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_comm">plus_comm</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">G1</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hm1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">HF</span> : (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>) &lt;= 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>) &lt;= 0)).<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">HF</span> <span class="kwd">as</span> (<span class="id">HF1</span>,<span class="id">HF2</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span> = 0).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span> <span class="kwd">in</span> <span class="id">HF2</span>.<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">HF2</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= - (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>))).<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">H5</span> <span class="kwd">in</span> <span class="id">HF2</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span> <span class="kwd">in</span> <span class="id">HF2</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_opp_r_uniq">Rplus_opp_r_uniq</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">symmetry</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
+ <span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">G1</span>,(<span class="id">z</span>,<span class="id">G2</span>)),<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>) &lt;= 0).<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">w</span> <span class="id">phiw</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">w</span>' := <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>') (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span>')).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">w</span>'. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>' = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span>').<br/>
&nbsp;&nbsp;<span class="id">symmetry</span>. <span class="id">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">w</span>'.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">G1</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>') (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span>') = 0).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl">direct_sum_with_orth_compl</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="FormalML.CertRL.LM.compatible.html#m_plus">m_plus</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="id">intros</span> <span class="id">x</span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.compatible.html#m_plus">m_plus</a></span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<span class="kwd">exists</span> <span class="id">x</span>. <span class="kwd">exists</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>. <span class="id">intro</span>. <span class="id">intros</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">Hierarchy.plus_zero_r</a></span>. <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl_decomp">direct_sum_with_orth_compl_decomp</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span> = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_subspace2">charac_ortho_projection_subspace2</a></span>; <span class="id">intuition</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">y</span> = <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">y</span>).<br/>
<span class="id">apply</span> <span class="id">H1</span>; <span class="id">trivial</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id">H3</span>.<br/>
<span class="id">rewrite</span> &lt;- <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>; <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl_charac1">direct_sum_with_orth_compl_charac1</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">u</span> &lt;-&gt; <span class="id">v</span> = <span class="id">u</span>).<br/>
<span class="id">split</span>; <span class="id">intros</span>.<br/>
+ <span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">u</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">u</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_opp_r">plus_opp_r</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span>. <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>. <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">phi_convex</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">u0</span> <span class="id">v0</span> <span class="id">t</span> <span class="id">Hu0</span> <span class="id">Hv0</span> <span class="id">Th01</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">g1</span>,(<span class="id">s</span>,<span class="id">g2</span>)),<span class="id">mod2</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">H3</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">t</span>) <span class="id">v0</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (1 - <span class="id">t</span>)) <span class="id">v0</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">g1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">phi_convex</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compl">phi_compl</a></span> <span class="id">u</span>).<br/>
&nbsp;&nbsp;<span class="id">trivial</span>. <span class="id">trivial</span>. <span class="id">trivial</span>. <span class="id">trivial</span>.<br/>
+ <span class="id">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl_charac2">direct_sum_with_orth_compl_charac2</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="kwd">exists</span> <span class="id">w</span>:<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span> /\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="id">u</span> &lt;-&gt; <span class="id">v</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>).<br/>
<span class="id">split</span>; <span class="id">intros</span>.<br/>
+ <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Lub.html#Glb_Rbar">Glb_Rbar</a></span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">r</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#norm">norm</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">w</span>))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_zero_l">scal_zero_l</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H4</span>; <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#direct_sum_with_orth_compl_decomp">direct_sum_with_orth_compl_decomp</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">x</span> -&gt; <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="id">x</span> -&gt; <span class="id">x</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#direct_sumable_with_orth_compl">direct_sumable_with_orth_compl</a></span>. <span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#inner">inner</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>) (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">w</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span>) = 0).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_zero">opp_zero</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>. <span class="id">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_zero">opp_zero</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_zero">opp_zero</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H4</span>; <span class="id">intuition</span>. <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">phi_convex</span> : <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">u0</span> <span class="id">v0</span> <span class="id">t</span> <span class="id">Hu0</span> <span class="id">Hv0</span> <span class="id">Th01</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">g1</span>,(<span class="id">s</span>,<span class="id">g2</span>)),<span class="id">mod2</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">H3</span> : <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (1 - <span class="id">t</span>) <span class="id">v0</span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp">opp</a></span> (1 - <span class="id">t</span>)) <span class="id">v0</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_opp_l">scal_opp_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_opp">opp_opp</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">g1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">phi_convex</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compl">phi_compl</a></span> <span class="id">u</span>); <span class="id">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> = <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal">scal</a></span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#zero">zero</a></span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#scal_zero_l">scal_zero_l</a></span>. <span class="id">reflexivity</span>. <span class="id">destruct</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H3</span>. <span class="id">apply</span> <span class="id">H5</span>; <span class="id">trivial</span>.<br/>
+ <span class="id">assert</span> (<span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span> <span class="id">u</span> <span class="id">v</span> = <span class="id">u</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">unfold</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#minus">minus</a></span>. <span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#opp_zero">opp_zero</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="http://coquelicot.saclay.inria.fr/html/Coquelicot.Hierarchy.html#plus_zero_r">plus_zero_r</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#direct_sum_with_orth_compl_decomp">direct_sum_with_orth_compl_decomp</a></span>; <span class="id">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FormalML.CertRL.LM.hilbert.html#ortho_compl">ortho_compl</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
